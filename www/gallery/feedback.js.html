<!DOCTYPE html>
      <html>
        <head>
          <title>example/feedback.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(p,q,m){function c(b,a){if(!q[b]){if(!p[b]){var f="function"==typeof require&&require;if(!a&&f)return f(b,!0);if(u)return u(b,!0);f=Error("Cannot find module '"+b+"'");throw f.code="MODULE_NOT_FOUND",f;}f=q[b]={exports:{}};p[b][0].call(f.exports,function(a){var f=p[b][1][a];return c(f?f:a)},f,f.exports,e$$0,p,q,m)}return q[b].exports}for(var u="function"==typeof require&&require,t=0;t<m.length;t++)c(m[t]);return c})({1:[function(h,p,q){var m=h("../regl")(),c=h("mouse-change")(),u=m.texture(),
t=m({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform vec2 mouse;\n  uniform float t;\n  varying vec2 uv;\n  void main () {\n    float dist = length(gl_FragCoord.xy - mouse);\n    gl_FragColor = vec4(0.98 * texture2D(texture,\n      uv + cos(t) * vec2(0.5 - uv.y, uv.x - 0.5) - sin(2.0 * t) * (uv - 0.5)).rgb, 1) +\n      exp(-0.01 * dist) * vec4(\n        1.0 + cos(2.0 * t),\n        1.0 + cos(2.0 * t + 1.5),\n        1.0 + cos(2.0 * t + 3.0),\n        0.0);\n  }",vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(2.0 * position - 1.0, 0, 1);\n  }",
attributes:{position:[-2,0,0,-2,2,2]},uniforms:{texture:u,mouse:function(b){var a=b.pixelRatio;return[c.x*a,b.viewportHeight-c.y*a]},t:function(b){return.01*b.tick}},count:3});m.frame(function(){m.clear({color:[0,0,0,1]});t();u({copy:!0})})},{"../regl":36,"mouse-change":34}],2:[function(h,p,q){function m(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}p.exports=function(c,u,t,b,a){c=t.maxAttributes;u=
Array(c);for(t=0;t<c;++t)u[t]=new m;return{Record:m,scope:{},state:u}}},{}],3:[function(h,p,q){function m(b){return w[Object.prototype.toString.call(b)]|0}function c(b,c){for(var a=0;a<c.length;++a)b[a]=c[a]}function u(b,c,a,f,m,t,u){for(var x=0,g=0;g<a;++g)for(var l=0;l<f;++l)b[x++]=c[m*g+t*l+u]}var t=h("./util/is-typed-array"),b=h("./util/is-ndarray"),a=h("./util/values"),f=h("./util/pool");q=h("./util/flatten");var x=q.flatten,O=q.shape,w=h("./constants/arraytypes.json"),C=h("./constants/dtypes.json"),
l=h("./constants/usage.json"),F=[];F[5120]=1;F[5122]=2;F[5124]=4;F[5121]=1;F[5123]=2;F[5125]=4;F[5126]=4;p.exports=function(n,h,A){function k(b){this.id=D++;this.buffer=n.createBuffer();this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=null;A.profile&&(this.stats={size:0})}function B(b,c,a){b.byteLength=c.byteLength;n.bufferData(b.type,c,a)}function w(a,g,k,n,l,h){a.usage=k;if(Array.isArray(g)){if(a.dtype=n||5126,0<g.length)if(Array.isArray(g[0])){l=
O(g);for(var H=n=1;H<l.length;++H)n*=l[H];a.dimension=n;g=x(g,l,a.dtype);B(a,g,k);h?a.persistentData=g:f.freeType(g)}else"number"===typeof g[0]?(a.dimension=l,l=f.allocType(a.dtype,g.length),c(l,g),B(a,l,k),h?a.persistentData=l:f.freeType(l)):t(g[0])&&(a.dimension=g[0].length,a.dtype=n||m(g[0])||5126,g=x(g,[g.length,g[0].length],a.dtype),B(a,g,k),h?a.persistentData=g:f.freeType(g))}else if(t(g))a.dtype=n||m(g),a.dimension=l,B(a,g,k),h&&(a.persistentData=new Uint8Array(new Uint8Array(g.buffer)));else if(b(g)){l=
g.shape;var A=g.stride,H=g.offset,E=0,r=0,V=0,D=0;1===l.length?(E=l[0],r=1,V=A[0],D=0):2===l.length&&(E=l[0],r=l[1],V=A[0],D=A[1]);a.dtype=n||m(g.data)||5126;a.dimension=r;l=f.allocType(a.dtype,E*r);u(l,g.data,E,r,V,D,H);B(a,l,k);h?a.persistentData=l:f.freeType(l)}}function E(b){h.bufferCount--;n.deleteBuffer(b.buffer);b.buffer=null;delete g[b.id]}var D=0,g={};k.prototype.bind=function(){n.bindBuffer(this.type,this.buffer)};k.prototype.destroy=function(){E(this)};var p=[];A.profile&&(h.getTotalBufferSize=
function(){var b=0;Object.keys(g).forEach(function(a){b+=g[a].stats.size});return b});return{create:function(a,B,D,p){function Y(a){var c=35044,g=null,f=0,k=0,m=1;Array.isArray(a)||t(a)||b(a)?g=a:"number"===typeof a?f=a|0:a&&("data"in a&&(g=a.data),"usage"in a&&(c=l[a.usage]),"type"in a&&(k=C[a.type]),"dimension"in a&&(m=a.dimension|0),"length"in a&&(f=a.length|0));q.bind();g?w(q,g,c,k,m,p):(n.bufferData(q.type,f,c),q.dtype=k||5121,q.usage=c,q.dimension=m,q.byteLength=f);A.profile&&(q.stats.size=
q.byteLength*F[q.dtype]);return Y}h.bufferCount++;var q=new k(B);g[q.id]=q;D||Y(a);Y._reglType="buffer";Y._buffer=q;Y.subdata=function(a,g){var k=(g||0)|0,r;q.bind();if(Array.isArray(a)){if(0<a.length)if("number"===typeof a[0]){var l=f.allocType(q.dtype,a.length);c(l,a);n.bufferSubData(q.type,k,l);f.freeType(l)}else if(Array.isArray(a[0])||t(a[0]))r=O(a),l=x(a,r,q.dtype),n.bufferSubData(q.type,k,l),f.freeType(l)}else if(t(a))n.bufferSubData(q.type,k,a);else if(b(a)){r=a.shape;var h=a.stride,A=l=0,
B=0,E=0;1===r.length?(l=r[0],A=1,B=h[0],E=0):2===r.length&&(l=r[0],A=r[1],B=h[0],E=h[1]);r=Array.isArray(a.data)?q.dtype:m(a.data);r=f.allocType(r,l*A);u(r,a.data,l,A,B,E,a.offset);n.bufferSubData(q.type,k,r);f.freeType(r)}return Y};A.profile&&(Y.stats=q.stats);Y.destroy=function(){E(q)};return Y},createStream:function(a,b){var c=p.pop();c||(c=new k(a));c.bind();w(c,b,35040,0,1,!1);return c},destroyStream:function(a){p.push(a)},clear:function(){a(g).forEach(E);p.forEach(E)},getBuffer:function(a){return a&&
a._buffer instanceof k?a._buffer:null},restore:function(){a(g).forEach(function(a){a.buffer=n.createBuffer();n.bindBuffer(a.type,a.buffer);n.bufferData(a.type,a.persistentData||a.byteLength,a.usage)})},_initBuffer:w}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/flatten":24,"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/pool":29,"./util/values":32}],4:[function(h,p,q){p.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,
"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(h,p,q){p.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(h,p,q){p.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(h,
p,q){p.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(h,p,q){function m(a){return Array.isArray(a)||O(a)||w(a)}function c(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function u(a,b,c,f){this.thisDep=a;this.contextDep=b;this.propDep=c;this.append=f}function t(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function b(a){return new u(!1,!1,!1,a)}function a(a,b){var c=a.type;return 0===c?(c=a.data.length,new u(!0,1<=c,2<=c,b)):4===c?(c=
a.data,new u(c.thisDep,c.contextDep,c.propDep,b)):new u(3===c,2===c,1===c,b)}var f=h("./util/codegen"),x=h("./util/loop"),O=h("./util/is-typed-array"),w=h("./util/is-ndarray"),C=h("./util/is-array-like"),l=h("./dynamic"),F=h("./constants/primitives.json"),n=h("./constants/dtypes.json"),I=["x","y","z","w"],A="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),k={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,
"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},B={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},J={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,
"increment wrap":34055,"decrement wrap":34056,invert:5386},E={cw:2304,ccw:2305},D=new u(!1,!1,!1,function(){});p.exports=function(g,h,w,p,q,O,Fa,Z,H,U,sa,r,V,ka,da){function W(d){return d.replace(".","_")}function P(d,a,b){var c=W(d);v.push(d);y[c]=e[c]=!!b;ta[c]=a}function G(d,a,c){var b=W(d);v.push(d);Array.isArray(c)?(e[b]=c.slice(),y[b]=c.slice()):e[b]=y[b]=c;ua[b]=a}function aa(){var d=f(),a=d.link,b=d.global;d.id=Qa++;d.batchId="0";var c=a(Oa),g=d.shared={props:"a0"};Object.keys(Oa).forEach(function(a){g[a]=
b.def(c,".",a)});var Ka=d.next={},M=d.current={};Object.keys(ua).forEach(function(a){Array.isArray(e[a])&&(Ka[a]=b.def(g.next,".",a),M[a]=b.def(g.current,".",a))});var Ra=d.constants={};Object.keys(La).forEach(function(a){Ra[a]=b.def(JSON.stringify(La[a]))});d.invoke=function(e,K){switch(K.type){case 0:var b=["this",g.context,g.props,d.batchId];return e.def(a(K.data),".call(",b.slice(0,Math.max(K.data.length+1,4)),")");case 1:return e.def(g.props,K.data);case 2:return e.def(g.context,K.data);case 3:return e.def("this",
K.data);case 4:return K.data.append(d,e),K.data.ref}};d.attribCache={};var K={};d.scopeAttrib=function(d){d=h.id(d);if(d in K)return K[d];var e=U.scope[d];e||(e=U.scope[d]=new ya);return K[d]=a(e)};return d}function la(d){var e=d["static"];d=d.dynamic;var c;if("profile"in e){var g=!!e.profile;c=b(function(a,d){return g});c.enable=g}else if("profile"in d){var f=d.profile;c=a(f,function(a,d){return a.invoke(d,f)})}return c}function va(d,e){var c=d["static"],g=d.dynamic;if("framebuffer"in c){var f=c.framebuffer;
return f?(f=Z.getFramebuffer(f),b(function(a,d){var e=a.link(f),c=a.shared;d.set(c.framebuffer,".next",e);c=c.context;d.set(c,".framebufferWidth",e+".width");d.set(c,".framebufferHeight",e+".height");return e})):b(function(a,d){var e=a.shared;d.set(e.framebuffer,".next","null");e=e.context;d.set(e,".framebufferWidth",e+".drawingBufferWidth");d.set(e,".framebufferHeight",e+".drawingBufferHeight");return"null"})}if("framebuffer"in g){var Ka=g.framebuffer;return a(Ka,function(a,d){var e=a.invoke(d,Ka),
c=a.shared,b=c.framebuffer,e=d.def(b,".getFramebuffer(",e,")");d.set(b,".next",e);c=c.context;d.set(c,".framebufferWidth",e+"?"+e+".width:"+c+".drawingBufferWidth");d.set(c,".framebufferHeight",e+"?"+e+".height:"+c+".drawingBufferHeight");return e})}return null}function S(d,e,c){function b(d){if(d in g){var c=g[d];d=!0;var Pa=c.x|0,xa=c.y|0,M,Ba;"width"in c?M=c.width|0:d=!1;"height"in c?Ba=c.height|0:d=!1;return new u(!d&&e&&e.thisDep,!d&&e&&e.contextDep,!d&&e&&e.propDep,function(d,e){var a=d.shared.context,
b=M;"width"in c||(b=e.def(a,".","framebufferWidth","-",Pa));var z=Ba;"height"in c||(z=e.def(a,".","framebufferHeight","-",xa));return[Pa,xa,b,z]})}if(d in f){var k=f[d];d=a(k,function(d,e){var a=d.invoke(e,k),c=d.shared.context,b=e.def(a,".x|0"),K=e.def(a,".y|0"),z=e.def('"width" in ',a,"?",a,".width|0:","(",c,".","framebufferWidth","-",b,")"),a=e.def('"height" in ',a,"?",a,".height|0:","(",c,".","framebufferHeight","-",K,")");return[b,K,z,a]});e&&(d.thisDep=d.thisDep||e.thisDep,d.contextDep=d.contextDep||
e.contextDep,d.propDep=d.propDep||e.propDep);return d}return e?new u(e.thisDep,e.contextDep,e.propDep,function(d,e){var a=d.shared.context;return[0,0,e.def(a,".","framebufferWidth"),e.def(a,".","framebufferHeight")]}):null}var g=d["static"],f=d.dynamic;if(d=b("viewport")){var M=d;d=new u(d.thisDep,d.contextDep,d.propDep,function(d,e){var a=M.append(d,e),c=d.shared.context;e.set(c,".viewportWidth",a[2]);e.set(c,".viewportHeight",a[3]);return a})}return{viewport:d,scissor_box:b("scissor.box")}}function fa(d){function e(d){if(d in
c){var K=h.id(c[d]);d=b(function(){return K});d.id=K;return d}if(d in g){var z=g[d];return a(z,function(d,e){var a=d.invoke(e,z);return e.def(d.shared.strings,".id(",a,")")})}return null}var c=d["static"],g=d.dynamic,f=e("frag"),k=e("vert"),M=null;t(f)&&t(k)?(M=sa.program(k.id,f.id),d=b(function(d,e){return d.link(M)})):d=new u(f&&f.thisDep||k&&k.thisDep,f&&f.contextDep||k&&k.contextDep,f&&f.propDep||k&&k.propDep,function(d,e){var a=d.shared.shader,c;c=f?f.append(d,e):e.def(a,".","frag");var b;b=
k?k.append(d,e):e.def(a,".","vert");return e.def(a+".program("+b+","+c+")")});return{frag:f,vert:k,progVar:d,program:M}}function ha(d,e){function c(d,e){if(d in g){var z=g[d]|0;return b(function(d,a){e&&(d.OFFSET=z);return z})}if(d in f){var xa=f[d];return a(xa,function(d,a){var c=d.invoke(a,xa);e&&(d.OFFSET=c);return c})}return e&&k?b(function(d,e){d.OFFSET="0";return 0}):null}var g=d["static"],f=d.dynamic,k=function(){if("elements"in g){var d=g.elements;m(d)?d=O.getElements(O.create(d,!0)):d&&(d=
O.getElements(d));var e=b(function(e,a){if(d){var c=e.link(d);return e.ELEMENTS=c}return e.ELEMENTS=null});e.value=d;return e}if("elements"in f){var c=f.elements;return a(c,function(d,e){var a=d.shared,b=a.isBufferArgs,a=a.elements,K=d.invoke(e,c),z=e.def("null"),b=e.def(b,"(",K,")"),K=d.cond(b).then(z,"=",a,".createStream(",K,");")["else"](z,"=",a,".getElements(",K,");");e.entry(K);e.exit(d.cond(b).then(a,".destroyStream(",z,");"));return d.ELEMENTS=z})}return null}(),M=c("offset",!0);return{elements:k,
primitive:function(){if("primitive"in g){var d=g.primitive;return b(function(e,a){return F[d]})}if("primitive"in f){var e=f.primitive;return a(e,function(d,a){var c=d.constants.primTypes,b=d.invoke(a,e);return a.def(c,"[",b,"]")})}return k?t(k)?k.value?b(function(d,e){return e.def(d.ELEMENTS,".primType")}):b(function(){return 4}):new u(k.thisDep,k.contextDep,k.propDep,function(d,e){var a=d.ELEMENTS;return e.def(a,"?",a,".primType:",4)}):null}(),count:function(){if("count"in g){var d=g.count|0;return b(function(){return d})}if("count"in
f){var e=f.count;return a(e,function(d,a){return d.invoke(a,e)})}return k?t(k)?k?M?new u(M.thisDep,M.contextDep,M.propDep,function(d,e){return e.def(d.ELEMENTS,".vertCount-",d.OFFSET)}):b(function(d,e){return e.def(d.ELEMENTS,".vertCount")}):b(function(){return-1}):new u(k.thisDep||M.thisDep,k.contextDep||M.contextDep,k.propDep||M.propDep,function(d,e){var a=d.ELEMENTS;return d.OFFSET?e.def(a,"?",a,".vertCount-",d.OFFSET,":-1"):e.def(a,"?",a,".vertCount:-1")}):null}(),instances:c("instances",!1),
offset:M}}function oa(d,e){var c=d["static"],g=d.dynamic,f={};v.forEach(function(d){function e(K,k){if(d in c){var xa=K(c[d]);f[z]=b(function(){return xa})}else if(d in g){var M=g[d];f[z]=a(M,function(d,e){return k(d,e,d.invoke(e,M))})}}var z=W(d);switch(d){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return e(function(d){return d},function(d,
e,a){return a});case "depth.func":return e(function(d){return B[d]},function(d,e,a){return e.def(d.constants.compareFuncs,"[",a,"]")});case "depth.range":return e(function(d){return d},function(d,e,a){d=e.def("+",a,"[0]");e=e.def("+",a,"[1]");return[d,e]});case "blend.func":return e(function(d){return[k["srcRGB"in d?d.srcRGB:d.src],k["dstRGB"in d?d.dstRGB:d.dst],k["srcAlpha"in d?d.srcAlpha:d.src],k["dstAlpha"in d?d.dstAlpha:d.dst]]},function(d,e,a){function c(d,b){return e.def('"',d,b,'" in ',a,"?",
a,".",d,b,":",a,".",d)}d=d.constants.blendFuncs;var b=c("src","RGB"),z=c("dst","RGB"),b=e.def(d,"[",b,"]"),g=e.def(d,"[",c("src","Alpha"),"]"),z=e.def(d,"[",z,"]");d=e.def(d,"[",c("dst","Alpha"),"]");return[b,z,g,d]});case "blend.equation":return e(function(d){if("string"===typeof d)return[Q[d],Q[d]];if("object"===typeof d)return[Q[d.rgb],Q[d.alpha]]},function(d,e,a){var c=d.constants.blendEquations,b=e.def(),z=e.def();d=d.cond("typeof ",a,'==="string"');d.then(b,"=",z,"=",c,"[",a,"];");d["else"](b,
"=",c,"[",a,".rgb];",z,"=",c,"[",a,".alpha];");e(d);return[b,z]});case "blend.color":return e(function(d){return x(4,function(e){return+d[e]})},function(d,e,a){return x(4,function(d){return e.def("+",a,"[",d,"]")})});case "stencil.mask":return e(function(d){return d|0},function(d,e,a){return e.def(a,"|0")});case "stencil.func":return e(function(d){return[B[d.cmp||"keep"],d.ref||0,"mask"in d?d.mask:-1]},function(d,e,a){d=e.def('"cmp" in ',a,"?",d.constants.compareFuncs,"[",a,".cmp]",":",7680);var c=
e.def(a,".ref|0");e=e.def('"mask" in ',a,"?",a,".mask|0:-1");return[d,c,e]});case "stencil.opFront":case "stencil.opBack":return e(function(e){return["stencil.opBack"===d?1029:1028,J[e.fail||"keep"],J[e.zfail||"keep"],J[e.zpass||"keep"]]},function(e,a,c){function b(d){return a.def('"',d,'" in ',c,"?",z,"[",c,".",d,"]:",7680)}var z=e.constants.stencilOps;return["stencil.opBack"===d?1029:1028,b("fail"),b("zfail"),b("zpass")]});case "polygonOffset.offset":return e(function(d){return[d.factor|0,d.units|
0]},function(d,e,a){d=e.def(a,".factor|0");e=e.def(a,".units|0");return[d,e]});case "cull.face":return e(function(d){var e=0;"front"===d?e=1028:"back"===d&&(e=1029);return e},function(d,e,a){return e.def(a,'==="front"?',1028,":",1029)});case "lineWidth":return e(function(d){return d},function(d,e,a){return a});case "frontFace":return e(function(d){return E[d]},function(d,e,a){return e.def(a+'==="cw"?2304:2305')});case "colorMask":return e(function(d){return d.map(function(d){return!!d})},function(d,
e,a){return x(4,function(d){return"!!"+a+"["+d+"]"})});case "sample.coverage":return e(function(d){return["value"in d?d.value:1,!!d.invert]},function(d,e,a){d=e.def('"value" in ',a,"?+",a,".value:1");e=e.def("!!",a,".invert");return[d,e]})}});return f}function pa(d,e){var c=d["static"],g=d.dynamic,f={};Object.keys(c).forEach(function(d){var e=c[d],a;if("number"===typeof e||"boolean"===typeof e)a=b(function(){return e});else if("function"===typeof e){var z=e._reglType;if("texture2d"===z||"textureCube"===
z)a=b(function(d){return d.link(e)});else if("framebuffer"===z||"framebufferCube"===z)a=b(function(d){return d.link(e.color[0])})}else C(e)&&(a=b(function(d){return d.global.def("[",x(e.length,function(d){return e[d]}),"]")}));a.value=e;f[d]=a});Object.keys(g).forEach(function(d){var e=g[d];f[d]=a(e,function(d,a){return d.invoke(a,e)})});return f}function ba(d,e){var c=d["static"],g=d.dynamic,f={};Object.keys(c).forEach(function(d){var e=c[d],a=h.id(d),z=new ya;if(m(e))z.state=1,z.buffer=q.getBuffer(q.create(e,
34962,!1,!0)),z.type=0;else{var g=q.getBuffer(e);if(g)z.state=1,z.buffer=g,z.type=0;else if(e.constant){var k=e.constant;z.buffer="null";z.state=2;"number"===typeof k?z.x=k:I.forEach(function(d,e){e<k.length&&(z[d]=k[e])})}else{var g=m(e.buffer)?q.getBuffer(q.create(e.buffer,34962,!1,!0)):q.getBuffer(e.buffer),v=e.offset|0,y=e.stride|0,l=e.size|0,r=!!e.normalized,t=0;"type"in e&&(t=n[e.type]);e=e.divisor|0;z.buffer=g;z.state=1;z.size=l;z.normalized=r;z.type=t||g.dtype;z.offset=v;z.stride=y;z.divisor=
e}}f[d]=b(function(d,e){var c=d.attribCache;if(a in c)return c[a];var b={isStream:!1};Object.keys(z).forEach(function(d){b[d]=z[d]});z.buffer&&(b.buffer=d.link(z.buffer),b.type=b.type||b.buffer+".dtype");return c[a]=b})});Object.keys(g).forEach(function(d){var e=g[d];f[d]=a(e,function(d,a){function c(d){a(k[d],"=",b,".",d,"|0;")}var b=d.invoke(a,e),z=d.shared,g=z.isBufferArgs,f=z.buffer,k={isStream:a.def(!1)},v=new ya;v.state=1;Object.keys(v).forEach(function(d){k[d]=a.def(""+v[d])});var y=k.buffer,
Ba=k.type;a("if(",g,"(",b,")){",k.isStream,"=true;",y,"=",f,".createStream(",34962,",",b,");",Ba,"=",y,".dtype;","}else{",y,"=",f,".getBuffer(",b,");","if(",y,"){",Ba,"=",y,".dtype;",'}else if("constant" in ',b,"){",k.state,"=",2,";","if(typeof "+b+'.constant === "number"){',k[I[0]],"=",b,".constant;",I.slice(1).map(function(d){return k[d]}).join("="),"=0;","}else{",I.map(function(d,e){return k[d]+"="+b+".constant.length>="+e+"?"+b+".constant["+e+"]:0;"}).join(""),"}}else{","if(",g,"(",b,".buffer)){",
y,"=",f,".createStream(",34962,",",b,".buffer);","}else{",y,"=",f,".getBuffer(",b,".buffer);","}",Ba,'="type" in ',b,"?",z.glTypes,"[",b,".type]:",y,".dtype;",k.normalized,"=!!",b,".normalized;");c("size");c("offset");c("stride");c("divisor");a("}}");a.exit("if(",k.isStream,"){",f,".destroyStream(",y,");","}");return k})});return f}function ga(d){var e=d["static"],c=d.dynamic,g={};Object.keys(e).forEach(function(d){var a=e[d];g[d]=b(function(d,e){return"number"===typeof a||"boolean"===typeof a?""+
a:d.link(a)})});Object.keys(c).forEach(function(d){var e=c[d];g[d]=a(e,function(d,a){return d.invoke(a,e)})});return g}function ia(d,e,a,c,b){var g=va(d,b),f=S(d,g,b),k=ha(d,b),y=oa(d,b),v=fa(d,b),l=f.viewport;l&&(y.viewport=l);l=W("scissor.box");(f=f[l])&&(y[l]=f);f=0<Object.keys(y).length;g={framebuffer:g,draw:k,shader:v,state:y,dirty:f};g.profile=la(d,b);g.uniforms=pa(a,b);g.attributes=ba(e,b);g.context=ga(c,b);return g}function ca(d,e,a){var c=d.shared.context,b=d.scope();Object.keys(a).forEach(function(g){e.save(c,
"."+g);b(c,".",g,"=",a[g].append(d,e),";")});e(b)}function L(d,e,a,c){var b=d.shared,g=b.gl,f=b.framebuffer,k;ma&&(k=e.def(b.extensions,".webgl_draw_buffers"));var y=d.constants,b=y.drawBuffer,y=y.backBuffer;d=a?a.append(d,e):e.def(f,".next");c||e("if(",d,"!==",f,".cur){");e("if(",d,"){",g,".bindFramebuffer(",36160,",",d,".framebuffer);");ma&&e(k,".drawBuffersWEBGL(",b,"[",d,".colorAttachments.length]);");e("}else{",g,".bindFramebuffer(",36160,",null);");ma&&e(k,".drawBuffersWEBGL(",y,");");e("}",
f,".cur=",d,";");c||e("}")}function ea(d,a,c){var b=d.shared,g=b.gl,f=d.current,k=d.next,y=b.current,l=b.next,r=d.cond(y,".dirty");v.forEach(function(a){a=W(a);if(!(a in c.state)){var b,z;if(a in k){b=k[a];z=f[a];var v=x(e[a].length,function(d){return r.def(b,"[",d,"]")});r(d.cond(v.map(function(d,e){return d+"!=="+z+"["+e+"]"}).join("||")).then(g,".",ua[a],"(",v,");",v.map(function(d,e){return z+"["+e+"]="+d}).join(";"),";"))}else b=r.def(l,".",a),v=d.cond(b,"!==",y,".",a),r(v),a in ta?v(d.cond(b).then(g,
".enable(",ta[a],");")["else"](g,".disable(",ta[a],");"),y,".",a,"=",b,";"):v(g,".",ua[a],"(",b,");",y,".",a,"=",b,";")}});0===Object.keys(c.state).length&&r(y,".dirty=false;");a(r)}function N(d,e,a,b){var g=d.shared,f=d.current,k=g.current,y=g.gl;c(Object.keys(a)).forEach(function(c){var g=a[c];if(!b||b(g)){var v=g.append(d,e);if(ta[c]){var l=ta[c];t(g)?v?e(y,".enable(",l,");"):e(y,".disable(",l,");"):e(d.cond(v).then(y,".enable(",l,");")["else"](y,".disable(",l,");"));e(k,".",c,"=",v,";")}else if(C(v)){var r=
f[c];e(y,".",ua[c],"(",v,");",v.map(function(d,e){return r+"["+e+"]="+d}).join(";"),";")}else e(y,".",ua[c],"(",v,");",k,".",c,"=",v,";")}})}function na(d,e){qa&&(d.instancing=e.def(d.shared.extensions,".angle_instanced_arrays"))}function T(d,e,a,c,b){function g(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function f(d){h=e.def();d(h,"=",g(),";");"string"===typeof b?d(l,".count+=",b,";"):d(l,".count++;");ka&&(c?(n=e.def(),d(n,"=",m,".getNumPendingQueries();")):d(m,".beginQuery(",
l,");"))}function k(d){d(l,".cpuTime+=",g(),"-",h,";");ka&&(c?d(m,".pushScopeStats(",n,",",m,".getNumPendingQueries(),",l,");"):d(m,".endQuery();"))}function y(d){var a=e.def(r,".profile");e(r,".profile=",d,";");e.exit(r,".profile=",a,";")}var v=d.shared,l=d.stats,r=v.current,m=v.timer;a=a.profile;var h,n;if(a){if(t(a)){a.enable?(f(e),k(e.exit),y("true")):y("false");return}a=a.append(d,e);y(a)}else a=e.def(r,".profile");v=d.block();f(v);e("if(",a,"){",v,"}");d=d.block();k(d);e.exit("if(",a,"){",d,
"}")}function X(d,e,a,c,b){function g(d){switch(d){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function f(a,c,b){function g(){e("if(!",r,".buffer){",v,".enableVertexAttribArray(",l,");}");var a=b.type,f;f=b.size?e.def(b.size,"||",c):c;e("if(",r,".type!==",a,"||",r,".size!==",f,"||",t.map(function(d){return r+"."+d+"!=="+b[d]}).join("||"),"){",v,".bindBuffer(",34962,",",m,".buffer);",v,".vertexAttribPointer(",
[l,f,a,b.normalized,b.stride,b.offset],");",r,".type=",a,";",r,".size=",f,";",t.map(function(d){return r+"."+d+"="+b[d]+";"}).join(""),"}");qa&&(a=b.divisor,e("if(",r,".divisor!==",a,"){",d.instancing,".vertexAttribDivisorANGLE(",[l,a],");",r,".divisor=",a,";}"))}function y(){e("if(",r,".buffer){",v,".disableVertexAttribArray(",l,");","}if(",I.map(function(d,e){return r+"."+d+"!=="+h[e]}).join("||"),"){",v,".vertexAttrib4f(",l,",",h,");",I.map(function(d,e){return r+"."+d+"="+h[e]+";"}).join(""),
"}")}var v=k.gl,l=e.def(a,".location"),r=e.def(k.attributes,"[",l,"]");a=b.state;var m=b.buffer,h=[b.x,b.y,b.z,b.w],t=["buffer","normalized","offset","stride"];1===a?g():2===a?y():(e("if(",a,"===",1,"){"),g(),e("}else{"),y(),e("}"))}var k=d.shared;c.forEach(function(c){var k=c.name,y=a.attributes[k],v;if(y){if(!b(y))return;v=y.append(d,e)}else{if(!b(D))return;var l=d.scopeAttrib(k);v={};Object.keys(new ya).forEach(function(d){v[d]=e.def(l,".",d)})}f(d.link(c),g(c.info.type),v)})}function R(d,e,a,
c,b){for(var g=d.shared,f=g.gl,k,y=0;y<c.length;++y){var v=c[y],l=v.name,r=v.info.type,m=a.uniforms[l],v=d.link(v)+".location",n;if(m){if(!b(m))continue;if(t(m)){l=m.value;if(35678===r||35680===r)r=d.link(l._texture||l.color[0]._texture),e(f,".uniform1i(",v,",",r+".bind());"),e.exit(r,".unbind();");else if(35674===r||35675===r||35676===r)l=d.global.def("new Float32Array(["+Array.prototype.slice.call(l)+"])"),m=2,35675===r?m=3:35676===r&&(m=4),e(f,".uniformMatrix",m,"fv(",v,",false,",l,");");else{switch(r){case 5126:k=
"1f";break;case 35664:k="2f";break;case 35665:k="3f";break;case 35666:k="4f";break;case 35670:k="1i";break;case 5124:k="1i";break;case 35671:k="2i";break;case 35667:k="2i";break;case 35672:k="3i";break;case 35668:k="3i";break;case 35673:k="4i";break;case 35669:k="4i"}e(f,".uniform",k,"(",v,",",C(l)?Array.prototype.slice.call(l):l,");")}continue}else n=m.append(d,e)}else{if(!b(D))continue;n=e.def(g.uniforms,"[",h.id(l),"]")}35678===r?e("if(",n,"&&",n,'._reglType==="framebuffer"){',n,"=",n,".color[0];",
"}"):35680===r&&e("if(",n,"&&",n,'._reglType==="framebufferCube"){',n,"=",n,".color[0];","}");l=1;switch(r){case 35678:case 35680:r=e.def(n,"._texture");e(f,".uniform1i(",v,",",r,".bind());");e.exit(r,".unbind();");continue;case 5124:case 35670:k="1i";break;case 35667:case 35671:k="2i";l=2;break;case 35668:case 35672:k="3i";l=3;break;case 35669:case 35673:k="4i";l=4;break;case 5126:k="1f";break;case 35664:k="2f";l=2;break;case 35665:k="3f";l=3;break;case 35666:k="4f";l=4;break;case 35674:k="Matrix2fv";
break;case 35675:k="Matrix3fv";break;case 35676:k="Matrix4fv"}e(f,".uniform",k,"(",v,",");if("M"===k.charAt(0)){var v=Math.pow(r-35674+2,2),u=d.global.def("new Float32Array(",v,")");e("false,(Array.isArray(",n,")||",n," instanceof Float32Array)?",n,":(",x(v,function(d){return u+"["+d+"]="+n+"["+d+"]"}),",",u,")")}else 1<l?e(x(l,function(d){return n+"["+d+"]"})):e(n);e(");")}}function ra(d,e,a,c){function b(g){var k=l[g];return k?k.contextDep&&c.contextDynamic||k.propDep?k.append(d,a):k.append(d,e):
e.def(y,".",g)}function g(){function d(){a(A,".drawElementsInstancedANGLE(",[m,h,x,n+"<<(("+x+"-5121)>>1)",u],");")}function e(){a(A,".drawArraysInstancedANGLE(",[m,n,h,u],");")}r?B?d():(a("if(",r,"){"),d(),a("}else{"),e(),a("}")):e()}function k(){function d(){a(v+".drawElements("+[m,h,x,n+"<<(("+x+"-5121)>>1)"]+");")}function e(){a(v+".drawArrays("+[m,n,h]+");")}r?B?d():(a("if(",r,"){"),d(),a("}else{"),e(),a("}")):e()}var f=d.shared,v=f.gl,y=f.draw,l=c.draw,r=function(){var b=l.elements,g=e;if(b){if(b.contextDep&&
c.contextDynamic||b.propDep)g=a;b=b.append(d,g)}else b=g.def(y,".","elements");b&&g("if("+b+")"+v+".bindBuffer(34963,"+b+".buffer.buffer);");return b}(),m=b("primitive"),n=b("offset"),h=function(){var b=l.count,g=e;if(b){if(b.contextDep&&c.contextDynamic||b.propDep)g=a;b=b.append(d,g)}else b=g.def(y,".","count");return b}();if("number"===typeof h){if(0===h)return}else a("if(",h,"){"),a.exit("}");var u,A;qa&&(u=b("instances"),A=d.instancing);var x=r+".type",B=l.elements&&t(l.elements);qa&&("number"!==
typeof u||0<=u)?"string"===typeof u?(a("if(",u,">0){"),g(),a("}else if(",u,"<0){"),k(),a("}")):g():k()}function Ca(d,e,a,b,c){e=aa();c=e.proc("body",c);qa&&(e.instancing=c.def(e.shared.extensions,".angle_instanced_arrays"));d(e,c,a,b);return e.compile().body}function Da(d,e,a,b){na(d,e);X(d,e,a,b.attributes,function(){return!0});R(d,e,a,b.uniforms,function(){return!0});ra(d,e,e,a)}function Ga(d,e){var a=d.proc("draw",1);na(d,a);ca(d,a,e.context);L(d,a,e.framebuffer);ea(d,a,e);N(d,a,e.state);T(d,a,
e,!1,!0);var b=e.shader.progVar.append(d,a);a(d.shared.gl,".useProgram(",b,".program);");if(e.shader.program)Da(d,a,e,e.shader.program);else{var c=d.global.def("{}"),g=a.def(b,".id"),k=a.def(c,"[",g,"]");a(d.cond(k).then(k,".call(this,a0);")["else"](k,"=",c,"[",g,"]=",d.link(function(a){return Ca(Da,d,e,a,1)}),"(",b,");",k,".call(this,a0);"))}0<Object.keys(e.state).length&&a(d.shared.current,".dirty=true;")}function Ha(e,a,b,c){function g(){return!0}e.batchId="a1";na(e,a);X(e,a,b,c.attributes,g);
R(e,a,b,c.uniforms,g);ra(e,a,a,b)}function za(e,a,b,c){function g(e){return e.contextDep&&f||e.propDep}function k(e){return!g(e)}na(e,a);var f=b.contextDep,v=a.def(),y=a.def();e.shared.props=y;e.batchId=v;var l=e.scope(),r=e.scope();a(l.entry,"for(",v,"=0;",v,"<","a1",";++",v,"){",y,"=","a0","[",v,"];",r,"}",l.exit);b.needsContext&&ca(e,r,b.context);b.needsFramebuffer&&L(e,r,b.framebuffer);N(e,r,b.state,g);b.profile&&g(b.profile)&&T(e,r,b,!1,!0);c?(X(e,l,b,c.attributes,k),X(e,r,b,c.attributes,g),
R(e,l,b,c.uniforms,k),R(e,r,b,c.uniforms,g),ra(e,l,r,b)):(a=e.global.def("{}"),c=b.shader.progVar.append(e,r),y=r.def(c,".id"),l=r.def(a,"[",y,"]"),r(e.shared.gl,".useProgram(",c,".program);","if(!",l,"){",l,"=",a,"[",y,"]=",e.link(function(a){return Ca(Ha,e,b,a,2)}),"(",c,");}",l,".call(this,a0[",v,"],",v,");"))}function Aa(e,a){function b(e){return e.contextDep&&g||e.propDep}var c=e.proc("batch",2);e.batchId="0";na(e,c);var g=!1,k=!0;Object.keys(a.context).forEach(function(e){g=g||a.context[e].propDep});
g||(ca(e,c,a.context),k=!1);var f=a.framebuffer,v=!1;f?(f.propDep?g=v=!0:f.contextDep&&g&&(v=!0),v||L(e,c,f)):L(e,c,null);a.state.viewport&&a.state.viewport.propDep&&(g=!0);ea(e,c,a);N(e,c,a.state,function(e){return!b(e)});a.profile&&b(a.profile)||T(e,c,a,!1,"a1");a.contextDep=g;a.needsContext=k;a.needsFramebuffer=v;k=a.shader.progVar;if(k.contextDep&&g||k.propDep)za(e,c,a,null);else if(k=k.append(e,c),c(e.shared.gl,".useProgram(",k,".program);"),a.shader.program)za(e,c,a,a.shader.program);else{var f=
e.global.def("{}"),v=c.def(k,".id"),l=c.def(f,"[",v,"]");c(e.cond(l).then(l,".call(this,a0,a1);")["else"](l,"=",f,"[",v,"]=",e.link(function(b){return Ca(za,e,a,b,2)}),"(",k,");",l,".call(this,a0,a1);"))}0<Object.keys(a.state).length&&c(e.shared.current,".dirty=true;")}function Na(e,a){function b(c){var f=a.shader[c];f&&g.set(k.shader,"."+c,f.append(e,g))}var g=e.proc("scope",3);e.batchId="a2";var k=e.shared,f=k.current;ca(e,g,a.context);a.framebuffer&&a.framebuffer.append(e,g);c(Object.keys(a.state)).forEach(function(b){var c=
a.state[b].append(e,g);C(c)?c.forEach(function(a,c){g.set(e.next[b],"["+c+"]",a)}):g.set(k.next,"."+b,c)});T(e,g,a,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(b){var c=a.draw[b];c&&g.set(k.draw,"."+b,""+c.append(e,g))});Object.keys(a.uniforms).forEach(function(b){g.set(k.uniforms,"["+h.id(b)+"]",a.uniforms[b].append(e,g))});Object.keys(a.attributes).forEach(function(b){var c=a.attributes[b].append(e,g),k=e.scopeAttrib(b);Object.keys(new ya).forEach(function(e){g.set(k,
"."+e,c[e])})});b("vert");b("frag");0<Object.keys(a.state).length&&(g(f,".dirty=true;"),g.exit(f,".dirty=true;"));g("a1(",e.shared.context,",a0,",e.batchId,");")}function Ma(e){if("object"===typeof e&&!C(e)){for(var a=Object.keys(e),b=0;b<a.length;++b)if(l.isDynamic(e[a[b]]))return!0;return!1}}function Ia(e,b,c){function g(e,a){v.forEach(function(d){var b=k[d];l.isDynamic(b)&&(b=e.invoke(a,b),a(n,".",d,"=",b,";"))})}var k=b["static"][c];if(k&&Ma(k)){var f=e.global,v=Object.keys(k),y=!1,r=!1,m=!1,
n=e.global.def("{}");v.forEach(function(b){var c=k[b];if(l.isDynamic(c))"function"===typeof c&&(c=k[b]=l.unbox(c)),b=a(c,null),y=y||b.thisDep,m=m||b.propDep,r=r||b.contextDep;else{f(n,".",b,"=");switch(typeof c){case "number":f(c);break;case "string":f('"',c,'"');break;case "object":Array.isArray(c)&&f("[",c.join(),"]");break;default:f(e.link(c))}f(";")}});b.dynamic[c]=new l.DynamicVariable(4,{thisDep:y,contextDep:r,propDep:m,ref:n,append:g});delete b["static"][c]}}var ya=U.Record,Q={add:32774,subtract:32778,
"reverse subtract":32779};w.ext_blend_minmax&&(Q.min=32775,Q.max=32776);var qa=w.angle_instanced_arrays,ma=w.webgl_draw_buffers,e={dirty:!0,profile:da.profile},y={},v=[],ta={},ua={};P("dither",3024);P("blend.enable",3042);G("blend.color","blendColor",[0,0,0,0]);G("blend.equation","blendEquationSeparate",[32774,32774]);G("blend.func","blendFuncSeparate",[1,0,1,0]);P("depth.enable",2929,!0);G("depth.func","depthFunc",513);G("depth.range","depthRange",[0,1]);G("depth.mask","depthMask",!0);G("colorMask",
"colorMask",[!0,!0,!0,!0]);P("cull.enable",2884);G("cull.face","cullFace",1029);G("frontFace","frontFace",2305);G("lineWidth","lineWidth",1);P("polygonOffset.enable",32823);G("polygonOffset.offset","polygonOffset",[0,0]);P("sample.alpha",32926);P("sample.enable",32928);G("sample.coverage","sampleCoverage",[1,!1]);P("stencil.enable",2960);G("stencil.mask","stencilMask",-1);G("stencil.func","stencilFunc",[519,0,-1]);G("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);G("stencil.opBack","stencilOpSeparate",
[1029,7680,7680,7680]);P("scissor.enable",3089);G("scissor.box","scissor",[0,0,g.drawingBufferWidth,g.drawingBufferHeight]);G("viewport","viewport",[0,0,g.drawingBufferWidth,g.drawingBufferHeight]);var Oa={gl:g,context:V,strings:h,next:y,current:e,draw:r,elements:O,buffer:q,shader:sa,attributes:U.state,uniforms:H,framebuffer:Z,extensions:w,timer:ka,isBufferArgs:m},La={primTypes:F,compareFuncs:B,blendFuncs:k,blendEquations:Q,stencilOps:J,glTypes:n,orientationType:E};ma&&(La.backBuffer=[1029],La.drawBuffer=
x(p.maxDrawbuffers,function(e){return 0===e?[0]:x(e,function(e){return 36064+e})}));var Qa=0;return{next:y,current:e,procs:function(){var a=aa(),b=a.proc("poll"),c=a.proc("refresh"),k=a.block();b(k);c(k);var f=a.shared,v=f.gl,l=f.next,y=f.current;k(y,".dirty=false;");L(a,b);L(a,c,null,!0);var r=g.getExtension("angle_instanced_arrays"),m;r&&(m=a.link(r));for(var n=0;n<p.maxAttributes;++n){var h=c.def(f.attributes,"[",n,"]"),u=a.cond(h,".buffer");u.then(v,".enableVertexAttribArray(",n,");",v,".bindBuffer(",
34962,",",h,".buffer.buffer);",v,".vertexAttribPointer(",n,",",h,".size,",h,".type,",h,".normalized,",h,".stride,",h,".offset);")["else"](v,".disableVertexAttribArray(",n,");",v,".vertexAttrib4f(",n,",",h,".x,",h,".y,",h,".z,",h,".w);",h,".buffer=null;");c(u);r&&c(m,".vertexAttribDivisorANGLE(",n,",",h,".divisor);")}Object.keys(ta).forEach(function(e){var g=ta[e],f=k.def(l,".",e),r=a.block();r("if(",f,"){",v,".enable(",g,")}else{",v,".disable(",g,")}",y,".",e,"=",f,";");c(r);b("if(",f,"!==",y,".",
e,"){",r,"}")});Object.keys(ua).forEach(function(g){var f=ua[g],r=e[g],m,n,h=a.block();h(v,".",f,"(");C(r)?(f=r.length,m=a.global.def(l,".",g),n=a.global.def(y,".",g),h(x(f,function(e){return m+"["+e+"]"}),");",x(f,function(e){return n+"["+e+"]="+m+"["+e+"];"}).join("")),b("if(",x(f,function(e){return m+"["+e+"]!=="+n+"["+e+"]"}).join("||"),"){",h,"}")):(m=k.def(l,".",g),n=k.def(y,".",g),h(m,");",y,".",g,"=",m,";"),b("if(",m,"!==",n,"){",h,"}"));c(h)});return a.compile()}(),compile:function(e,a,b,
c,g){var k=aa();k.stats=k.link(g);Object.keys(a["static"]).forEach(function(e){Ia(k,a,e)});A.forEach(function(a){Ia(k,e,a)});b=ia(e,a,b,c,k);Ga(k,b);Na(k,b);Aa(k,b);return k.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./dynamic":9,"./util/codegen":22,"./util/is-array-like":25,"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/loop":28}],9:[function(h,p,q){function m(b,a){this.id=t++;this.type=b;this.data=a}function c(b){if(0===b.length)return[];var a=b.charAt(0),
f=b.charAt(b.length-1);if(1<b.length&&a===f&&('"'===a||"'"===a))return['"'+b.substr(1,b.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(a=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(b))return c(b.substr(0,a.index)).concat(c(a[1])).concat(c(b.substr(a.index+a[0].length)));a=b.split(".");if(1===a.length)return['"'+b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];b=[];for(f=0;f<a.length;++f)b=b.concat(c(a[f]));return b}function u(b){return"["+c(b).join("][")+"]"}var t=0;p.exports={DynamicVariable:m,
define:function(b,a){return new m(b,u(a+""))},isDynamic:function(b){return"function"===typeof b&&!b._reglType||b instanceof m},unbox:function(b,a){return"function"===typeof b?new m(0,b):b},accessor:u}},{}],10:[function(h,p,q){var m=h("./util/is-typed-array"),c=h("./util/is-ndarray"),u=h("./util/values"),t=h("./constants/primitives.json"),b=h("./constants/usage.json");p.exports=function(a,f,h,p){function w(a){this.id=n++;F[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function C(b,
l,n,u,t,g,A){b.buffer.bind();if(l){var w=A;A||m(l)&&(!c(l)||m(l.data))||(w=f.oes_element_index_uint?5125:5123);h._initBuffer(b.buffer,l,n,w,3)}else a.bufferData(34963,g,n),b.buffer.dtype=w||5121,b.buffer.usage=n,b.buffer.dimension=3,b.buffer.byteLength=g;w=A;if(!A){switch(b.buffer.dtype){case 5121:case 5120:w=5121;break;case 5123:case 5122:w=5123;break;case 5125:case 5124:w=5125}b.buffer.dtype=w}b.type=w;l=t;0>l&&(l=b.buffer.byteLength,5123===w?l>>=1:5125===w&&(l>>=2));b.vertCount=l;l=u;0>u&&(l=4,
u=b.buffer.dimension,1===u&&(l=0),2===u&&(l=1),3===u&&(l=4));b.primType=l}function l(a){p.elementsCount--;delete F[a.id];a.buffer.destroy();a.buffer=null}var F={},n=0,q={uint8:5121,uint16:5123};f.oes_element_index_uint&&(q.uint32=5125);w.prototype.bind=function(){this.buffer.bind()};var A=[];return{create:function(a,f){function n(a){if(a)if("number"===typeof a)u(a),A.primType=4,A.vertCount=a|0,A.type=5121;else{var k=null,f=35044,l=-1,h=-1,x=0,w=0;if(Array.isArray(a)||m(a)||c(a))k=a;else if("data"in
a&&(k=a.data),"usage"in a&&(f=b[a.usage]),"primitive"in a&&(l=t[a.primitive]),"count"in a&&(h=a.count|0),"type"in a&&(w=q[a.type]),"length"in a)x=a.length|0;else if(x=h,5123===w||5122===w)x*=2;else if(5125===w||5124===w)x*=4;C(A,k,f,l,h,x,w)}else u(),A.primType=4,A.vertCount=0,A.type=5121;return n}var u=h.create(null,34963,!0),A=new w(u._buffer);p.elementsCount++;n(a);n._reglType="elements";n._elements=A;n.subdata=function(a,b){u.subdata(a,b);return n};n.destroy=function(){l(A)};return n},createStream:function(a){var b=
A.pop();b||(b=new w(h.create(null,34963,!0,!1)._buffer));C(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){A.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof w?a._elements:null},clear:function(){u(F).forEach(l)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/values":32}],11:[function(h,p,q){p.exports=function(m,c){function h(a){a=a.toLowerCase();var b;try{b=t[a]=m.getExtension(a)}catch(c){}return!!b}
for(var t={},b=0;b<c.extensions.length;++b){var a=c.extensions[b];if(!h(a))return c.onDestroy(),c.onDone('"'+a+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}c.optionalExtensions.forEach(h);return{extensions:t,restore:function(){Object.keys(t).forEach(function(a){if(!h(a))throw Error("(regl): error restoring extension "+a);})}}}},{}],12:[function(h,p,q){var m=h("./util/values"),c=h("./util/extend"),u=[];u[6408]=4;var t=[];t[5121]=
1;t[5126]=4;t[36193]=2;p.exports=function(b,a,f,h,p,w){function C(a,b,c){this.target=a;this.texture=b;this.renderbuffer=c;var g=a=0;b?(a=b.width,g=b.height):c&&(a=c.width,g=c.height);this.width=a;this.height=g}function l(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function q(a,b,c){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=1)}function n(a,c){c&&(c.texture?b.framebufferTexture2D(36160,a,c.target,c.texture._texture.texture,
0):b.framebufferRenderbuffer(36160,a,36161,c.renderbuffer._renderbuffer.renderbuffer))}function I(a){var b=3553,c=null,g=null,k=a;"object"===typeof a&&(k=a.data,"target"in a&&(b=a.target|0));a=k._reglType;"texture2d"===a?c=k:"textureCube"===a?c=k:"renderbuffer"===a&&(g=k,b=36161);return new C(b,c,g)}function A(a,b,c,g,k){if(c)return a=h.create2D({width:a,height:b,format:g,type:k}),a._texture.refCount=0,new C(3553,a,null);a=p.create({width:a,height:b,format:g});a._renderbuffer.refCount=0;return new C(36161,
null,a)}function k(a){return a&&(a.texture||a.renderbuffer)}function B(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function J(){this.id=Fa++;Z[this.id]=this;this.framebuffer=b.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function E(a){a.colorAttachments.forEach(l);l(a.depthAttachment);l(a.stencilAttachment);l(a.depthStencilAttachment)}function D(a){b.deleteFramebuffer(a.framebuffer);
a.framebuffer=null;w.framebufferCount--;delete Z[a.id]}function g(a){var c;b.bindFramebuffer(36160,a.framebuffer);var g=a.colorAttachments;for(c=0;c<g.length;++c)n(36064+c,g[c]);for(c=g.length;c<f.maxColorAttachments;++c)b.framebufferTexture2D(36160,36064+c,3553,null,0);b.framebufferTexture2D(36160,33306,3553,null,0);b.framebufferTexture2D(36160,36096,3553,null,0);b.framebufferTexture2D(36160,36128,3553,null,0);n(36096,a.depthAttachment);n(36128,a.stencilAttachment);n(33306,a.depthStencilAttachment);
b.checkFramebufferStatus(36160);b.bindFramebuffer(36160,ja.next);ja.cur=ja.next;b.getError()}function Y(a,b){function f(a,b){var c,n=0,m=0,h=!0,x=!0;c=null;var w=!0,p="rgba",B="uint8",C=1,D=null,O=null,J=null,Y=!1;if("number"===typeof a)n=a|0,m=b|0||n;else if(a){"shape"in a?(m=a.shape,n=m[0],m=m[1]):("radius"in a&&(n=m=a.radius),"width"in a&&(n=a.width),"height"in a&&(m=a.height));if("color"in a||"colors"in a)c=a.color||a.colors,Array.isArray(c);if(!c){"colorCount"in a&&(C=a.colorCount|0);"colorTexture"in
a&&(w=!!a.colorTexture,p="rgba4");if("colorType"in a&&(B=a.colorType,!w))if("half float"===B||"float16"===B)p="rgba16f";else if("float"===B||"float32"===B)p="rgba32f";"colorFormat"in a&&(p=a.colorFormat,0<=Ja.indexOf(p)?w=!0:0<=wa.indexOf(p)&&(w=!1))}if("depthTexture"in a||"depthStencilTexture"in a)Y=!(!a.depthTexture&&!a.depthStencilTexture);"depth"in a&&("boolean"===typeof a.depth?h=a.depth:(D=a.depth,x=!1));"stencil"in a&&("boolean"===typeof a.stencil?x=a.stencil:(O=a.stencil,h=!1));"depthStencil"in
a&&("boolean"===typeof a.depthStencil?h=x=a.depthStencil:(J=a.depthStencil,x=h=!1))}else n=m=1;var H=null,ja=null,U=null,L=null;if(Array.isArray(c))H=c.map(I);else if(c)H=[I(c)];else for(H=Array(C),c=0;c<C;++c)H[c]=A(n,m,w,p,B);n=n||H[0].width;m=m||H[0].height;D?ja=I(D):h&&!x&&(ja=A(n,m,Y,"depth","uint32"));O?U=I(O):x&&!h&&(U=A(n,m,!1,"stencil","uint8"));J?L=I(J):!D&&!O&&x&&h&&(L=A(n,m,Y,"depth stencil","depth stencil"));h=null;for(c=0;c<H.length;++c)q(H[c],n,m),H[c]&&H[c].texture&&(x=u[H[c].texture._texture.format]*
t[H[c].texture._texture.type],null===h&&(h=x));q(ja,n,m);q(U,n,m);q(L,n,m);E(l);l.width=n;l.height=m;l.colorAttachments=H;l.depthAttachment=ja;l.stencilAttachment=U;l.depthStencilAttachment=L;f.color=H.map(k);f.depth=k(ja);f.stencil=k(U);f.depthStencil=k(L);f.width=l.width;f.height=l.height;g(l);return f}var l=new J;w.framebufferCount++;f(a,b);return c(f,{resize:function(a,b){var c=a|0,k=b|0||c;if(c===l.width&&k===l.height)return f;for(var n=l.colorAttachments,m=0;m<n.length;++m)B(n[m],c,k);B(l.depthAttachment,
c,k);B(l.stencilAttachment,c,k);B(l.depthStencilAttachment,c,k);l.width=f.width=c;l.height=f.height=k;g(l);return f},_reglType:"framebuffer",_framebuffer:l,destroy:function(){D(l);E(l)}})}var ja={cur:null,next:null,dirty:!1},Ja=["rgba"],wa=["rgba4","rgb565","rgb5 a1"];a.ext_srgb&&wa.push("srgba");a.ext_color_buffer_half_float&&wa.push("rgba16f","rgb16f");a.webgl_color_buffer_float&&wa.push("rgba32f");var Ea=["uint8"];a.oes_texture_half_float&&Ea.push("half float","float16");a.oes_texture_float&&Ea.push("float",
"float32");var Fa=0,Z={};return c(ja,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof J)?a:null},create:Y,createCube:function(a){function b(a){var k,f={color:null},l=0,n=null;k="rgba";var m="uint8",u=1;if("number"===typeof a)l=a|0;else if(a){"shape"in a?l=a.shape[0]:("radius"in a&&(l=a.radius|0),"width"in a?l=a.width|0:"height"in a&&(l=a.height|0));if("color"in a||"colors"in a)n=a.color||a.colors,Array.isArray(n);n||("colorCount"in
a&&(u=a.colorCount|0),"colorType"in a&&(m=a.colorType),"colorFormat"in a&&(k=a.colorFormat));"depth"in a&&(f.depth=a.depth);"stencil"in a&&(f.stencil=a.stencil);"depthStencil"in a&&(f.depthStencil=a.depthStencil)}else l=1;if(n)if(Array.isArray(n))for(a=[],k=0;k<n.length;++k)a[k]=n[k];else a=[n];else for(a=Array(u),n={radius:l,format:k,type:m},k=0;k<u;++k)a[k]=h.createCube(n);f.color=Array(a.length);for(k=0;k<a.length;++k)u=a[k],l=l||u.width,f.color[k]={target:34069,data:a[k]};for(k=0;6>k;++k){for(u=
0;u<a.length;++u)f.color[u].target=34069+k;0<k&&(f.depth=g[0].depth,f.stencil=g[0].stencil,f.depthStencil=g[0].depthStencil);if(g[k])g[k](f);else g[k]=Y(f)}return c(b,{width:l,height:l,color:a})}var g=Array(6);b(a);return c(b,{faces:g,resize:function(a){var c=a|0;if(c===b.width)return b;var k=b.color;for(a=0;a<k.length;++a)k[a].resize(c);for(a=0;6>a;++a)g[a].resize(c);b.width=b.height=c;return b},_reglType:"framebufferCube",destroy:function(){g.forEach(function(a){a.destroy()})}})},clear:function(){m(Z).forEach(D)},
restore:function(){m(Z).forEach(function(a){a.framebuffer=b.createFramebuffer();g(a)})}})}},{"./util/extend":23,"./util/values":32}],13:[function(h,p,q){p.exports=function(m,c){var h=1;c.ext_texture_filter_anisotropic&&(h=m.getParameter(34047));var t=1,b=1;c.webgl_draw_buffers&&(t=m.getParameter(34852),b=m.getParameter(36063));return{colorBits:[m.getParameter(3410),m.getParameter(3411),m.getParameter(3412),m.getParameter(3413)],depthBits:m.getParameter(3414),stencilBits:m.getParameter(3415),subpixelBits:m.getParameter(3408),
extensions:Object.keys(c).filter(function(a){return!!c[a]}),maxAnisotropic:h,maxDrawbuffers:t,maxColorAttachments:b,pointSizeDims:m.getParameter(33901),lineWidthDims:m.getParameter(33902),maxViewportDims:m.getParameter(3386),maxCombinedTextureUnits:m.getParameter(35661),maxCubeMapSize:m.getParameter(34076),maxRenderbufferSize:m.getParameter(34024),maxTextureUnits:m.getParameter(34930),maxTextureSize:m.getParameter(3379),maxAttributes:m.getParameter(34921),maxVertexUniforms:m.getParameter(36347),maxVertexTextureUnits:m.getParameter(35660),
maxVaryingVectors:m.getParameter(36348),maxFragmentUniforms:m.getParameter(36349),glsl:m.getParameter(35724),renderer:m.getParameter(7937),vendor:m.getParameter(7936),version:m.getParameter(7938)}}},{}],14:[function(h,p,q){var m=h("./util/is-typed-array");p.exports=function(c,h,t,b,a,f){return function(a){var f;f=null===h.next?5121:h.next.colorAttachments[0].texture._texture.type;var w=0,p=0,l=b.framebufferWidth,q=b.framebufferHeight,n=null;m(a)?n=a:a&&(w=a.x|0,p=a.y|0,l=(a.width||b.framebufferWidth-
w)|0,q=(a.height||b.framebufferHeight-p)|0,n=a.data||null);t();a=l*q*4;n||(5121===f?n=new Uint8Array(a):5126===f&&(n=n||new Float32Array(a)));c.pixelStorei(3333,4);c.readPixels(w,p,l,q,6408,f,n);return n}}},{"./util/is-typed-array":27}],15:[function(h,p,q){var m=h("./util/values"),c=[];c[32854]=2;c[32855]=2;c[36194]=2;c[33189]=2;c[36168]=1;c[34041]=4;c[35907]=4;c[34836]=16;c[34842]=8;c[34843]=6;p.exports=function(h,t,b,a,f){function x(a){this.id=l++;this.refCount=1;this.renderbuffer=a;this.format=
32854;this.height=this.width=0;f.profile&&(this.stats={size:0})}function p(b){var c=b.renderbuffer;h.bindRenderbuffer(36161,null);h.deleteRenderbuffer(c);b.renderbuffer=null;b.refCount=0;delete F[b.id];a.renderbufferCount--}var w={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(w.srgba=35907);t.ext_color_buffer_half_float&&(w.rgba16f=34842,w.rgb16f=34843);t.webgl_color_buffer_float&&(w.rgba32f=34836);var q=[];Object.keys(w).forEach(function(a){q[w[a]]=
a});var l=0,F={};x.prototype.decRef=function(){0>=--this.refCount&&p(this)};f.profile&&(a.getTotalRenderbufferSize=function(){var a=0;Object.keys(F).forEach(function(b){a+=F[b].stats.size});return a});return{create:function(b,l){function m(a,b){var l=0,n=0,g=32854;"object"===typeof a&&a?("shape"in a?(n=a.shape,l=n[0]|0,n=n[1]|0):("radius"in a&&(l=n=a.radius|0),"width"in a&&(l=a.width|0),"height"in a&&(n=a.height|0)),"format"in a&&(g=w[a.format])):"number"===typeof a?(l=a|0,n="number"===typeof b?b|
0:l):a||(l=n=1);if(l!==k.width||n!==k.height||g!==k.format)return m.width=k.width=l,m.height=k.height=n,k.format=g,h.bindRenderbuffer(36161,k.renderbuffer),h.renderbufferStorage(36161,g,l,n),f.profile&&(k.stats.size=c[k.format]*k.width*k.height),m.format=q[k.format],m}var k=new x(h.createRenderbuffer());F[k.id]=k;a.renderbufferCount++;m(b,l);m.resize=function(a,b){var l=a|0,n=b|0||l;if(l===k.width&&n===k.height)return m;m.width=k.width=l;m.height=k.height=n;h.bindRenderbuffer(36161,k.renderbuffer);
h.renderbufferStorage(36161,k.format,l,n);f.profile&&(k.stats.size=c[k.format]*k.width*k.height);return m};m._reglType="renderbuffer";m._renderbuffer=k;f.profile&&(m.stats=k.stats);m.destroy=function(){k.decRef()};return m},clear:function(){m(F).forEach(p)},restore:function(){m(F).forEach(function(a){a.renderbuffer=h.createRenderbuffer();h.bindRenderbuffer(36161,a.renderbuffer);h.renderbufferStorage(36161,a.format,a.width,a.height)});h.bindRenderbuffer(36161,null)}}}},{"./util/values":32}],16:[function(h,
p,q){var m=h("./util/values");p.exports=function(c,h,t,b){function a(a,b,c,f){this.name=a;this.id=b;this.location=c;this.info=f}function f(a,b){for(var c=0;c<a.length;++c)if(a[c].id===b.id){a[c].location=b.location;return}a.push(b)}function x(a,b,f){f=35632===a?q:l;var m=f[b];if(!m){var n=h.str(b),m=c.createShader(a);c.shaderSource(m,n);c.compileShader(m);f[b]=m}return m}function p(a,c){this.id=I++;this.fragId=a;this.vertId=c;this.program=null;this.uniforms=[];this.attributes=[];b.profile&&(this.stats=
{uniformsCount:0,attributesCount:0})}function w(l,k){var m,n;m=x(35632,l.fragId);n=x(35633,l.vertId);var t=l.program=c.createProgram();c.attachShader(t,m);c.attachShader(t,n);c.linkProgram(t);var w=c.getProgramParameter(t,35718);b.profile&&(l.stats.uniformsCount=w);var g=l.uniforms;for(m=0;m<w;++m)if(n=c.getActiveUniform(t,m))if(1<n.size)for(var p=0;p<n.size;++p){var q=n.name.replace("[0]","["+p+"]");f(g,new a(q,h.id(q),c.getUniformLocation(t,q),n))}else f(g,new a(n.name,h.id(n.name),c.getUniformLocation(t,
n.name),n));w=c.getProgramParameter(t,35721);b.profile&&(l.stats.attributesCount=w);g=l.attributes;for(m=0;m<w;++m)(n=c.getActiveAttrib(t,m))&&f(g,new a(n.name,h.id(n.name),c.getAttribLocation(t,n.name),n))}var q={},l={},F={},n=[],I=0;b.profile&&(t.getMaxUniformsCount=function(){var a=0;n.forEach(function(b){b.stats.uniformsCount>a&&(a=b.stats.uniformsCount)});return a},t.getMaxAttributesCount=function(){var a=0;n.forEach(function(b){b.stats.attributesCount>a&&(a=b.stats.attributesCount)});return a});
return{clear:function(){var a=c.deleteShader.bind(c);m(q).forEach(a);q={};m(l).forEach(a);l={};n.forEach(function(a){c.deleteProgram(a.program)});n.length=0;F={};t.shaderCount=0},program:function(a,b,c){t.shaderCount++;var f=F[b];f||(f=F[b]={});var l=f[a];l||(l=new p(b,a),w(l,c),f[a]=l,n.push(l));return l},restore:function(){q={};l={};for(var a=0;a<n.length;++a)w(n[a])},shader:x,frag:-1,vert:-1}}},{"./util/values":32}],17:[function(h,p,q){p.exports=function(){return{bufferCount:0,elementsCount:0,
framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},{}],18:[function(h,p,q){p.exports=function(){var m={"":0},c=[""];return{id:function(h){var t=m[h];if(t)return t;t=m[h]=c.length;c.push(h);return t},str:function(m){return c[m]}}}},{}],19:[function(h,p,q){function m(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function c(a){return Array.isArray(a)&&0!==a.length&&F(a[0])?!0:!1}function u(a){return Object.prototype.toString.call(a)}
function t(a){if(!a)return!1;var b=u(a);return 0<=J.indexOf(b)?!0:m(a)||c(a)||w(a)}function b(a,b){36193===a.type?(a.data=l(b),C.freeType(b)):a.data=b}function a(a,b,c,f,k,l){a="undefined"!==typeof D[a]?D[a]:B[a]*E[b];l&&(a*=6);if(k){for(f=0;1<=c;)f+=a*c*c,c/=2;return f}return a*c*f}var f=h("./util/extend"),x=h("./util/values"),O=h("./util/is-typed-array"),w=h("./util/is-ndarray"),C=h("./util/pool"),l=h("./util/to-half-float"),F=h("./util/is-array-like"),n=h("./util/flatten");q=h("./constants/arraytypes.json");
var I=h("./constants/arraytypes.json"),A=[9984,9986,9985,9987],k=[0,6409,6410,6407,6408],B={};B[6409]=B[6406]=B[6402]=1;B[34041]=B[6410]=2;B[6407]=B[35904]=3;B[6408]=B[35906]=4;var J=Object.keys(q).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),E=[];E[5121]=1;E[5126]=4;E[36193]=2;E[5123]=2;E[5125]=4;var D=[];D[32854]=2;D[32855]=2;D[36194]=2;D[34041]=4;D[33776]=.5;D[33777]=.5;D[33778]=1;D[33779]=1;D[35986]=.5;D[35987]=
1;D[34798]=1;D[35840]=.5;D[35841]=.25;D[35842]=.5;D[35843]=.25;D[36196]=.5;p.exports=function(g,h,p,q,D,E,J){function Z(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.channels=this.height=this.width=this.colorSpace=0}function H(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;
a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function U(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=na[b.colorSpace]);"type"in b&&(a.type=T[b.type]);var c=a.width,f=a.height,l=a.channels,g=!1;"shape"in b?(c=b.shape[0],f=b.shape[1],3===b.shape.length&&(l=b.shape[2],g=!0)):("radius"in b&&(c=f=b.radius),
"width"in b&&(c=b.width),"height"in b&&(f=b.height),"channels"in b&&(l=b.channels,g=!0));a.width=c|0;a.height=f|0;a.channels=l|0;c=!1;"format"in b&&(c=b.format,f=a.internalformat=X[c],a.format=Na[f],c in T&&!("type"in b)&&(a.type=T[c]),c in R&&(a.compressed=!0),c=!0);!g&&c?a.channels=B[a.format]:g&&!c&&a.channels!==k[a.format]&&(a.format=a.internalformat=k[a.channels])}}function sa(a){g.pixelStorei(37440,a.flipY);g.pixelStorei(37441,a.premultiplyAlpha);g.pixelStorei(37443,a.colorSpace);g.pixelStorei(3317,
a.unpackAlignment)}function r(){Z.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function V(a,f){var g=null;t(f)?g=f:f&&(U(a,f),"x"in f&&(a.xOffset=f.x|0),"y"in f&&(a.yOffset=f.y|0),t(f.data)&&(g=f.data));if(f.copy){var h=D.viewportWidth,r=D.viewportHeight;a.width=a.width||h-a.xOffset;a.height=a.height||r-a.yOffset;a.needsCopy=!0}else if(!g)a.width=a.width||1,a.height=a.height||1,a.channels=a.channels||4;else if(O(g))a.channels=a.channels||
4,a.data=g,"type"in f||5121!==a.type||(a.type=I[Object.prototype.toString.call(g)]|0);else if(m(g)){a.channels=a.channels||4;h=g;r=h.length;switch(a.type){case 5121:case 5123:case 5125:case 5126:r=C.allocType(a.type,r);r.set(h);a.data=r;break;case 36193:a.data=l(h)}a.alignment=1;a.needsFree=!0}else if(w(g)){h=g.data;Array.isArray(h)||5121!==a.type||(a.type=I[Object.prototype.toString.call(h)]|0);var r=g.shape,x=g.stride,p,q,d,z;3===r.length?(d=r[2],z=x[2]):z=d=1;p=r[0];q=r[1];r=x[0];x=x[1];a.alignment=
1;a.width=p;a.height=q;a.channels=d;a.format=a.internalformat=k[d];a.needsFree=!0;p=z;g=g.offset;d=a.width;z=a.height;q=a.channels;for(var A=C.allocType(36193===a.type?5126:a.type,d*z*q),E=0,B=0;B<z;++B)for(var ra=0;ra<d;++ra)for(var Q=0;Q<q;++Q)A[E++]=h[r*ra+x*B+p*Q+g];b(a,A)}else if("[object HTMLCanvasElement]"===u(g)||"[object CanvasRenderingContext2D]"===u(g))"[object HTMLCanvasElement]"===u(g)?a.element=g:a.element=g.canvas,a.width=a.element.width,a.height=a.element.height,a.channels=4;else if("[object HTMLImageElement]"===
u(g))a.element=g,a.width=g.naturalWidth,a.height=g.naturalHeight,a.channels=4;else if("[object HTMLVideoElement]"===u(g))a.element=g,a.width=g.videoWidth,a.height=g.videoHeight,a.channels=4;else if(c(g)){h=a.width||g[0].length;r=a.height||g.length;x=a.channels;x=F(g[0][0])?x||g[0][0].length:x||1;p=n.shape(g);d=1;for(z=0;z<p.length;++z)d*=p[z];d=C.allocType(36193===a.type?5126:a.type,d);n.flatten(g,p,"",d);b(a,d);a.alignment=1;a.width=h;a.height=r;a.channels=x;a.format=a.internalformat=k[x];a.needsFree=
!0}}function ka(a,b,c,f,l){var k=a.element,m=a.data,h=a.internalformat,d=a.format,n=a.type,r=a.width,t=a.height;sa(a);k?g.texSubImage2D(b,l,c,f,d,n,k):a.compressed?g.compressedTexSubImage2D(b,l,c,f,h,r,t,m):a.needsCopy?(q(),g.copyTexSubImage2D(b,l,c,f,a.xOffset,a.yOffset,r,t)):g.texSubImage2D(b,l,c,f,r,t,d,n,m)}function da(){return Ma.pop()||new r}function W(a){a.needsFree&&C.freeType(a.data);r.call(a);Ma.push(a)}function P(){Z.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=
Array(16)}function G(a,b,c){var f=a.images[0]=da();a.mipmask=1;f.width=a.width=b;f.height=a.height=c;f.channels=a.channels=4}function aa(a,b){var c=null;if(t(b))c=a.images[0]=da(),H(c,a),V(c,b),a.mipmask=1;else if(U(a,b),Array.isArray(b.mipmap))for(var f=b.mipmap,g=0;g<f.length;++g)c=a.images[g]=da(),H(c,a),c.width>>=g,c.height>>=g,V(c,f[g]),a.mipmask|=1<<g;else c=a.images[0]=da(),H(c,a),V(c,b),a.mipmask=1;H(a,a.images[0])}function la(a,b){for(var c=a.images,f=0;f<c.length&&c[f];++f){var l=c[f],k=
b,m=f,h=l.element,d=l.data,n=l.internalformat,r=l.format,t=l.type,x=l.width,u=l.height;sa(l);h?g.texImage2D(k,m,r,r,t,h):l.compressed?g.compressedTexImage2D(k,m,n,x,u,0,d):l.needsCopy?(q(),g.copyTexImage2D(k,m,r,l.xOffset,l.yOffset,x,u,0)):g.texImage2D(k,m,r,x,u,0,r,t,d)}}function va(){var a=Ia.pop()||new P;Z.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function S(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&W(b[c]),b[c]=null;Ia.push(a)}function fa(){this.magFilter=this.minFilter=
9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function ha(a,b){"min"in b&&(a.minFilter=N[b.min],0<=A.indexOf(a.minFilter)&&(a.genMipmaps=!0));"mag"in b&&(a.magFilter=ea[b.mag]);var c=a.wrapS,f=a.wrapT;if("wrap"in b){var g=b.wrap;"string"===typeof g?c=f=L[g]:Array.isArray(g)&&(c=L[g[0]],f=L[g[1]])}else"wrapS"in b&&(c=L[b.wrapS]),"wrapT"in b&&(f=L[b.wrapT]);a.wrapS=c;a.wrapT=f;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=
ca[b.mipmap];c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=9984)}}function oa(a,b){g.texParameteri(b,10241,a.minFilter);g.texParameteri(b,10240,a.magFilter);g.texParameteri(b,10242,a.wrapS);g.texParameteri(b,10243,a.wrapT);h.ext_texture_filter_anisotropic&&g.texParameteri(b,34046,a.anisotropic);a.genMipmaps&&(g.hint(33170,a.mipmapHint),g.generateMipmap(b))}function pa(a){Z.call(this);this.mipmask=0;this.internalformat=
6408;this.id=ya++;this.refCount=1;this.target=a;this.texture=g.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new fa;J.profile&&(this.stats={size:0})}function ba(a){g.activeTexture(33984);g.bindTexture(a.target,a.texture)}function ga(){var a=ma[0];a?g.bindTexture(a.target,a.texture):g.bindTexture(3553,null)}function ia(a){var b=a.texture,c=a.unit,f=a.target;0<=c&&(g.activeTexture(33984+c),g.bindTexture(f,null),ma[c]=null);g.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=
0;delete Q[a.id];E.textureCount--}var ca={"don't care":4352,"dont care":4352,nice:4354,fast:4353},L={repeat:10497,clamp:33071,mirror:33648},ea={nearest:9728,linear:9729},N=f({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},ea),na={none:0,browser:37444},T={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},X={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},
R={};h.ext_srgb&&(X.srgb=35904,X.srgba=35906);h.oes_texture_float&&(T.float32=T["float"]=5126);h.oes_texture_half_float&&(T.float16=T["half float"]=36193);h.webgl_depth_texture&&(f(X,{depth:6402,"depth stencil":34041}),f(T,{uint16:5123,uint32:5125,"depth stencil":34042}));h.webgl_compressed_texture_s3tc&&f(R,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});h.webgl_compressed_texture_atc&&f(R,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});
h.webgl_compressed_texture_pvrtc&&f(R,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});h.webgl_compressed_texture_etc1&&(R["rgb etc1"]=36196);var ra=Array.prototype.slice.call(g.getParameter(34467));Object.keys(R).forEach(function(a){var b=R[a];0<=ra.indexOf(b)&&(X[a]=b)});var Ca=Object.keys(X);p.textureFormats=Ca;var Da=[];Object.keys(X).forEach(function(a){Da[X[a]]=a});var Ga=[];Object.keys(T).forEach(function(a){Ga[T[a]]=a});var Ha=[];Object.keys(ea).forEach(function(a){Ha[ea[a]]=
a});var za=[];Object.keys(N).forEach(function(a){za[N[a]]=a});var Aa=[];Object.keys(L).forEach(function(a){Aa[L[a]]=a});var Na=Ca.reduce(function(a,b){var c=X[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),Ma=[],Ia=[],ya=0,Q={},qa=p.maxTextureUnits,ma=Array(qa).map(function(){return null});f(pa.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<qa;++b){var c=ma[b];if(c){if(0<c.bindCount)continue;
c.unit=-1}ma[b]=this;a=b;break}J.profile&&E.maxTextureUnits<a+1&&(E.maxTextureUnits=a+1);this.unit=a;g.activeTexture(33984+a);g.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&ia(this)}});J.profile&&(E.getTotalTextureSize=function(){var a=0;Object.keys(Q).forEach(function(b){a+=Q[b].stats.size});return a});return{create2D:function(b,c){function f(b,c){var e=l.texInfo;fa.call(e);var g=va();"number"===typeof b?"number"===typeof c?
G(g,b|0,c|0):G(g,b|0,b|0):b?(ha(e,b),aa(g,b)):G(g,1,1);e.genMipmaps&&(g.mipmask=(g.width<<1)-1);l.mipmask=g.mipmask;H(l,g);l.internalformat=g.internalformat;f.width=g.width;f.height=g.height;ba(l);la(g,3553);oa(e,3553);ga();S(g);J.profile&&(l.stats.size=a(l.internalformat,l.type,g.width,g.height,e.genMipmaps,!1));f.format=Da[l.internalformat];f.type=Ga[l.type];f.mag=Ha[e.magFilter];f.min=za[e.minFilter];f.wrapS=Aa[e.wrapS];f.wrapT=Aa[e.wrapT];return f}var l=new pa(3553);Q[l.id]=l;E.textureCount++;
f(b,c);f.subimage=function(a,b,c,e){b|=0;c|=0;e|=0;var d=da();H(d,l);d.width=0;d.height=0;V(d,a);d.width=d.width||(l.width>>e)-b;d.height=d.height||(l.height>>e)-c;ba(l);ka(d,3553,b,c,e);ga();W(d);return f};f.resize=function(b,c){var e=b|0,k=c|0||e;if(e===l.width&&k===l.height)return f;f.width=l.width=e;f.height=l.height=k;ba(l);for(var d=0;l.mipmask>>d;++d)g.texImage2D(3553,d,l.format,e>>d,k>>d,0,l.format,l.type,null);ga();J.profile&&(l.stats.size=a(l.internalformat,l.type,e,k,!1,!1));return f};
f._reglType="texture2d";f._texture=l;J.profile&&(f.stats=l.stats);f.destroy=function(){l.decRef()};return f},createCube:function(b,c,f,l,k,m){function h(b,c,e,f,g,l){var k,m=n.texInfo;fa.call(m);for(k=0;6>k;++k)d[k]=va();if("number"===typeof b||!b)for(b=b|0||1,k=0;6>k;++k)G(d[k],b,b);else if("object"===typeof b)if(c)aa(d[0],b),aa(d[1],c),aa(d[2],e),aa(d[3],f),aa(d[4],g),aa(d[5],l);else if(ha(m,b),U(n,b),"faces"in b)for(b=b.faces,k=0;6>k;++k)H(d[k],n),aa(d[k],b[k]);else for(k=0;6>k;++k)aa(d[k],b);
H(n,d[0]);n.mipmask=m.genMipmaps?(d[0].width<<1)-1:d[0].mipmask;n.internalformat=d[0].internalformat;h.width=d[0].width;h.height=d[0].height;ba(n);for(k=0;6>k;++k)la(d[k],34069+k);oa(m,34067);ga();J.profile&&(n.stats.size=a(n.internalformat,n.type,h.width,h.height,m.genMipmaps,!0));h.format=Da[n.internalformat];h.type=Ga[n.type];h.mag=Ha[m.magFilter];h.min=za[m.minFilter];h.wrapS=Aa[m.wrapS];h.wrapT=Aa[m.wrapT];for(k=0;6>k;++k)S(d[k]);return h}var n=new pa(34067);Q[n.id]=n;E.cubeCount++;var d=Array(6);
h(b,c,f,l,k,m);h.subimage=function(a,b,c,d,e){c|=0;d|=0;e|=0;var f=da();H(f,n);f.width=0;f.height=0;V(f,b);f.width=f.width||(n.width>>e)-c;f.height=f.height||(n.height>>e)-d;ba(n);ka(f,34069+a,c,d,e);ga();W(f);return h};h.resize=function(b){b|=0;if(b!==n.width){h.width=n.width=b;h.height=n.height=b;ba(n);for(var c=0;6>c;++c)for(var d=0;n.mipmask>>d;++d)g.texImage2D(34069+c,d,n.format,b>>d,b>>d,0,n.format,n.type,null);ga();J.profile&&(n.stats.size=a(n.internalformat,n.type,h.width,h.height,!1,!0));
return h}};h._reglType="textureCube";h._texture=n;J.profile&&(h.stats=n.stats);h.destroy=function(){n.decRef()};return h},clear:function(){for(var a=0;a<qa;++a)g.activeTexture(33984+a),g.bindTexture(3553,null),ma[a]=null;x(Q).forEach(ia);E.cubeCount=0;E.textureCount=0},getTexture:function(a){return null},restore:function(){x(Q).forEach(function(a){a.texture=g.createTexture();g.bindTexture(a.target,a.texture);for(var b=0;32>b;++b)if(0!==(a.mipmask&1<<b))if(3553===a.target)g.texImage2D(3553,b,a.internalformat,
a.width>>b,a.height>>b,0,a.internalformat,a.type,null);else for(var c=0;6>c;++c)g.texImage2D(34069+c,b,a.internalformat,a.width>>b,a.height>>b,0,a.internalformat,a.type,null);oa(a.texInfo,a.target)})}}}},{"./constants/arraytypes.json":4,"./util/extend":23,"./util/flatten":24,"./util/is-array-like":25,"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/pool":29,"./util/to-half-float":31,"./util/values":32}],20:[function(h,p,q){p.exports=function(h,c){function u(){this.endQueryIndex=this.startQueryIndex=
-1;this.sum=0;this.stats=null}function t(a,b,c){var f=x.pop()||new u;f.startQueryIndex=a;f.endQueryIndex=b;f.sum=0;f.stats=c;p.push(f)}var b=c.ext_disjoint_timer_query;if(!b)return null;var a=[],f=[],x=[],p=[],w=[],q=[];return{beginQuery:function(c){var h=a.pop()||b.createQueryEXT();b.beginQueryEXT(35007,h);f.push(h);t(f.length-1,f.length,c)},endQuery:function(){b.endQueryEXT(35007)},pushScopeStats:t,update:function(){var c,h;c=f.length;if(0!==c){q.length=Math.max(q.length,c+1);w.length=Math.max(w.length,
c+1);w[0]=0;var n=q[0]=0;for(h=c=0;h<f.length;++h){var m=f[h];b.getQueryObjectEXT(m,34919)?(n+=b.getQueryObjectEXT(m,34918),a.push(m)):f[c++]=m;w[h+1]=n;q[h+1]=c}f.length=c;for(h=c=0;h<p.length;++h){var n=p[h],t=n.startQueryIndex,m=n.endQueryIndex;n.sum+=w[m]-w[t];t=q[t];m=q[m];m===t?(n.stats.gpuTime+=n.sum/1E6,x.push(n)):(n.startQueryIndex=t,n.endQueryIndex=m,p[c++]=n)}p.length=c}},getNumPendingQueries:function(){return f.length},clear:function(){a.push.apply(a,f);for(var c=0;c<a.length;c++)b.deleteQueryEXT(a[c]);
f.length=0;a.length=0},restore:function(){f.length=0;a.length=0}}}},{}],21:[function(h,p,q){p.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(h,p,q){function m(c){return Array.prototype.slice.call(c)}function c(c){return m(c).join("")}var u=h("./extend");p.exports=function(){function h(){var b=[],f=[];return u(function(){b.push.apply(b,m(arguments))},{def:function(){var c="v"+a++;f.push(c);0<arguments.length&&
(b.push(c,"="),b.push.apply(b,m(arguments)),b.push(";"));return c},toString:function(){return c([0<f.length?"var "+f+";":"",c(b)])}})}function b(){function a(f,k){c(f,k,"=",b.def(f,k),";")}var b=h(),c=h(),f=b.toString,p=c.toString;return u(function(){b.apply(b,m(arguments))},{def:b.def,entry:b,exit:c,save:a,set:function(c,f,h){a(c,f);b(c,f,"=",h,";")},toString:function(){return f()+p()}})}var a=0,f=[],x=[],p=h(),q={};return{global:p,link:function(b){for(var c=0;c<x.length;++c)if(x[c]===b)return f[c];
c="g"+a++;f.push(c);x.push(b);return c},block:h,proc:function(a,f){function h(){var a="a"+m.length;m.push(a);return a}var m=[];f=f||0;for(var t=0;t<f;++t)h();var t=b(),p=t.toString;return q[a]=u(t,{arg:h,toString:function(){return c(["function(",m.join(),"){",p(),"}"])}})},scope:b,cond:function(){var a=c(arguments),f=b(),h=b(),n=f.toString,t=h.toString;return u(f,{then:function(){f.apply(f,m(arguments));return this},"else":function(){h.apply(h,m(arguments));return this},toString:function(){var b=
t();b&&(b="else{"+b+"}");return c(["if(",a,"){",n(),"}",b])}})},compile:function(){var a=['"use strict";',p,"return {"];Object.keys(q).forEach(function(b){a.push('"',b,'":',q[b].toString(),",")});a.push("}");var b=c(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,f.concat(b)).apply(null,x)}}}},{"./extend":23}],23:[function(h,p,q){p.exports=function(h,c){for(var p=Object.keys(c),t=0;t<p.length;++t)h[p[t]]=c[p[t]];return h}},{}],24:[function(h,p,q){function m(c,
b,a,f,h,m){for(var p=0;p<b;++p)for(var q=c[p],l=0;l<a;++l)for(var u=q[l],n=0;n<f;++n)h[m++]=u[n]}function c(h,b,a,f,p){for(var q=1,u=a+1;u<b.length;++u)q*=b[u];var C=b[a];if(4===b.length-a){var l=b[a+1],F=b[a+2];b=b[a+3];for(u=0;u<C;++u)m(h[u],l,F,b,f,p),p+=q}else for(u=0;u<C;++u)c(h[u],b,a+1,f,p),p+=q}var u=h("./pool");p.exports={shape:function(c){for(var b=[];c.length;c=c[0])b.push(c.length);return b},flatten:function(h,b,a,f){var p=1;if(b.length)for(var q=0;q<b.length;++q)p*=b[q];else p=0;a=f||
u.allocType(a,p);switch(b.length){case 0:break;case 1:f=b[0];for(b=0;b<f;++b)a[b]=h[b];break;case 2:f=b[0];b=b[1];for(q=p=0;q<f;++q)for(var w=h[q],C=0;C<b;++C)a[p++]=w[C];break;case 3:m(h,b[0],b[1],b[2],a,0);break;default:c(h,b,0,a,0)}return a}}},{"./pool":29}],25:[function(h,p,q){var m=h("./is-typed-array");p.exports=function(c){return Array.isArray(c)||m(c)}},{"./is-typed-array":27}],26:[function(h,p,q){var m=h("./is-typed-array");p.exports=function(c){return!!c&&"object"===typeof c&&Array.isArray(c.shape)&&
Array.isArray(c.stride)&&"number"===typeof c.offset&&c.shape.length===c.stride.length&&(Array.isArray(c.data)||m(c.data))}},{"./is-typed-array":27}],27:[function(h,p,q){var m=h("../constants/arraytypes.json");p.exports=function(c){return Object.prototype.toString.call(c)in m}},{"../constants/arraytypes.json":4}],28:[function(h,p,q){p.exports=function(h,c){for(var p=Array(h),q=0;q<h;++q)p[q]=c(q);return p}},{}],29:[function(h,p,q){function m(b){var a,c;a=(65535<b)<<4;b>>>=a;c=(255<b)<<3;b>>>=c;a|=
c;c=(15<b)<<2;b>>>=c;a|=c;c=(3<b)<<1;return a|c|b>>>c>>1}function c(b){a:{for(var a=16;268435456>=a;a*=16)if(b<=a){b=a;break a}b=0}a=t[m(b)>>2];return 0<a.length?a.pop():new ArrayBuffer(b)}function u(b){t[m(b.byteLength)>>2].push(b)}var t=h("./loop")(8,function(){return[]});p.exports={alloc:c,free:u,allocType:function(b,a){var f=null;switch(b){case 5120:f=new Int8Array(c(a),0,a);break;case 5121:f=new Uint8Array(c(a),0,a);break;case 5122:f=new Int16Array(c(2*a),0,a);break;case 5123:f=new Uint16Array(c(2*
a),0,a);break;case 5124:f=new Int32Array(c(4*a),0,a);break;case 5125:f=new Uint32Array(c(4*a),0,a);break;case 5126:f=new Float32Array(c(4*a),0,a);break;default:return null}return f.length!==a?f.subarray(0,a):f},freeType:function(b){u(b.buffer)}}},{"./loop":28}],30:[function(h,p,q){p.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(h){return requestAnimationFrame(h)},cancel:function(h){return cancelAnimationFrame(h)}}:{next:function(h){return setTimeout(h,
16)},cancel:clearTimeout}},{}],31:[function(h,p,q){var m=h("./pool"),c=new Float32Array(1),u=new Uint32Array(c.buffer);p.exports=function(h){for(var b=m.allocType(5123,h.length),a=0;a<h.length;++a)if(isNaN(h[a]))b[a]=65535;else if(Infinity===h[a])b[a]=31744;else if(-Infinity===h[a])b[a]=64512;else{c[0]=h[a];var f=u[0],p=f>>>31<<15,q=(f<<1>>>24)-127,f=f>>13&1023;b[a]=-24>q?p:-14>q?p+(f+1024>>-14-q):15<q?p+31744:p+(q+15<<10)+f}return b}},{"./pool":29}],32:[function(h,p,q){p.exports=function(h){return Object.keys(h).map(function(c){return h[c]})}},
{}],33:[function(h,p,q){function m(a,c,h){function m(){var c=window.innerWidth,f=window.innerHeight;a!==document.body&&(f=a.getBoundingClientRect(),c=f.right-f.left,f=f.top-f.bottom);p.width=h*c;p.height=h*f;b(p.style,{width:c+"px",height:f+"px"})}var p=document.createElement("canvas");b(p.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(p);a===document.body&&(p.style.position="absolute",b(a.style,{margin:0,padding:0}));window.addEventListener("resize",m,!1);m();return{canvas:p,onDestroy:function(){window.removeEventListener("resize",
m);a.removeChild(p)}}}function c(a,b){function c(h){try{return a.getContext(h,b)}catch(m){return null}}return c("webgl")||c("experimental-webgl")||c("webgl-experimental")}function u(a){return"string"===typeof a?a.split():a}function t(a){return"string"===typeof a?document.querySelector(a):a}var b=h("./util/extend");p.exports=function(a){var b=a||{},h,p,q,C;a={};var l=[],F=[],n="undefined"===typeof window?1:window.devicePixelRatio,I=!1,A=function(a){},k=function(){};"string"===typeof b?h=document.querySelector(b):
"object"===typeof b&&("string"===typeof b.nodeName&&"function"===typeof b.appendChild&&"function"===typeof b.getBoundingClientRect?h=b:"function"===typeof b.drawArrays||"function"===typeof b.drawElements?(C=b,q=C.canvas):("gl"in b?C=b.gl:"canvas"in b?q=t(b.canvas):"container"in b&&(p=t(b.container)),"attributes"in b&&(a=b.attributes),"extensions"in b&&(l=u(b.extensions)),"optionalExtensions"in b&&(F=u(b.optionalExtensions)),"onDone"in b&&(A=b.onDone),"profile"in b&&(I=!!b.profile),"pixelRatio"in b&&
(n=+b.pixelRatio)));h&&("canvas"===h.nodeName.toLowerCase()?q=h:p=h);if(!C){if(!q){h=m(p||document.body,A,n);if(!h)return null;q=h.canvas;k=h.onDestroy}C=c(q,a)}return C?{gl:C,canvas:q,container:p,extensions:l,optionalExtensions:F,pixelRatio:n,profile:I,onDone:A,onDestroy:k}:(k(),A("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/extend":23}],34:[function(h,p,q){p.exports=function(c,h){function p(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==
k.alt,k.alt=!!a.altKey);"shiftKey"in a&&(b=b||a.shiftKey!==k.shift,k.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==k.control,k.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==k.meta,k.meta=!!a.metaKey);return b}function b(a,b){var c=m.x(b),f=m.y(b);"buttons"in b&&(a=b.buttons|0);if(a!==n||c!==I||f!==A||p(b))n=a|0,I=c||0,A=f||0,h&&h(n,I,A,k)}function a(a){b(0,a)}function f(){if(n||I||A||k.shift||k.alt||k.meta||k.control)n=I=A=0,k.shift=k.alt=k.control=k.meta=!1,h&&h(0,0,0,k)}function q(a){p(a)&&
h&&h(n,I,A,k)}function O(a){0===m.buttons(a)?b(0,a):b(n,a)}function w(a){b(n|m.buttons(a),a)}function C(a){b(n&~m.buttons(a),a)}function l(){B||(B=!0,c.addEventListener("mousemove",O),c.addEventListener("mousedown",w),c.addEventListener("mouseup",C),c.addEventListener("mouseleave",a),c.addEventListener("mouseenter",a),c.addEventListener("mouseout",a),c.addEventListener("mouseover",a),c.addEventListener("blur",f),c.addEventListener("keyup",q),c.addEventListener("keydown",q),c.addEventListener("keypress",
q),c!==window&&(window.addEventListener("blur",f),window.addEventListener("keyup",q),window.addEventListener("keydown",q),window.addEventListener("keypress",q)))}function F(){B&&(B=!1,c.removeEventListener("mousemove",O),c.removeEventListener("mousedown",w),c.removeEventListener("mouseup",C),c.removeEventListener("mouseleave",a),c.removeEventListener("mouseenter",a),c.removeEventListener("mouseout",a),c.removeEventListener("mouseover",a),c.removeEventListener("blur",f),c.removeEventListener("keyup",
q),c.removeEventListener("keydown",q),c.removeEventListener("keypress",q),c!==window&&(window.removeEventListener("blur",f),window.removeEventListener("keyup",q),window.removeEventListener("keydown",q),window.removeEventListener("keypress",q)))}h||(h=c,c=window);var n=0,I=0,A=0,k={shift:!1,alt:!1,control:!1,meta:!1},B=!1;l();var J={element:c};Object.defineProperties(J,{enabled:{get:function(){return B},set:function(a){a?l():F},enumerable:!0},buttons:{get:function(){return n},enumerable:!0},x:{get:function(){return I},
enumerable:!0},y:{get:function(){return A},enumerable:!0},mods:{get:function(){return k},enumerable:!0}});return J};var m=h("mouse-event")},{"mouse-event":35}],35:[function(h,p,q){function m(c){return c.target||c.srcElement||window}q.buttons=function(c){if("object"===typeof c){if("buttons"in c)return c.buttons;if("which"in c){c=c.which;if(2===c)return 4;if(3===c)return 2;if(0<c)return 1<<c-1}else if("button"in c){c=c.button;if(1===c)return 4;if(2===c)return 2;if(0<=c)return 1<<c}}return 0};q.element=
m;q.x=function(c){if("object"===typeof c){if("offsetX"in c)return c.offsetX;var h=m(c).getBoundingClientRect();return c.clientX-h.left}return 0};q.y=function(c){if("object"===typeof c){if("offsetY"in c)return c.offsetY;var h=m(c).getBoundingClientRect();return c.clientY-h.top}return 0}},{}],36:[function(h,p,q){function m(a,b){for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}var c=h("./lib/util/extend"),u=h("./lib/dynamic"),t=h("./lib/util/raf"),b=h("./lib/util/clock"),a=h("./lib/strings"),
f=h("./lib/webgl"),x=h("./lib/extension"),O=h("./lib/limits"),w=h("./lib/buffer"),C=h("./lib/elements"),l=h("./lib/texture"),F=h("./lib/renderbuffer"),n=h("./lib/framebuffer"),I=h("./lib/attribute"),A=h("./lib/shader"),k=h("./lib/read"),B=h("./lib/core"),J=h("./lib/stats"),E=h("./lib/timer");p.exports=function(h){function g(){if(0===N.length)G&&G.update(),R=null;else{R=t.next(g);H();for(var a=N.length-1;0<=a;--a){var b=N[a];b&&b(S,null,0)}r.flush();G&&G.update()}}function p(){!R&&0<N.length&&(R=t.next(g))}
function q(){R&&(t.cancel(g),R=null)}function Ja(a){a.preventDefault();q();na.forEach(function(a){a()})}function wa(a){r.getError();ka.restore();pa.restore();ha.restore();ba.restore();ga.restore();ia.restore();G&&G.restore();ca.procs.refresh();p();T.forEach(function(a){a()})}function Ea(a){function b(a){var c={},f={};Object.keys(a).forEach(function(b){var g=a[b];u.isDynamic(g)?f[b]=u.unbox(g,b):c[b]=g});return{dynamic:f,"static":c}}function f(a){for(;q.length<a;)q.push(null);return q}var g=b(a.context||
{}),h=b(a.uniforms||{}),k=b(a.attributes||{}),l=b(function(a){function b(a){if(a in f){var c=f[a];delete f[a];Object.keys(c).forEach(function(b){f[a+"."+b]=c[b]})}}var f=c({},a);delete f.uniforms;delete f.attributes;delete f.context;"stencil"in f&&f.stencil.op&&(f.stencil.opBack=f.stencil.opFront=f.stencil.op,delete f.stencil.op);b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return f}(a));a={gpuTime:0,cpuTime:0,count:0};var g=ca.compile(l,k,h,g,a),m=g.draw,
n=g.batch,p=g.scope,q=[];return c(function(a,b){var c;if("function"===typeof a)return p.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)p.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)p.call(this,a[c],b,c);else return p.call(this,a,b,0);else if("number"===typeof a){if(0<a)return n.call(this,f(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return n.call(this,a,a.length)}else return m.call(this,a)},{stats:a})}function Fa(a){N.push(a);p();return{cancel:function(){function b(){var a=
m(N,b);N[a]=N[N.length-1];--N.length;0>=N.length&&q()}var c=m(N,a);N[c]=b}}}function Z(){var a=L.viewport,b=L.scissor_box;a[0]=a[1]=b[0]=b[1]=0;S.viewportWidth=S.framebufferWidth=S.drawingBufferWidth=a[2]=b[2]=r.drawingBufferWidth;S.viewportHeight=S.framebufferHeight=S.drawingBufferHeight=a[3]=b[3]=r.drawingBufferHeight}function H(){S.tick+=1;S.time=sa();Z();ca.procs.poll()}function U(){Z();ca.procs.refresh();G&&G.update()}function sa(){return(b()-aa)/1E3}h=f(h);if(!h)return null;var r=h.gl,V=r.getContextAttributes();
r.isContextLost();var ka=x(r,h);if(!ka)return null;var da=a(),W=J(),P=ka.extensions,G=E(r,P),aa=b(),la=r.drawingBufferWidth,va=r.drawingBufferHeight,S={tick:0,time:0,viewportWidth:la,viewportHeight:va,framebufferWidth:la,framebufferHeight:va,drawingBufferWidth:la,drawingBufferHeight:va,pixelRatio:h.pixelRatio},fa=O(r,P),ha=w(r,W,h),oa=C(r,P,ha,W),la=I(r,P,fa,ha,da),pa=A(r,da,W,h),ba=l(r,P,fa,function(){ca.procs.poll()},S,W,h),ga=F(r,P,fa,W,h),ia=n(r,P,fa,ba,ga,W),ca=B(r,da,P,fa,ha,oa,ba,ia,{},la,
pa,{elements:null,primitive:4,count:-1,offset:0,instances:-1},S,G,h),da=k(r,ia,ca.procs.poll,S,V,P),L=ca.next,ea=r.canvas,N=[],na=[],T=[],X=[h.onDestroy],R=null;ea&&(ea.addEventListener("webglcontextlost",Ja,!1),ea.addEventListener("webglcontextrestored",wa,!1));U();V=c(Ea,{clear:function(a){var b=0;ca.procs.poll();var c=a.color;c&&(r.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(r.clearDepth(+a.depth),b|=256);"stencil"in a&&(r.clearStencil(a.stencil|0),b|=1024);r.clear(b)},
prop:u.define.bind(null,1),context:u.define.bind(null,2),"this":u.define.bind(null,3),draw:Ea({}),buffer:function(a){return ha.create(a,34962,!1,!1)},elements:function(a){return oa.create(a,!1)},texture:ba.create2D,cube:ba.createCube,renderbuffer:ga.create,framebuffer:ia.create,framebufferCube:ia.createCube,attributes:V,frame:Fa,on:function(a,b){var c;switch(a){case "frame":return Fa(b);case "lost":c=na;break;case "restore":c=T;break;case "destroy":c=X}c.push(b);return{cancel:function(){for(var a=
0;a<c.length;++a)if(c[a]===b){c[a]=c[c.length-1];c.pop();break}}}},limits:fa,hasExtension:function(a){return 0<=fa.extensions.indexOf(a.toLowerCase())},read:da,destroy:function(){N.length=0;q();ea&&(ea.removeEventListener("webglcontextlost",Ja),ea.removeEventListener("webglcontextrestored",wa));pa.clear();ia.clear();ga.clear();ba.clear();oa.clear();ha.clear();G&&G.clear();X.forEach(function(a){a()})},_gl:r,_refresh:U,poll:function(){H();G&&G.update()},now:sa,stats:W});h.onDone(null,V);return V}},
{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":30,"./lib/webgl":33}]},{},[1]);

        </script>
        </body>
      </html>