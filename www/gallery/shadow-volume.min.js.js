(function e$$0(p,t,e){function c(b,d){if(!t[b]){if(!p[b]){var g="function"==typeof require&&require;if(!d&&g)return g(b,!0);if(a)return a(b,!0);g=Error("Cannot find module '"+b+"'");throw g.code="MODULE_NOT_FOUND",g;}g=t[b]={exports:{}};p[b][0].call(g.exports,function(a){var d=p[b][1][a];return c(d?d:a)},g,g.exports,e$$0,p,t,e)}return t[b].exports}for(var a="function"==typeof require&&require,b=0;b<e.length;b++)c(e[b]);return c})({1:[function(h,p,t){t=document.createElement("canvas");p=document.body.appendChild(t);
t=t.getContext("webgl",{antialias:!0,stencil:!0});var e=h("canvas-fit"),c=h("gl-mat4"),a=h("../regl")({gl:t}),b=h("canvas-orbit-camera")(p);window.addEventListener("resize",e(p),!1);b.rotate([0,0],[0,-.4]);b.zoom(-28);var f=[.7,.3,.3],d=[.3,.2,.3],g=[.7,.7,.7],m=[.3,.3,.3];h("resl")({manifest:{DATA:{type:"text",src:"assets/shadow_bunny.json",parser:JSON.parse}},onDone:function(e){var l=e.DATA;e=a.buffer(l.MESH);var n=a.buffer(l.SHADOW),r=a({uniforms:{lightDir:function(){return[-.39,-.87,-.29]},camera:function(a){var f=
1/Math.tan(Math.PI/2/2),d=[];d[0]=f/(a.viewportWidth/a.viewportHeight);d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=f;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=0;d[11]=-1;d[12]=0;d[13]=0;d[14]=-.01;d[15]=0;a=b.view();return c.multiply([],d,a)}}}),q=a({depth:{enable:!0,mask:!0,func:"<="},stencil:{enable:!1},colorMask:[!0,!0,!0,!0],cull:{enable:!0,face:"back"}}),h=a({depth:{mask:!1,enable:!0,func:"<"},stencil:{enable:!0,mask:255,func:{cmp:"always",ref:0,mask:255},opBack:{fail:"keep",zfail:"increment wrap",zpass:"keep"},
opFront:{fail:"keep",zfail:"decrement wrap",zpass:"keep"}},cull:{enable:!1},colorMask:[!1,!1,!1,!1]}),H=a({depth:{mask:!1,enable:!0,func:"<="},stencil:{enable:!0,mask:255,func:{cmp:"!=",ref:0,mask:255},op:{fail:"keep",zfail:"keep",pass:"keep"}},colorMask:[!0,!0,!0,!0],cull:{enable:!0,face:"back"}}),u=[],w=[],x=[];w.push([-10,0,-10]);w.push([10,0,-10]);w.push([-10,0,10]);w.push([10,0,10]);x.push([0,1,0]);x.push([0,1,0]);x.push([0,1,0]);x.push([0,1,0]);u.push([3,1,0]);u.push([0,2,3]);var p=a({vert:"\n    precision mediump float;\n    attribute vec3 position;\n    attribute vec3 normal;\n\n    uniform vec3 lightDir;\n    uniform mat4 camera;\n    uniform mat4 model;\n\n    varying float intensity;\n\n    void main() {\n      intensity = max(-dot(lightDir, normal), 0.0);\n      gl_Position = camera * model * vec4(position, 1);\n    }\n    ",
frag:"\n    precision mediump float;\n\n    uniform vec3 diffuse;\n    uniform vec3 ambient;\n\n    varying float intensity;\n\n    void main() {\n      gl_FragColor = vec4(diffuse * intensity + ambient, 1);\n    }\n    ",uniforms:{ambient:function(){return m},diffuse:function(a,b){var f=b.intensity;return[f*g[0],f*g[1],f*g[2]]},model:a.prop("model")},attributes:{position:w,normal:x},elements:u,cull:{enable:!0}}),A=a({vert:"\n    precision mediump float;\n    attribute vec3 position;\n    attribute vec3 normal;\n\n    uniform vec3 lightDir;\n    uniform mat4 camera;\n    uniform mat4 model;\n\n    varying float intensity;\n\n    void main() {\n      intensity = max(-dot(lightDir, normal), 0.0);\n      gl_Position = camera * model * vec4(position, 1);\n    }\n    ",
frag:"\n    precision mediump float;\n\n    uniform vec3 diffuse;\n    uniform vec3 ambient;\n\n    varying float intensity;\n\n    void main() {\n      gl_FragColor = vec4(diffuse * intensity + ambient, 1);\n    }\n    ",attributes:{position:{buffer:e,offset:0,normalized:!1,stride:24,size:3},normal:{buffer:e,offset:12,normalized:!1,stride:24,size:3}},uniforms:{ambient:function(){return d},diffuse:function(a,b){var c=b.intensity;return[c*f[0],c*f[1],c*f[2]]},model:a.prop("model")},count:function(){return l.MESH.length/
6}}),z=a({frag:"\n      precision mediump float;\n\n      void main() {\n        if(gl_FrontFacing) {\n          gl_FragColor = vec4(0,1,0,1);  // useful color for debugging.\n        } else {\n          gl_FragColor = vec4(1,0,0,1); // useful color for debugging.\n        }\n      }\n      "}),B=a({vert:"\n      precision mediump float;\n      attribute vec4 position;\n      attribute vec3 normal0, normal1;\n\n      uniform vec3 lightDir;\n      uniform mat4 camera;\n      uniform mat4 model;\n      void main() {\n        /*\n          Every edge of the rabbit is assigned a triangle. To all the vertices of that assigned\n          triangle, we assign the face-normals of the two triangles incident to that edge.\n\n          For that assigned triangle we have that:\n          The first vertex is the first edge-vertex, and w=1\n          The second vertex is the second edge-vertex, and w=1\n          The third vertex is simply (0,0,0,0)\n\n          Now clearly, only if the first normal is facing the light, and the second normal\n          is facing away from the light, we have that the edge is part of the shadow silhouette.\n\n          If it is part of the silhouette, we project the first and second vertices\n          to infinity, in the direction of the light.\n          For the third vertex, we have that w=0, so it is kept in place.\n          Because the three vertices are placed in this way, the shadow silhouette is created for that edge.\n          So that's how this vertex shader works.\n\n          (if the above doesn't make sense, try drawing it out on paper.\n          It will make sense.)\n        */\n        if(dot(normal0, lightDir) <= 0.0 &&\n           dot(normal1, lightDir) >= 0.0) {\n          gl_Position = camera*model*(position + vec4((1.0-position.w) * lightDir, 0.0));\n        } else {\n          gl_Position = vec4(0,0,0,0);\n        }\n      }\n      ",
attributes:{position:{buffer:n,offset:0,normalized:!1,stride:40,size:4},normal0:{buffer:n,offset:16,normalized:!1,stride:40,size:3},normal1:{buffer:n,offset:28,normalized:!1,stride:40,size:3}},count:function(){return l.SHADOW.length/10},uniforms:{model:a.prop("model")}}),C=a({vert:"\n      precision mediump float;\n      attribute vec3 position, normal;\n\n      uniform vec3 lightDir;\n      uniform mat4 camera;\n\n      uniform mat4 model;\n\n      /*\n        The below vertex shader needs some explaining:\n\n        We define dark cap and light cap as in figure 9-6 of this article:\n        http://http.developer.nvidia.com/GPUGems/gpugems_ch09.html\n\n        Firstly, drawing the light cap is easy, because we can just draw the rabbit mesh as usual. See figure 9-6, and you should understand.\n\n        Secondly. however, we have the dark cap. Basically, to create the dark cap,\n        we need to project the mesh onto infinity, in the direction of the light.\n        And infinity, in the case of OpenGL, is just the faces of the clip-volume.\n        The clip-volume is just a cube, and everything outside of this cube, is simply not drawn by OpenGL.\n\n        So to project something to infinity, we need to project it onto one of the faces of this cube.\n        The face we project onto depends on the light direction, and what we are doing in the function\n        'extend', is that we are finding which face to project upon, and then we project the vertex\n        of the mesh onto that face, thus creating the dark cap.\n      */\n\n      vec4 extend(vec3 p) {\n        vec4 tlightDir = camera * vec4(lightDir,0);\n        vec3 light = normalize(tlightDir.xyz);\n        vec3 dpos = (1.0 - p) / light;\n        vec3 dneg = (vec3(-1.0,-1.0,0.0) - p) / light;\n        vec3 dt   = mix(dneg, dpos, step(0.0, light));\n        return vec4(0.999 * min(min(dt.x, dt.y), dt.z) * light + p, 0);\n      }\n\n      void main() {\n        vec4 projected = camera * model * vec4(position,1);\n        if(dot(normal,lightDir) <= 0.0) {\n          // light cap\n          gl_Position = projected;\n        } else {\n          // dark cap\n          gl_Position = extend(projected.xyz/projected.w);\n        }\n      }\n      ",
attributes:{position:{buffer:e,offset:0,normalized:!1,stride:24,size:3},normal:{buffer:e,offset:12,normalized:!1,stride:24,size:3}},count:function(){return l.MESH.length/6},uniforms:{model:a.prop("model")}});a.frame(function(f){var d=[];f=.003*f.tick;for(var g=0,m,e,g=0;.9>=g;g+=.1)m=2*Math.PI*g,e=c.identity([]),c.translate(e,e,[2*Math.cos(m+f),.6,2*Math.sin(m+f)]),d.push(e);for(g=0;.9>=g;g+=.2)m=2*Math.PI*g+1.3,e=c.identity([]),c.translate(e,e,[2*Math.cos(m+.3*f),1.3,2*Math.sin(m+.3*f)]),d.push(e);
var k=c.identity([]);c.translate(k,k,[0,0,0]);r(function(){a.clear({depth:1,color:[0,0,0,1]});q(function(){for(var a=0;a<d.length;a++)A({intensity:1,model:d[a]})});p({intensity:1,model:k});h(function(){a.clear({stencil:0});z(function(){for(var a=0;a<d.length;a++)B({model:d[a]}),C({model:d[a]})})});H(function(){for(var a=0;a<d.length;a++)A({intensity:.1,model:d[a]});p({intensity:.1,model:k})})});b.tick()})}})},{"../regl":81,"canvas-fit":34,"canvas-orbit-camera":35,"gl-mat4":49,resl:77}],2:[function(h,
p,t){function e(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}p.exports=function(c,a,b,f,d){c=b.maxAttributes;a=Array(c);for(b=0;b<c;++b)a[b]=new e;return{Record:e,scope:{},state:a}}},{}],3:[function(h,p,t){function e(a){return l[Object.prototype.toString.call(a)]|0}function c(a,b){for(var f=0;f<b.length;++f)a[f]=b[f]}function a(a,b,f,c,d,g,m){for(var e=0,k=0;k<f;++k)for(var l=0;l<c;++l)a[e++]=b[d*k+
g*l+m]}var b=h("./util/is-typed-array"),f=h("./util/is-ndarray"),d=h("./util/values"),g=h("./util/pool");t=h("./util/flatten");var m=t.flatten,k=t.shape,l=h("./constants/arraytypes.json"),n=h("./constants/dtypes.json"),r=h("./constants/usage.json"),q=[];q[5120]=1;q[5122]=2;q[5124]=4;q[5121]=1;q[5123]=2;q[5125]=4;q[5126]=4;p.exports=function(l,h,u){function w(a){this.id=z++;this.buffer=l.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=
null;u.profile&&(this.stats={size:0})}function x(a,b,f){a.byteLength=b.byteLength;l.bufferData(a.type,b,f)}function p(d,l,n,r,q,h){d.usage=n;if(Array.isArray(l)){if(d.dtype=r||5126,0<l.length)if(Array.isArray(l[0])){q=k(l);for(var v=r=1;v<q.length;++v)r*=q[v];d.dimension=r;l=m(l,q,d.dtype);x(d,l,n);h?d.persistentData=l:g.freeType(l)}else"number"===typeof l[0]?(d.dimension=q,q=g.allocType(d.dtype,l.length),c(q,l),x(d,q,n),h?d.persistentData=q:g.freeType(q)):b(l[0])&&(d.dimension=l[0].length,d.dtype=
r||e(l[0])||5126,l=m(l,[l.length,l[0].length],d.dtype),x(d,l,n),h?d.persistentData=l:g.freeType(l))}else if(b(l))d.dtype=r||e(l),d.dimension=q,x(d,l,n),h&&(d.persistentData=new Uint8Array(new Uint8Array(l.buffer)));else if(f(l)){q=l.shape;var u=l.stride,v=l.offset,B=0,w=0,H=0,z=0;1===q.length?(B=q[0],w=1,H=u[0],z=0):2===q.length&&(B=q[0],w=q[1],H=u[0],z=u[1]);d.dtype=r||e(l.data)||5126;d.dimension=w;q=g.allocType(d.dtype,B*w);a(q,l.data,B,w,H,z,v);x(d,q,n);h?d.persistentData=q:g.freeType(q)}}function A(a){h.bufferCount--;
l.deleteBuffer(a.buffer);a.buffer=null;delete B[a.id]}var z=0,B={};w.prototype.bind=function(){l.bindBuffer(this.type,this.buffer)};w.prototype.destroy=function(){A(this)};var C=[];u.profile&&(h.getTotalBufferSize=function(){var a=0;Object.keys(B).forEach(function(b){a+=B[b].stats.size});return a});return{create:function(d,x,z,C){function t(a){var c=35044,d=null,g=0,m=0,e=1;Array.isArray(a)||b(a)||f(a)?d=a:"number"===typeof a?g=a|0:a&&("data"in a&&(d=a.data),"usage"in a&&(c=r[a.usage]),"type"in a&&
(m=n[a.type]),"dimension"in a&&(e=a.dimension|0),"length"in a&&(g=a.length|0));D.bind();d?p(D,d,c,m,e,C):(l.bufferData(D.type,g,c),D.dtype=m||5121,D.usage=c,D.dimension=e,D.byteLength=g);u.profile&&(D.stats.size=D.byteLength*q[D.dtype]);return t}h.bufferCount++;var D=new w(x);B[D.id]=D;z||t(d);t._reglType="buffer";t._buffer=D;t.subdata=function(d,n){var r=(n||0)|0,q;D.bind();if(Array.isArray(d)){if(0<d.length)if("number"===typeof d[0]){var h=g.allocType(D.dtype,d.length);c(h,d);l.bufferSubData(D.type,
r,h);g.freeType(h)}else if(Array.isArray(d[0])||b(d[0]))q=k(d),h=m(d,q,D.dtype),l.bufferSubData(D.type,r,h),g.freeType(h)}else if(b(d))l.bufferSubData(D.type,r,d);else if(f(d)){q=d.shape;var u=d.stride,B=h=0,w=0,H=0;1===q.length?(h=q[0],B=1,w=u[0],H=0):2===q.length&&(h=q[0],B=q[1],w=u[0],H=u[1]);q=Array.isArray(d.data)?D.dtype:e(d.data);q=g.allocType(q,h*B);a(q,d.data,h,B,w,H,d.offset);l.bufferSubData(D.type,r,q);g.freeType(q)}return t};u.profile&&(t.stats=D.stats);t.destroy=function(){A(D)};return t},
createStream:function(a,b){var f=C.pop();f||(f=new w(a));f.bind();p(f,b,35040,0,1,!1);return f},destroyStream:function(a){C.push(a)},clear:function(){d(B).forEach(A);C.forEach(A)},getBuffer:function(a){return a&&a._buffer instanceof w?a._buffer:null},restore:function(){d(B).forEach(function(a){a.buffer=l.createBuffer();l.bindBuffer(a.type,a.buffer);l.bufferData(a.type,a.persistentData||a.byteLength,a.usage)})},_initBuffer:p}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,
"./util/flatten":24,"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/pool":29,"./util/values":32}],4:[function(h,p,t){p.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(h,p,t){p.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,
uint32:5125,"float":5126,float32:5126}},{}],6:[function(h,p,t){p.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(h,p,t){p.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(h,p,t){function e(a){return Array.isArray(a)||k(a)||l(a)}function c(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function a(a,b,f,c){this.thisDep=a;this.contextDep=b;this.propDep=
f;this.append=c}function b(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function f(b){return new a(!1,!1,!1,b)}function d(b,f){var c=b.type;return 0===c?(c=b.data.length,new a(!0,1<=c,2<=c,f)):4===c?(c=b.data,new a(c.thisDep,c.contextDep,c.propDep,f)):new a(3===c,2===c,1===c,f)}var g=h("./util/codegen"),m=h("./util/loop"),k=h("./util/is-typed-array"),l=h("./util/is-ndarray"),n=h("./util/is-array-like"),r=h("./dynamic"),q=h("./constants/primitives.json"),v=h("./constants/dtypes.json"),H=["x",
"y","z","w"],u="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),w={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},x={never:512,less:513,
"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},y={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},A={cw:2304,ccw:2305},z=new a(!1,!1,!1,function(){});p.exports=function(k,l,h,p,t,G,J,D,O,K,U,F,Z,fa,V){function W(a){return a.replace(".","_")}function Q(a,b,f){var c=W(a);Da.push(a);ya[c]=I[c]=!!f;qa[c]=b}function M(a,b,f){var c=
W(a);Da.push(a);Array.isArray(f)?(I[c]=f.slice(),ya[c]=f.slice()):I[c]=ya[c]=f;ra[c]=b}function aa(){var a=g(),b=a.link,f=a.global;a.id=Ia++;a.batchId="0";var c=b(Ha),d=a.shared={props:"a0"};Object.keys(Ha).forEach(function(a){d[a]=f.def(c,".",a)});var m=a.next={},e=a.current={};Object.keys(ra).forEach(function(a){Array.isArray(I[a])&&(m[a]=f.def(d.next,".",a),e[a]=f.def(d.current,".",a))});var k=a.constants={};Object.keys(Ea).forEach(function(a){k[a]=f.def(JSON.stringify(Ea[a]))});a.invoke=function(f,
c){switch(c.type){case 0:var g=["this",d.context,d.props,a.batchId];return f.def(b(c.data),".call(",g.slice(0,Math.max(c.data.length+1,4)),")");case 1:return f.def(d.props,c.data);case 2:return f.def(d.context,c.data);case 3:return f.def("this",c.data);case 4:return c.data.append(a,f),c.data.ref}};a.attribCache={};var n={};a.scopeAttrib=function(a){a=l.id(a);if(a in n)return n[a];var f=K.scope[a];f||(f=K.scope[a]=new ta);return n[a]=b(f)};return a}function ka(a){var b=a["static"];a=a.dynamic;var c;
if("profile"in b){var g=!!b.profile;c=f(function(a,b){return g});c.enable=g}else if("profile"in a){var m=a.profile;c=d(m,function(a,b){return a.invoke(b,m)})}return c}function sa(a,b){var c=a["static"],g=a.dynamic;if("framebuffer"in c){var m=c.framebuffer;return m?(m=D.getFramebuffer(m),f(function(a,b){var f=a.link(m),c=a.shared;b.set(c.framebuffer,".next",f);c=c.context;b.set(c,".framebufferWidth",f+".width");b.set(c,".framebufferHeight",f+".height");return f})):f(function(a,b){var f=a.shared;b.set(f.framebuffer,
".next","null");f=f.context;b.set(f,".framebufferWidth",f+".drawingBufferWidth");b.set(f,".framebufferHeight",f+".drawingBufferHeight");return"null"})}if("framebuffer"in g){var e=g.framebuffer;return d(e,function(a,b){var f=a.invoke(b,e),c=a.shared,d=c.framebuffer,f=b.def(d,".getFramebuffer(",f,")");b.set(d,".next",f);c=c.context;b.set(c,".framebufferWidth",f+"?"+f+".width:"+c+".drawingBufferWidth");b.set(c,".framebufferHeight",f+"?"+f+".height:"+c+".drawingBufferHeight");return f})}return null}function S(b,
f,c){function g(b){if(b in m){var c=m[b];b=!0;var k=c.x|0,l=c.y|0,n,r;"width"in c?n=c.width|0:b=!1;"height"in c?r=c.height|0:b=!1;return new a(!b&&f&&f.thisDep,!b&&f&&f.contextDep,!b&&f&&f.propDep,function(a,b){var f=a.shared.context,d=n;"width"in c||(d=b.def(f,".","framebufferWidth","-",k));var g=r;"height"in c||(g=b.def(f,".","framebufferHeight","-",l));return[k,l,d,g]})}if(b in e){var q=e[b];b=d(q,function(a,b){var f=a.invoke(b,q),c=a.shared.context,d=b.def(f,".x|0"),g=b.def(f,".y|0"),m=b.def('"width" in ',
f,"?",f,".width|0:","(",c,".","framebufferWidth","-",d,")"),f=b.def('"height" in ',f,"?",f,".height|0:","(",c,".","framebufferHeight","-",g,")");return[d,g,m,f]});f&&(b.thisDep=b.thisDep||f.thisDep,b.contextDep=b.contextDep||f.contextDep,b.propDep=b.propDep||f.propDep);return b}return f?new a(f.thisDep,f.contextDep,f.propDep,function(a,b){var f=a.shared.context;return[0,0,b.def(f,".","framebufferWidth"),b.def(f,".","framebufferHeight")]}):null}var m=b["static"],e=b.dynamic;if(b=g("viewport")){var k=
b;b=new a(b.thisDep,b.contextDep,b.propDep,function(a,b){var f=k.append(a,b),c=a.shared.context;b.set(c,".viewportWidth",f[2]);b.set(c,".viewportHeight",f[3]);return f})}return{viewport:b,scissor_box:g("scissor.box")}}function ga(c){function g(a){if(a in m){var b=l.id(m[a]);a=f(function(){return b});a.id=b;return a}if(a in e){var c=e[a];return d(c,function(a,b){var f=a.invoke(b,c);return b.def(a.shared.strings,".id(",f,")")})}return null}var m=c["static"],e=c.dynamic,k=g("frag"),n=g("vert"),r=null;
b(k)&&b(n)?(r=U.program(n.id,k.id),c=f(function(a,b){return a.link(r)})):c=new a(k&&k.thisDep||n&&n.thisDep,k&&k.contextDep||n&&n.contextDep,k&&k.propDep||n&&n.propDep,function(a,b){var f=a.shared.shader,c;c=k?k.append(a,b):b.def(f,".","frag");var d;d=n?n.append(a,b):b.def(f,".","vert");return b.def(f+".program("+d+","+c+")")});return{frag:k,vert:n,progVar:c,program:r}}function ia(c,g){function m(a,b){if(a in k){var c=k[a]|0;return f(function(a,f){b&&(a.OFFSET=c);return c})}if(a in l){var g=l[a];
return d(g,function(a,f){var c=a.invoke(f,g);b&&(a.OFFSET=c);return c})}return b&&n?f(function(a,b){a.OFFSET="0";return 0}):null}var k=c["static"],l=c.dynamic,n=function(){if("elements"in k){var a=k.elements;e(a)?a=G.getElements(G.create(a,!0)):a&&(a=G.getElements(a));var b=f(function(b,f){if(a){var c=b.link(a);return b.ELEMENTS=c}return b.ELEMENTS=null});b.value=a;return b}if("elements"in l){var c=l.elements;return d(c,function(a,b){var f=a.shared,d=f.isBufferArgs,f=f.elements,g=a.invoke(b,c),m=
b.def("null"),d=b.def(d,"(",g,")"),g=a.cond(d).then(m,"=",f,".createStream(",g,");")["else"](m,"=",f,".getElements(",g,");");b.entry(g);b.exit(a.cond(d).then(f,".destroyStream(",m,");"));return a.ELEMENTS=m})}return null}(),r=m("offset",!0);return{elements:n,primitive:function(){if("primitive"in k){var c=k.primitive;return f(function(a,b){return q[c]})}if("primitive"in l){var g=l.primitive;return d(g,function(a,b){var f=a.constants.primTypes,c=a.invoke(b,g);return b.def(f,"[",c,"]")})}return n?b(n)?
n.value?f(function(a,b){return b.def(a.ELEMENTS,".primType")}):f(function(){return 4}):new a(n.thisDep,n.contextDep,n.propDep,function(a,b){var f=a.ELEMENTS;return b.def(f,"?",f,".primType:",4)}):null}(),count:function(){if("count"in k){var c=k.count|0;return f(function(){return c})}if("count"in l){var g=l.count;return d(g,function(a,b){return a.invoke(b,g)})}return n?b(n)?n?r?new a(r.thisDep,r.contextDep,r.propDep,function(a,b){return b.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):f(function(a,b){return b.def(a.ELEMENTS,
".vertCount")}):f(function(){return-1}):new a(n.thisDep||r.thisDep,n.contextDep||r.contextDep,n.propDep||r.propDep,function(a,b){var f=a.ELEMENTS;return a.OFFSET?b.def(f,"?",f,".vertCount-",a.OFFSET,":-1"):b.def(f,"?",f,".vertCount:-1")}):null}(),instances:m("instances",!1),offset:r}}function na(a,b){var c=a["static"],g=a.dynamic,e={};Da.forEach(function(a){function b(m,l){if(a in c){var n=m(c[a]);e[k]=f(function(){return n})}else if(a in g){var r=g[a];e[k]=d(r,function(a,b){return l(a,b,a.invoke(b,
r))})}}var k=W(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return b(function(a){return a},function(a,b,f){return f});case "depth.func":return b(function(a){return x[a]},function(a,b,f){return b.def(a.constants.compareFuncs,"[",f,"]")});case "depth.range":return b(function(a){return a},function(a,b,f){a=b.def("+",f,"[0]");b=b.def("+",
f,"[1]");return[a,b]});case "blend.func":return b(function(a){return[w["srcRGB"in a?a.srcRGB:a.src],w["dstRGB"in a?a.dstRGB:a.dst],w["srcAlpha"in a?a.srcAlpha:a.src],w["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,b,f){function c(a,d){return b.def('"',a,d,'" in ',f,"?",f,".",a,d,":",f,".",a)}a=a.constants.blendFuncs;var d=c("src","RGB"),g=c("dst","RGB"),d=b.def(a,"[",d,"]"),m=b.def(a,"[",c("src","Alpha"),"]"),g=b.def(a,"[",g,"]");a=b.def(a,"[",c("dst","Alpha"),"]");return[d,g,m,a]});case "blend.equation":return b(function(a){if("string"===
typeof a)return[ba[a],ba[a]];if("object"===typeof a)return[ba[a.rgb],ba[a.alpha]]},function(a,b,f){var c=a.constants.blendEquations,d=b.def(),g=b.def();a=a.cond("typeof ",f,'==="string"');a.then(d,"=",g,"=",c,"[",f,"];");a["else"](d,"=",c,"[",f,".rgb];",g,"=",c,"[",f,".alpha];");b(a);return[d,g]});case "blend.color":return b(function(a){return m(4,function(b){return+a[b]})},function(a,b,f){return m(4,function(a){return b.def("+",f,"[",a,"]")})});case "stencil.mask":return b(function(a){return a|0},
function(a,b,f){return b.def(f,"|0")});case "stencil.func":return b(function(a){return[x[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,b,f){a=b.def('"cmp" in ',f,"?",a.constants.compareFuncs,"[",f,".cmp]",":",7680);var c=b.def(f,".ref|0");b=b.def('"mask" in ',f,"?",f,".mask|0:-1");return[a,c,b]});case "stencil.opFront":case "stencil.opBack":return b(function(b){return["stencil.opBack"===a?1029:1028,y[b.fail||"keep"],y[b.zfail||"keep"],y[b.zpass||"keep"]]},function(b,f,c){function d(a){return f.def('"',
a,'" in ',c,"?",g,"[",c,".",a,"]:",7680)}var g=b.constants.stencilOps;return["stencil.opBack"===a?1029:1028,d("fail"),d("zfail"),d("zpass")]});case "polygonOffset.offset":return b(function(a){return[a.factor|0,a.units|0]},function(a,b,f){a=b.def(f,".factor|0");b=b.def(f,".units|0");return[a,b]});case "cull.face":return b(function(a){var b=0;"front"===a?b=1028:"back"===a&&(b=1029);return b},function(a,b,f){return b.def(f,'==="front"?',1028,":",1029)});case "lineWidth":return b(function(a){return a},
function(a,b,f){return f});case "frontFace":return b(function(a){return A[a]},function(a,b,f){return b.def(f+'==="cw"?2304:2305')});case "colorMask":return b(function(a){return a.map(function(a){return!!a})},function(a,b,f){return m(4,function(a){return"!!"+f+"["+a+"]"})});case "sample.coverage":return b(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,b,f){a=b.def('"value" in ',f,"?+",f,".value:1");b=b.def("!!",f,".invert");return[a,b]})}});return e}function oa(a,b){var c=a["static"],
g=a.dynamic,e={};Object.keys(c).forEach(function(a){var b=c[a],d;if("number"===typeof b||"boolean"===typeof b)d=f(function(){return b});else if("function"===typeof b){var g=b._reglType;if("texture2d"===g||"textureCube"===g)d=f(function(a){return a.link(b)});else if("framebuffer"===g||"framebufferCube"===g)d=f(function(a){return a.link(b.color[0])})}else n(b)&&(d=f(function(a){return a.global.def("[",m(b.length,function(a){return b[a]}),"]")}));d.value=b;e[a]=d});Object.keys(g).forEach(function(a){var b=
g[a];e[a]=d(b,function(a,f){return a.invoke(f,b)})});return e}function ca(a,b){var c=a["static"],g=a.dynamic,m={};Object.keys(c).forEach(function(a){var b=c[a],d=l.id(a),g=new ta;if(e(b))g.state=1,g.buffer=t.getBuffer(t.create(b,34962,!1,!0)),g.type=0;else{var k=t.getBuffer(b);if(k)g.state=1,g.buffer=k,g.type=0;else if(b.constant){var n=b.constant;g.buffer="null";g.state=2;"number"===typeof n?g.x=n:H.forEach(function(a,b){b<n.length&&(g[a]=n[b])})}else{var k=e(b.buffer)?t.getBuffer(t.create(b.buffer,
34962,!1,!0)):t.getBuffer(b.buffer),r=b.offset|0,q=b.stride|0,h=b.size|0,I=!!b.normalized,u=0;"type"in b&&(u=v[b.type]);b=b.divisor|0;g.buffer=k;g.state=1;g.size=h;g.normalized=I;g.type=u||k.dtype;g.offset=r;g.stride=q;g.divisor=b}}m[a]=f(function(a,b){var f=a.attribCache;if(d in f)return f[d];var c={isStream:!1};Object.keys(g).forEach(function(a){c[a]=g[a]});g.buffer&&(c.buffer=a.link(g.buffer),c.type=c.type||c.buffer+".dtype");return f[d]=c})});Object.keys(g).forEach(function(a){var b=g[a];m[a]=
d(b,function(a,f){function c(a){f(k[a],"=",d,".",a,"|0;")}var d=a.invoke(f,b),g=a.shared,m=g.isBufferArgs,e=g.buffer,k={isStream:f.def(!1)},l=new ta;l.state=1;Object.keys(l).forEach(function(a){k[a]=f.def(""+l[a])});var n=k.buffer,r=k.type;f("if(",m,"(",d,")){",k.isStream,"=true;",n,"=",e,".createStream(",34962,",",d,");",r,"=",n,".dtype;","}else{",n,"=",e,".getBuffer(",d,");","if(",n,"){",r,"=",n,".dtype;",'}else if("constant" in ',d,"){",k.state,"=",2,";","if(typeof "+d+'.constant === "number"){',
k[H[0]],"=",d,".constant;",H.slice(1).map(function(a){return k[a]}).join("="),"=0;","}else{",H.map(function(a,b){return k[a]+"="+d+".constant.length>="+b+"?"+d+".constant["+b+"]:0;"}).join(""),"}}else{","if(",m,"(",d,".buffer)){",n,"=",e,".createStream(",34962,",",d,".buffer);","}else{",n,"=",e,".getBuffer(",d,".buffer);","}",r,'="type" in ',d,"?",g.glTypes,"[",d,".type]:",n,".dtype;",k.normalized,"=!!",d,".normalized;");c("size");c("offset");c("stride");c("divisor");f("}}");f.exit("if(",k.isStream,
"){",e,".destroyStream(",n,");","}");return k})});return m}function ha(a){var b=a["static"],c=a.dynamic,g={};Object.keys(b).forEach(function(a){var c=b[a];g[a]=f(function(a,b){return"number"===typeof c||"boolean"===typeof c?""+c:a.link(c)})});Object.keys(c).forEach(function(a){var b=c[a];g[a]=d(b,function(a,f){return a.invoke(f,b)})});return g}function ja(a,b,f,c,d){var g=sa(a,d),m=S(a,g,d),e=ia(a,d),k=na(a,d),l=ga(a,d),n=m.viewport;n&&(k.viewport=n);n=W("scissor.box");(m=m[n])&&(k[n]=m);m=0<Object.keys(k).length;
g={framebuffer:g,draw:e,shader:l,state:k,dirty:m};g.profile=ka(a,d);g.uniforms=oa(f,d);g.attributes=ca(b,d);g.context=ha(c,d);return g}function da(a,b,f){var c=a.shared.context,d=a.scope();Object.keys(f).forEach(function(g){b.save(c,"."+g);d(c,".",g,"=",f[g].append(a,b),";")});b(d)}function X(a,b,f,c){var d=a.shared,g=d.gl,m=d.framebuffer,e;la&&(e=b.def(d.extensions,".webgl_draw_buffers"));var k=a.constants,d=k.drawBuffer,k=k.backBuffer;a=f?f.append(a,b):b.def(m,".next");c||b("if(",a,"!==",m,".cur){");
b("if(",a,"){",g,".bindFramebuffer(",36160,",",a,".framebuffer);");la&&b(e,".drawBuffersWEBGL(",d,"[",a,".colorAttachments.length]);");b("}else{",g,".bindFramebuffer(",36160,",null);");la&&b(e,".drawBuffersWEBGL(",k,");");b("}",m,".cur=",a,";");c||b("}")}function ea(a,b,f){var c=a.shared,d=c.gl,g=a.current,e=a.next,k=c.current,l=c.next,n=a.cond(k,".dirty");Da.forEach(function(b){b=W(b);if(!(b in f.state)){var c,r;if(b in e){c=e[b];r=g[b];var q=m(I[b].length,function(a){return n.def(c,"[",a,"]")});
n(a.cond(q.map(function(a,b){return a+"!=="+r+"["+b+"]"}).join("||")).then(d,".",ra[b],"(",q,");",q.map(function(a,b){return r+"["+b+"]="+a}).join(";"),";"))}else c=n.def(l,".",b),q=a.cond(c,"!==",k,".",b),n(q),b in qa?q(a.cond(c).then(d,".enable(",qa[b],");")["else"](d,".disable(",qa[b],");"),k,".",b,"=",c,";"):q(d,".",ra[b],"(",c,");",k,".",b,"=",c,";")}});0===Object.keys(f.state).length&&n(k,".dirty=false;");b(n)}function P(a,f,d,g){var m=a.shared,e=a.current,k=m.current,l=m.gl;c(Object.keys(d)).forEach(function(c){var m=
d[c];if(!g||g(m)){var r=m.append(a,f);if(qa[c]){var q=qa[c];b(m)?r?f(l,".enable(",q,");"):f(l,".disable(",q,");"):f(a.cond(r).then(l,".enable(",q,");")["else"](l,".disable(",q,");"));f(k,".",c,"=",r,";")}else if(n(r)){var h=e[c];f(l,".",ra[c],"(",r,");",r.map(function(a,b){return h+"["+b+"]="+a}).join(";"),";")}else f(l,".",ra[c],"(",r,");",k,".",c,"=",r,";")}})}function ma(a,b){pa&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function T(a,f,c,d,g){function m(){return"undefined"===
typeof performance?"Date.now()":"performance.now()"}function e(a){v=f.def();a(v,"=",m(),";");"string"===typeof g?a(r,".count+=",g,";"):a(r,".count++;");fa&&(d?(I=f.def(),a(I,"=",h,".getNumPendingQueries();")):a(h,".beginQuery(",r,");"))}function k(a){a(r,".cpuTime+=",m(),"-",v,";");fa&&(d?a(h,".pushScopeStats(",I,",",h,".getNumPendingQueries(),",r,");"):a(h,".endQuery();"))}function l(a){var b=f.def(q,".profile");f(q,".profile=",a,";");f.exit(q,".profile=",b,";")}var n=a.shared,r=a.stats,q=n.current,
h=n.timer;c=c.profile;var v,I;if(c){if(b(c)){c.enable?(e(f),k(f.exit),l("true")):l("false");return}c=c.append(a,f);l(c)}else c=f.def(q,".profile");n=a.block();e(n);f("if(",c,"){",n,"}");a=a.block();k(a);f.exit("if(",c,"){",a,"}")}function Y(a,b,f,c,d){function g(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function m(f,c,d){function g(){b("if(!",r,".buffer){",l,".enableVertexAttribArray(",
n,");}");var f=d.type,m;m=d.size?b.def(d.size,"||",c):c;b("if(",r,".type!==",f,"||",r,".size!==",m,"||",v.map(function(a){return r+"."+a+"!=="+d[a]}).join("||"),"){",l,".bindBuffer(",34962,",",q,".buffer);",l,".vertexAttribPointer(",[n,m,f,d.normalized,d.stride,d.offset],");",r,".type=",f,";",r,".size=",m,";",v.map(function(a){return r+"."+a+"="+d[a]+";"}).join(""),"}");pa&&(f=d.divisor,b("if(",r,".divisor!==",f,"){",a.instancing,".vertexAttribDivisorANGLE(",[n,f],");",r,".divisor=",f,";}"))}function k(){b("if(",
r,".buffer){",l,".disableVertexAttribArray(",n,");","}if(",H.map(function(a,b){return r+"."+a+"!=="+h[b]}).join("||"),"){",l,".vertexAttrib4f(",n,",",h,");",H.map(function(a,b){return r+"."+a+"="+h[b]+";"}).join(""),"}")}var l=e.gl,n=b.def(f,".location"),r=b.def(e.attributes,"[",n,"]");f=d.state;var q=d.buffer,h=[d.x,d.y,d.z,d.w],v=["buffer","normalized","offset","stride"];1===f?g():2===f?k():(b("if(",f,"===",1,"){"),g(),b("}else{"),k(),b("}"))}var e=a.shared;c.forEach(function(c){var e=c.name,k=
f.attributes[e],l;if(k){if(!d(k))return;l=k.append(a,b)}else{if(!d(z))return;var n=a.scopeAttrib(e);l={};Object.keys(new ta).forEach(function(a){l[a]=b.def(n,".",a)})}m(a.link(c),g(c.info.type),l)})}function R(a,f,c,d,g){for(var e=a.shared,k=e.gl,r,q=0;q<d.length;++q){var h=d[q],v=h.name,I=h.info.type,u=c.uniforms[v],h=a.link(h)+".location",w;if(u){if(!g(u))continue;if(b(u)){v=u.value;if(35678===I||35680===I)I=a.link(v._texture||v.color[0]._texture),f(k,".uniform1i(",h,",",I+".bind());"),f.exit(I,
".unbind();");else if(35674===I||35675===I||35676===I)v=a.global.def("new Float32Array(["+Array.prototype.slice.call(v)+"])"),u=2,35675===I?u=3:35676===I&&(u=4),f(k,".uniformMatrix",u,"fv(",h,",false,",v,");");else{switch(I){case 5126:r="1f";break;case 35664:r="2f";break;case 35665:r="3f";break;case 35666:r="4f";break;case 35670:r="1i";break;case 5124:r="1i";break;case 35671:r="2i";break;case 35667:r="2i";break;case 35672:r="3i";break;case 35668:r="3i";break;case 35673:r="4i";break;case 35669:r="4i"}f(k,
".uniform",r,"(",h,",",n(v)?Array.prototype.slice.call(v):v,");")}continue}else w=u.append(a,f)}else{if(!g(z))continue;w=f.def(e.uniforms,"[",l.id(v),"]")}35678===I?f("if(",w,"&&",w,'._reglType==="framebuffer"){',w,"=",w,".color[0];","}"):35680===I&&f("if(",w,"&&",w,'._reglType==="framebufferCube"){',w,"=",w,".color[0];","}");v=1;switch(I){case 35678:case 35680:I=f.def(w,"._texture");f(k,".uniform1i(",h,",",I,".bind());");f.exit(I,".unbind();");continue;case 5124:case 35670:r="1i";break;case 35667:case 35671:r=
"2i";v=2;break;case 35668:case 35672:r="3i";v=3;break;case 35669:case 35673:r="4i";v=4;break;case 5126:r="1f";break;case 35664:r="2f";v=2;break;case 35665:r="3f";v=3;break;case 35666:r="4f";v=4;break;case 35674:r="Matrix2fv";break;case 35675:r="Matrix3fv";break;case 35676:r="Matrix4fv"}f(k,".uniform",r,"(",h,",");if("M"===r.charAt(0)){var h=Math.pow(I-35674+2,2),B=a.global.def("new Float32Array(",h,")");f("false,(Array.isArray(",w,")||",w," instanceof Float32Array)?",w,":(",m(h,function(a){return B+
"["+a+"]="+w+"["+a+"]"}),",",B,")")}else 1<v?f(m(v,function(a){return w+"["+a+"]"})):f(w);f(");")}}function za(a,f,c,d){function g(b){var m=r[b];return m?m.contextDep&&d.contextDynamic||m.propDep?m.append(a,c):m.append(a,f):f.def(n,".",b)}function m(){function a(){c(w,".drawElementsInstancedANGLE(",[h,I,B,v+"<<(("+B+"-5121)>>1)",u],");")}function b(){c(w,".drawArraysInstancedANGLE(",[h,v,I,u],");")}q?H?a():(c("if(",q,"){"),a(),c("}else{"),b(),c("}")):b()}function e(){function a(){c(l+".drawElements("+
[h,I,B,v+"<<(("+B+"-5121)>>1)"]+");")}function b(){c(l+".drawArrays("+[h,v,I]+");")}q?H?a():(c("if(",q,"){"),a(),c("}else{"),b(),c("}")):b()}var k=a.shared,l=k.gl,n=k.draw,r=d.draw,q=function(){var b=r.elements,g=f;if(b){if(b.contextDep&&d.contextDynamic||b.propDep)g=c;b=b.append(a,g)}else b=g.def(n,".","elements");b&&g("if("+b+")"+l+".bindBuffer(34963,"+b+".buffer.buffer);");return b}(),h=g("primitive"),v=g("offset"),I=function(){var b=r.count,g=f;if(b){if(b.contextDep&&d.contextDynamic||b.propDep)g=
c;b=b.append(a,g)}else b=g.def(n,".","count");return b}();if("number"===typeof I){if(0===I)return}else c("if(",I,"){"),c.exit("}");var u,w;pa&&(u=g("instances"),w=a.instancing);var B=q+".type",H=r.elements&&b(r.elements);pa&&("number"!==typeof u||0<=u)?"string"===typeof u?(c("if(",u,">0){"),m(),c("}else if(",u,"<0){"),e(),c("}")):m():e()}function wa(a,b,f,c,d){b=aa();d=b.proc("body",d);pa&&(b.instancing=d.def(b.shared.extensions,".angle_instanced_arrays"));a(b,d,f,c);return b.compile().body}function xa(a,
b,f,c){ma(a,b);Y(a,b,f,c.attributes,function(){return!0});R(a,b,f,c.uniforms,function(){return!0});za(a,b,b,f)}function Aa(a,b){var f=a.proc("draw",1);ma(a,f);da(a,f,b.context);X(a,f,b.framebuffer);ea(a,f,b);P(a,f,b.state);T(a,f,b,!1,!0);var c=b.shader.progVar.append(a,f);f(a.shared.gl,".useProgram(",c,".program);");if(b.shader.program)xa(a,f,b,b.shader.program);else{var d=a.global.def("{}"),g=f.def(c,".id"),m=f.def(d,"[",g,"]");f(a.cond(m).then(m,".call(this,a0);")["else"](m,"=",d,"[",g,"]=",a.link(function(f){return wa(xa,
a,b,f,1)}),"(",c,");",m,".call(this,a0);"))}0<Object.keys(b.state).length&&f(a.shared.current,".dirty=true;")}function Ba(a,b,f,c){function d(){return!0}a.batchId="a1";ma(a,b);Y(a,b,f,c.attributes,d);R(a,b,f,c.uniforms,d);za(a,b,b,f)}function ua(a,b,f,c){function d(a){return a.contextDep&&m||a.propDep}function g(a){return!d(a)}ma(a,b);var m=f.contextDep,e=b.def(),k=b.def();a.shared.props=k;a.batchId=e;var l=a.scope(),n=a.scope();b(l.entry,"for(",e,"=0;",e,"<","a1",";++",e,"){",k,"=","a0","[",e,"];",
n,"}",l.exit);f.needsContext&&da(a,n,f.context);f.needsFramebuffer&&X(a,n,f.framebuffer);P(a,n,f.state,d);f.profile&&d(f.profile)&&T(a,n,f,!1,!0);c?(Y(a,l,f,c.attributes,g),Y(a,n,f,c.attributes,d),R(a,l,f,c.uniforms,g),R(a,n,f,c.uniforms,d),za(a,l,n,f)):(b=a.global.def("{}"),c=f.shader.progVar.append(a,n),k=n.def(c,".id"),l=n.def(b,"[",k,"]"),n(a.shared.gl,".useProgram(",c,".program);","if(!",l,"){",l,"=",b,"[",k,"]=",a.link(function(b){return wa(Ba,a,f,b,2)}),"(",c,");}",l,".call(this,a0[",e,"],",
e,");"))}function va(a,b){function f(a){return a.contextDep&&d||a.propDep}var c=a.proc("batch",2);a.batchId="0";ma(a,c);var d=!1,g=!0;Object.keys(b.context).forEach(function(a){d=d||b.context[a].propDep});d||(da(a,c,b.context),g=!1);var m=b.framebuffer,e=!1;m?(m.propDep?d=e=!0:m.contextDep&&d&&(e=!0),e||X(a,c,m)):X(a,c,null);b.state.viewport&&b.state.viewport.propDep&&(d=!0);ea(a,c,b);P(a,c,b.state,function(a){return!f(a)});b.profile&&f(b.profile)||T(a,c,b,!1,"a1");b.contextDep=d;b.needsContext=g;
b.needsFramebuffer=e;g=b.shader.progVar;if(g.contextDep&&d||g.propDep)ua(a,c,b,null);else if(g=g.append(a,c),c(a.shared.gl,".useProgram(",g,".program);"),b.shader.program)ua(a,c,b,b.shader.program);else{var m=a.global.def("{}"),e=c.def(g,".id"),k=c.def(m,"[",e,"]");c(a.cond(k).then(k,".call(this,a0,a1);")["else"](k,"=",m,"[",e,"]=",a.link(function(f){return wa(ua,a,b,f,2)}),"(",g,");",k,".call(this,a0,a1);"))}0<Object.keys(b.state).length&&c(a.shared.current,".dirty=true;")}function Ga(a,b){function f(c){var m=
b.shader[c];m&&d.set(g.shader,"."+c,m.append(a,d))}var d=a.proc("scope",3);a.batchId="a2";var g=a.shared,m=g.current;da(a,d,b.context);b.framebuffer&&b.framebuffer.append(a,d);c(Object.keys(b.state)).forEach(function(f){var c=b.state[f].append(a,d);n(c)?c.forEach(function(b,c){d.set(a.next[f],"["+c+"]",b)}):d.set(g.next,"."+f,c)});T(a,d,b,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(f){var c=b.draw[f];c&&d.set(g.draw,"."+f,""+c.append(a,d))});Object.keys(b.uniforms).forEach(function(f){d.set(g.uniforms,
"["+l.id(f)+"]",b.uniforms[f].append(a,d))});Object.keys(b.attributes).forEach(function(f){var c=b.attributes[f].append(a,d),g=a.scopeAttrib(f);Object.keys(new ta).forEach(function(a){d.set(g,"."+a,c[a])})});f("vert");f("frag");0<Object.keys(b.state).length&&(d(m,".dirty=true;"),d.exit(m,".dirty=true;"));d("a1(",a.shared.context,",a0,",a.batchId,");")}function Fa(a){if("object"===typeof a&&!n(a)){for(var b=Object.keys(a),f=0;f<b.length;++f)if(r.isDynamic(a[b[f]]))return!0;return!1}}function Ca(a,
b,f){function c(a,b){e.forEach(function(f){var c=g[f];r.isDynamic(c)&&(c=a.invoke(b,c),b(q,".",f,"=",c,";"))})}var g=b["static"][f];if(g&&Fa(g)){var m=a.global,e=Object.keys(g),k=!1,l=!1,n=!1,q=a.global.def("{}");e.forEach(function(b){var f=g[b];if(r.isDynamic(f))"function"===typeof f&&(f=g[b]=r.unbox(f)),b=d(f,null),k=k||b.thisDep,n=n||b.propDep,l=l||b.contextDep;else{m(q,".",b,"=");switch(typeof f){case "number":m(f);break;case "string":m('"',f,'"');break;case "object":Array.isArray(f)&&m("[",f.join(),
"]");break;default:m(a.link(f))}m(";")}});b.dynamic[f]=new r.DynamicVariable(4,{thisDep:k,contextDep:l,propDep:n,ref:q,append:c});delete b["static"][f]}}var ta=K.Record,ba={add:32774,subtract:32778,"reverse subtract":32779};h.ext_blend_minmax&&(ba.min=32775,ba.max=32776);var pa=h.angle_instanced_arrays,la=h.webgl_draw_buffers,I={dirty:!0,profile:V.profile},ya={},Da=[],qa={},ra={};Q("dither",3024);Q("blend.enable",3042);M("blend.color","blendColor",[0,0,0,0]);M("blend.equation","blendEquationSeparate",
[32774,32774]);M("blend.func","blendFuncSeparate",[1,0,1,0]);Q("depth.enable",2929,!0);M("depth.func","depthFunc",513);M("depth.range","depthRange",[0,1]);M("depth.mask","depthMask",!0);M("colorMask","colorMask",[!0,!0,!0,!0]);Q("cull.enable",2884);M("cull.face","cullFace",1029);M("frontFace","frontFace",2305);M("lineWidth","lineWidth",1);Q("polygonOffset.enable",32823);M("polygonOffset.offset","polygonOffset",[0,0]);Q("sample.alpha",32926);Q("sample.enable",32928);M("sample.coverage","sampleCoverage",
[1,!1]);Q("stencil.enable",2960);M("stencil.mask","stencilMask",-1);M("stencil.func","stencilFunc",[519,0,-1]);M("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);M("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);Q("scissor.enable",3089);M("scissor.box","scissor",[0,0,k.drawingBufferWidth,k.drawingBufferHeight]);M("viewport","viewport",[0,0,k.drawingBufferWidth,k.drawingBufferHeight]);var Ha={gl:k,context:Z,strings:l,next:ya,current:I,draw:F,elements:G,buffer:t,shader:U,attributes:K.state,
uniforms:O,framebuffer:D,extensions:h,timer:fa,isBufferArgs:e},Ea={primTypes:q,compareFuncs:x,blendFuncs:w,blendEquations:ba,stencilOps:y,glTypes:v,orientationType:A};la&&(Ea.backBuffer=[1029],Ea.drawBuffer=m(p.maxDrawbuffers,function(a){return 0===a?[0]:m(a,function(a){return 36064+a})}));var Ia=0;return{next:ya,current:I,procs:function(){var a=aa(),b=a.proc("poll"),f=a.proc("refresh"),c=a.block();b(c);f(c);var d=a.shared,g=d.gl,e=d.next,l=d.current;c(l,".dirty=false;");X(a,b);X(a,f,null,!0);var r=
k.getExtension("angle_instanced_arrays"),q;r&&(q=a.link(r));for(var h=0;h<p.maxAttributes;++h){var v=f.def(d.attributes,"[",h,"]"),u=a.cond(v,".buffer");u.then(g,".enableVertexAttribArray(",h,");",g,".bindBuffer(",34962,",",v,".buffer.buffer);",g,".vertexAttribPointer(",h,",",v,".size,",v,".type,",v,".normalized,",v,".stride,",v,".offset);")["else"](g,".disableVertexAttribArray(",h,");",g,".vertexAttrib4f(",h,",",v,".x,",v,".y,",v,".z,",v,".w);",v,".buffer=null;");f(u);r&&f(q,".vertexAttribDivisorANGLE(",
h,",",v,".divisor);")}Object.keys(qa).forEach(function(d){var m=qa[d],k=c.def(e,".",d),n=a.block();n("if(",k,"){",g,".enable(",m,")}else{",g,".disable(",m,")}",l,".",d,"=",k,";");f(n);b("if(",k,"!==",l,".",d,"){",n,"}")});Object.keys(ra).forEach(function(d){var k=ra[d],r=I[d],q,h,v=a.block();v(g,".",k,"(");n(r)?(k=r.length,q=a.global.def(e,".",d),h=a.global.def(l,".",d),v(m(k,function(a){return q+"["+a+"]"}),");",m(k,function(a){return h+"["+a+"]="+q+"["+a+"];"}).join("")),b("if(",m(k,function(a){return q+
"["+a+"]!=="+h+"["+a+"]"}).join("||"),"){",v,"}")):(q=c.def(e,".",d),h=c.def(l,".",d),v(q,");",l,".",d,"=",q,";"),b("if(",q,"!==",h,"){",v,"}"));f(v)});return a.compile()}(),compile:function(a,b,f,c,d){var g=aa();g.stats=g.link(d);Object.keys(b["static"]).forEach(function(a){Ca(g,b,a)});u.forEach(function(b){Ca(g,a,b)});f=ja(a,b,f,c,g);Aa(g,f);Ga(g,f);va(g,f);return g.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./dynamic":9,"./util/codegen":22,"./util/is-array-like":25,
"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/loop":28}],9:[function(h,p,t){function e(a,c){this.id=b++;this.type=a;this.data=c}function c(a){if(0===a.length)return[];var b=a.charAt(0),g=a.charAt(a.length-1);if(1<a.length&&b===g&&('"'===b||"'"===b))return['"'+a.substr(1,a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(b=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return c(a.substr(0,b.index)).concat(c(b[1])).concat(c(a.substr(b.index+b[0].length)));b=a.split(".");
if(1===b.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];a=[];for(g=0;g<b.length;++g)a=a.concat(c(b[g]));return a}function a(a){return"["+c(a).join("][")+"]"}var b=0;p.exports={DynamicVariable:e,define:function(b,c){return new e(b,a(c+""))},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof e},unbox:function(a,b){return"function"===typeof a?new e(0,a):a},accessor:a}},{}],10:[function(h,p,t){var e=h("./util/is-typed-array"),c=h("./util/is-ndarray"),a=h("./util/values"),
b=h("./constants/primitives.json"),f=h("./constants/usage.json");p.exports=function(d,g,m,k){function l(a){this.id=h++;q[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function n(a,b,f,k,l,n,r){a.buffer.bind();if(b){var q=r;r||e(b)&&(!c(b)||e(b.data))||(q=g.oes_element_index_uint?5125:5123);m._initBuffer(a.buffer,b,f,q,3)}else d.bufferData(34963,n,f),a.buffer.dtype=q||5121,a.buffer.usage=f,a.buffer.dimension=3,a.buffer.byteLength=n;q=r;if(!r){switch(a.buffer.dtype){case 5121:case 5120:q=
5121;break;case 5123:case 5122:q=5123;break;case 5125:case 5124:q=5125}a.buffer.dtype=q}a.type=q;b=l;0>b&&(b=a.buffer.byteLength,5123===q?b>>=1:5125===q&&(b>>=2));a.vertCount=b;b=k;0>k&&(b=4,k=a.buffer.dimension,1===k&&(b=0),2===k&&(b=1),3===k&&(b=4));a.primType=b}function r(a){k.elementsCount--;delete q[a.id];a.buffer.destroy();a.buffer=null}var q={},h=0,H={uint8:5121,uint16:5123};g.oes_element_index_uint&&(H.uint32=5125);l.prototype.bind=function(){this.buffer.bind()};var u=[];return{create:function(a,
d){function g(a){if(a)if("number"===typeof a)q(a),h.primType=4,h.vertCount=a|0,h.type=5121;else{var d=null,m=35044,k=-1,l=-1,r=0,v=0;if(Array.isArray(a)||e(a)||c(a))d=a;else if("data"in a&&(d=a.data),"usage"in a&&(m=f[a.usage]),"primitive"in a&&(k=b[a.primitive]),"count"in a&&(l=a.count|0),"type"in a&&(v=H[a.type]),"length"in a)r=a.length|0;else if(r=l,5123===v||5122===v)r*=2;else if(5125===v||5124===v)r*=4;n(h,d,m,k,l,r,v)}else q(),h.primType=4,h.vertCount=0,h.type=5121;return g}var q=m.create(null,
34963,!0),h=new l(q._buffer);k.elementsCount++;g(a);g._reglType="elements";g._elements=h;g.subdata=function(a,b){q.subdata(a,b);return g};g.destroy=function(){r(h)};return g},createStream:function(a){var b=u.pop();b||(b=new l(m.create(null,34963,!0,!1)._buffer));n(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){u.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof l?a._elements:null},clear:function(){a(q).forEach(r)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,
"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/values":32}],11:[function(h,p,t){p.exports=function(e,c){function a(a){a=a.toLowerCase();var f;try{f=b[a]=e.getExtension(a)}catch(c){}return!!f}for(var b={},f=0;f<c.extensions.length;++f){var d=c.extensions[f];if(!a(d))return c.onDestroy(),c.onDone('"'+d+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}c.optionalExtensions.forEach(a);return{extensions:b,restore:function(){Object.keys(b).forEach(function(b){if(!a(b))throw Error("(regl): error restoring extension "+
b);})}}}},{}],12:[function(h,p,t){var e=h("./util/values"),c=h("./util/extend"),a=[];a[6408]=4;var b=[];b[5121]=1;b[5126]=4;b[36193]=2;p.exports=function(f,d,g,m,k,l){function n(a,b,f){this.target=a;this.texture=b;this.renderbuffer=f;var c=a=0;b?(a=b.width,c=b.height):f&&(a=f.width,c=f.height);this.width=a;this.height=c}function r(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function q(a,b,f){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=
1)}function h(a,b){b&&(b.texture?f.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,0):f.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer))}function H(a){var b=3553,f=null,c=null,d=a;"object"===typeof a&&(d=a.data,"target"in a&&(b=a.target|0));a=d._reglType;"texture2d"===a?f=d:"textureCube"===a?f=d:"renderbuffer"===a&&(c=d,b=36161);return new n(b,f,c)}function u(a,b,f,c,d){if(f)return a=m.create2D({width:a,height:b,format:c,type:d}),a._texture.refCount=
0,new n(3553,a,null);a=k.create({width:a,height:b,format:c});a._renderbuffer.refCount=0;return new n(36161,null,a)}function w(a){return a&&(a.texture||a.renderbuffer)}function p(a,b,f){a&&(a.texture?a.texture.resize(b,f):a.renderbuffer&&a.renderbuffer.resize(b,f))}function y(){this.id=J++;D[this.id]=this;this.framebuffer=f.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function A(a){a.colorAttachments.forEach(r);
r(a.depthAttachment);r(a.stencilAttachment);r(a.depthStencilAttachment)}function z(a){f.deleteFramebuffer(a.framebuffer);a.framebuffer=null;l.framebufferCount--;delete D[a.id]}function B(a){var b;f.bindFramebuffer(36160,a.framebuffer);var c=a.colorAttachments;for(b=0;b<c.length;++b)h(36064+b,c[b]);for(b=c.length;b<g.maxColorAttachments;++b)f.framebufferTexture2D(36160,36064+b,3553,null,0);f.framebufferTexture2D(36160,33306,3553,null,0);f.framebufferTexture2D(36160,36096,3553,null,0);f.framebufferTexture2D(36160,
36128,3553,null,0);h(36096,a.depthAttachment);h(36128,a.stencilAttachment);h(33306,a.depthStencilAttachment);f.checkFramebufferStatus(36160);f.bindFramebuffer(36160,E.next);E.cur=E.next;f.getError()}function t(f,d){function g(f,c){var d,e=0,k=0,l=!0,n=!0;d=null;var r=!0,h="rgba",v="uint8",p=1,z=null,x=null,y=null,t=!1;if("number"===typeof f)e=f|0,k=c|0||e;else if(f){"shape"in f?(k=f.shape,e=k[0],k=k[1]):("radius"in f&&(e=k=f.radius),"width"in f&&(e=f.width),"height"in f&&(k=f.height));if("color"in
f||"colors"in f)d=f.color||f.colors,Array.isArray(d);if(!d){"colorCount"in f&&(p=f.colorCount|0);"colorTexture"in f&&(r=!!f.colorTexture,h="rgba4");if("colorType"in f&&(v=f.colorType,!r))if("half float"===v||"float16"===v)h="rgba16f";else if("float"===v||"float32"===v)h="rgba32f";"colorFormat"in f&&(h=f.colorFormat,0<=N.indexOf(h)?r=!0:0<=L.indexOf(h)&&(r=!1))}if("depthTexture"in f||"depthStencilTexture"in f)t=!(!f.depthTexture&&!f.depthStencilTexture);"depth"in f&&("boolean"===typeof f.depth?l=f.depth:
(z=f.depth,n=!1));"stencil"in f&&("boolean"===typeof f.stencil?n=f.stencil:(x=f.stencil,l=!1));"depthStencil"in f&&("boolean"===typeof f.depthStencil?l=n=f.depthStencil:(y=f.depthStencil,n=l=!1))}else e=k=1;var C=null,E=null,G=null,D=null;if(Array.isArray(d))C=d.map(H);else if(d)C=[H(d)];else for(C=Array(p),d=0;d<p;++d)C[d]=u(e,k,r,h,v);e=e||C[0].width;k=k||C[0].height;z?E=H(z):l&&!n&&(E=u(e,k,t,"depth","uint32"));x?G=H(x):n&&!l&&(G=u(e,k,!1,"stencil","uint8"));y?D=H(y):!z&&!x&&n&&l&&(D=u(e,k,t,"depth stencil",
"depth stencil"));l=null;for(d=0;d<C.length;++d)q(C[d],e,k),C[d]&&C[d].texture&&(n=a[C[d].texture._texture.format]*b[C[d].texture._texture.type],null===l&&(l=n));q(E,e,k);q(G,e,k);q(D,e,k);A(m);m.width=e;m.height=k;m.colorAttachments=C;m.depthAttachment=E;m.stencilAttachment=G;m.depthStencilAttachment=D;g.color=C.map(w);g.depth=w(E);g.stencil=w(G);g.depthStencil=w(D);g.width=m.width;g.height=m.height;B(m);return g}var m=new y;l.framebufferCount++;g(f,d);return c(g,{resize:function(a,b){var f=a|0,
c=b|0||f;if(f===m.width&&c===m.height)return g;for(var d=m.colorAttachments,e=0;e<d.length;++e)p(d[e],f,c);p(m.depthAttachment,f,c);p(m.stencilAttachment,f,c);p(m.depthStencilAttachment,f,c);m.width=g.width=f;m.height=g.height=c;B(m);return g},_reglType:"framebuffer",_framebuffer:m,destroy:function(){z(m);A(m)}})}var E={cur:null,next:null,dirty:!1},N=["rgba"],L=["rgba4","rgb565","rgb5 a1"];d.ext_srgb&&L.push("srgba");d.ext_color_buffer_half_float&&L.push("rgba16f","rgb16f");d.webgl_color_buffer_float&&
L.push("rgba32f");var G=["uint8"];d.oes_texture_half_float&&G.push("half float","float16");d.oes_texture_float&&G.push("float","float32");var J=0,D={};return c(E,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof y)?a:null},create:t,createCube:function(a){function b(a){var d,g={color:null},e=0,k=null;d="rgba";var l="uint8",n=1;if("number"===typeof a)e=a|0;else if(a){"shape"in a?e=a.shape[0]:("radius"in a&&(e=a.radius|0),"width"in a?
e=a.width|0:"height"in a&&(e=a.height|0));if("color"in a||"colors"in a)k=a.color||a.colors,Array.isArray(k);k||("colorCount"in a&&(n=a.colorCount|0),"colorType"in a&&(l=a.colorType),"colorFormat"in a&&(d=a.colorFormat));"depth"in a&&(g.depth=a.depth);"stencil"in a&&(g.stencil=a.stencil);"depthStencil"in a&&(g.depthStencil=a.depthStencil)}else e=1;if(k)if(Array.isArray(k))for(a=[],d=0;d<k.length;++d)a[d]=k[d];else a=[k];else for(a=Array(n),k={radius:e,format:d,type:l},d=0;d<n;++d)a[d]=m.createCube(k);
g.color=Array(a.length);for(d=0;d<a.length;++d)n=a[d],e=e||n.width,g.color[d]={target:34069,data:a[d]};for(d=0;6>d;++d){for(n=0;n<a.length;++n)g.color[n].target=34069+d;0<d&&(g.depth=f[0].depth,g.stencil=f[0].stencil,g.depthStencil=f[0].depthStencil);if(f[d])f[d](g);else f[d]=t(g)}return c(b,{width:e,height:e,color:a})}var f=Array(6);b(a);return c(b,{faces:f,resize:function(a){var c=a|0;if(c===b.width)return b;var d=b.color;for(a=0;a<d.length;++a)d[a].resize(c);for(a=0;6>a;++a)f[a].resize(c);b.width=
b.height=c;return b},_reglType:"framebufferCube",destroy:function(){f.forEach(function(a){a.destroy()})}})},clear:function(){e(D).forEach(z)},restore:function(){e(D).forEach(function(a){a.framebuffer=f.createFramebuffer();B(a)})}})}},{"./util/extend":23,"./util/values":32}],13:[function(h,p,t){p.exports=function(e,c){var a=1;c.ext_texture_filter_anisotropic&&(a=e.getParameter(34047));var b=1,f=1;c.webgl_draw_buffers&&(b=e.getParameter(34852),f=e.getParameter(36063));return{colorBits:[e.getParameter(3410),
e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(c).filter(function(a){return!!c[a]}),maxAnisotropic:a,maxDrawbuffers:b,maxColorAttachments:f,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),
maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938)}}},{}],14:[function(h,p,t){var e=h("./util/is-typed-array");p.exports=function(c,a,b,f,d,g){return function(d){var g;
g=null===a.next?5121:a.next.colorAttachments[0].texture._texture.type;var l=0,n=0,r=f.framebufferWidth,q=f.framebufferHeight,h=null;e(d)?h=d:d&&(l=d.x|0,n=d.y|0,r=(d.width||f.framebufferWidth-l)|0,q=(d.height||f.framebufferHeight-n)|0,h=d.data||null);b();d=r*q*4;h||(5121===g?h=new Uint8Array(d):5126===g&&(h=h||new Float32Array(d)));c.pixelStorei(3333,4);c.readPixels(l,n,r,q,6408,g,h);return h}}},{"./util/is-typed-array":27}],15:[function(h,p,t){var e=h("./util/values"),c=[];c[32854]=2;c[32855]=2;
c[36194]=2;c[33189]=2;c[36168]=1;c[34041]=4;c[35907]=4;c[34836]=16;c[34842]=8;c[34843]=6;p.exports=function(a,b,f,d,g){function m(a){this.id=r++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0;g.profile&&(this.stats={size:0})}function k(b){var f=b.renderbuffer;a.bindRenderbuffer(36161,null);a.deleteRenderbuffer(f);b.renderbuffer=null;b.refCount=0;delete q[b.id];d.renderbufferCount--}var l={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};
b.ext_srgb&&(l.srgba=35907);b.ext_color_buffer_half_float&&(l.rgba16f=34842,l.rgb16f=34843);b.webgl_color_buffer_float&&(l.rgba32f=34836);var n=[];Object.keys(l).forEach(function(a){n[l[a]]=a});var r=0,q={};m.prototype.decRef=function(){0>=--this.refCount&&k(this)};g.profile&&(d.getTotalRenderbufferSize=function(){var a=0;Object.keys(q).forEach(function(b){a+=q[b].stats.size});return a});return{create:function(b,f){function e(b,f){var d=0,m=0,r=32854;"object"===typeof b&&b?("shape"in b?(m=b.shape,
d=m[0]|0,m=m[1]|0):("radius"in b&&(d=m=b.radius|0),"width"in b&&(d=b.width|0),"height"in b&&(m=b.height|0)),"format"in b&&(r=l[b.format])):"number"===typeof b?(d=b|0,m="number"===typeof f?f|0:d):b||(d=m=1);if(d!==k.width||m!==k.height||r!==k.format)return e.width=k.width=d,e.height=k.height=m,k.format=r,a.bindRenderbuffer(36161,k.renderbuffer),a.renderbufferStorage(36161,r,d,m),g.profile&&(k.stats.size=c[k.format]*k.width*k.height),e.format=n[k.format],e}var k=new m(a.createRenderbuffer());q[k.id]=
k;d.renderbufferCount++;e(b,f);e.resize=function(b,f){var d=b|0,m=f|0||d;if(d===k.width&&m===k.height)return e;e.width=k.width=d;e.height=k.height=m;a.bindRenderbuffer(36161,k.renderbuffer);a.renderbufferStorage(36161,k.format,d,m);g.profile&&(k.stats.size=c[k.format]*k.width*k.height);return e};e._reglType="renderbuffer";e._renderbuffer=k;g.profile&&(e.stats=k.stats);e.destroy=function(){k.decRef()};return e},clear:function(){e(q).forEach(k)},restore:function(){e(q).forEach(function(b){b.renderbuffer=
a.createRenderbuffer();a.bindRenderbuffer(36161,b.renderbuffer);a.renderbufferStorage(36161,b.format,b.width,b.height)});a.bindRenderbuffer(36161,null)}}}},{"./util/values":32}],16:[function(h,p,t){var e=h("./util/values");p.exports=function(c,a,b,f){function d(a,b,f,c){this.name=a;this.id=b;this.location=f;this.info=c}function g(a,b){for(var f=0;f<a.length;++f)if(a[f].id===b.id){a[f].location=b.location;return}a.push(b)}function m(b,f,d){d=35632===b?n:r;var g=d[f];if(!g){var m=a.str(f),g=c.createShader(b);
c.shaderSource(g,m);c.compileShader(g);d[f]=g}return g}function k(a,b){this.id=H++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[];f.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function l(b,e){var k,l;k=m(35632,b.fragId);l=m(35633,b.vertId);var n=b.program=c.createProgram();c.attachShader(n,k);c.attachShader(n,l);c.linkProgram(n);var r=c.getProgramParameter(n,35718);f.profile&&(b.stats.uniformsCount=r);var q=b.uniforms;for(k=0;k<r;++k)if(l=c.getActiveUniform(n,
k))if(1<l.size)for(var h=0;h<l.size;++h){var v=l.name.replace("[0]","["+h+"]");g(q,new d(v,a.id(v),c.getUniformLocation(n,v),l))}else g(q,new d(l.name,a.id(l.name),c.getUniformLocation(n,l.name),l));r=c.getProgramParameter(n,35721);f.profile&&(b.stats.attributesCount=r);q=b.attributes;for(k=0;k<r;++k)(l=c.getActiveAttrib(n,k))&&g(q,new d(l.name,a.id(l.name),c.getAttribLocation(n,l.name),l))}var n={},r={},q={},h=[],H=0;f.profile&&(b.getMaxUniformsCount=function(){var a=0;h.forEach(function(b){b.stats.uniformsCount>
a&&(a=b.stats.uniformsCount)});return a},b.getMaxAttributesCount=function(){var a=0;h.forEach(function(b){b.stats.attributesCount>a&&(a=b.stats.attributesCount)});return a});return{clear:function(){var a=c.deleteShader.bind(c);e(n).forEach(a);n={};e(r).forEach(a);r={};h.forEach(function(a){c.deleteProgram(a.program)});h.length=0;q={};b.shaderCount=0},program:function(a,f,c){b.shaderCount++;var d=q[f];d||(d=q[f]={});var g=d[a];g||(g=new k(f,a),l(g,c),d[a]=g,h.push(g));return g},restore:function(){n=
{};r={};for(var a=0;a<h.length;++a)l(h[a])},shader:m,frag:-1,vert:-1}}},{"./util/values":32}],17:[function(h,p,t){p.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},{}],18:[function(h,p,t){p.exports=function(){var e={"":0},c=[""];return{id:function(a){var b=e[a];if(b)return b;b=e[a]=c.length;c.push(a);return b},str:function(a){return c[a]}}}},{}],19:[function(h,p,t){function e(a){return Array.isArray(a)&&
(0===a.length||"number"===typeof a[0])}function c(a){return Array.isArray(a)&&0!==a.length&&q(a[0])?!0:!1}function a(a){return Object.prototype.toString.call(a)}function b(b){if(!b)return!1;var f=a(b);return 0<=y.indexOf(f)?!0:e(b)||c(b)||l(b)}function f(a,b){36193===a.type?(a.data=r(b),n.freeType(b)):a.data=b}function d(a,b,f,c,d,g){a="undefined"!==typeof z[a]?z[a]:x[a]*A[b];g&&(a*=6);if(d){for(c=0;1<=f;)c+=a*f*f,f/=2;return c}return a*f*c}var g=h("./util/extend"),m=h("./util/values"),k=h("./util/is-typed-array"),
l=h("./util/is-ndarray"),n=h("./util/pool"),r=h("./util/to-half-float"),q=h("./util/is-array-like"),v=h("./util/flatten");t=h("./constants/arraytypes.json");var H=h("./constants/arraytypes.json"),u=[9984,9986,9985,9987],w=[0,6409,6410,6407,6408],x={};x[6409]=x[6406]=x[6402]=1;x[34041]=x[6410]=2;x[6407]=x[35904]=3;x[6408]=x[35906]=4;var y=Object.keys(t).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),A=[];A[5121]=1;
A[5126]=4;A[36193]=2;A[5123]=2;A[5125]=4;var z=[];z[32854]=2;z[32855]=2;z[36194]=2;z[34041]=4;z[33776]=.5;z[33777]=.5;z[33778]=1;z[33779]=1;z[35986]=.5;z[35987]=1;z[34798]=1;z[35840]=.5;z[35841]=.25;z[35842]=.5;z[35843]=.25;z[36196]=.5;p.exports=function(h,p,z,t,y,A,J){function D(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.channels=this.height=this.width=this.colorSpace=0}function O(a,b){a.internalformat=b.internalformat;
a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function K(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=ma[b.colorSpace]);"type"in b&&(a.type=T[b.type]);var f=
a.width,c=a.height,d=a.channels,g=!1;"shape"in b?(f=b.shape[0],c=b.shape[1],3===b.shape.length&&(d=b.shape[2],g=!0)):("radius"in b&&(f=c=b.radius),"width"in b&&(f=b.width),"height"in b&&(c=b.height),"channels"in b&&(d=b.channels,g=!0));a.width=f|0;a.height=c|0;a.channels=d|0;f=!1;"format"in b&&(f=b.format,c=a.internalformat=Y[f],a.format=Ga[c],f in T&&!("type"in b)&&(a.type=T[f]),f in R&&(a.compressed=!0),f=!0);!g&&f?a.channels=x[a.format]:g&&!f&&a.channels!==w[a.format]&&(a.format=a.internalformat=
w[a.channels])}}function U(a){h.pixelStorei(37440,a.flipY);h.pixelStorei(37441,a.premultiplyAlpha);h.pixelStorei(37443,a.colorSpace);h.pixelStorei(3317,a.unpackAlignment)}function F(){D.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function Z(d,g){var m=null;b(g)?m=g:g&&(K(d,g),"x"in g&&(d.xOffset=g.x|0),"y"in g&&(d.yOffset=g.y|0),b(g.data)&&(m=g.data));if(g.copy){var h=y.viewportWidth,u=y.viewportHeight;d.width=d.width||h-d.xOffset;d.height=
d.height||u-d.yOffset;d.needsCopy=!0}else if(!m)d.width=d.width||1,d.height=d.height||1,d.channels=d.channels||4;else if(k(m))d.channels=d.channels||4,d.data=m,"type"in g||5121!==d.type||(d.type=H[Object.prototype.toString.call(m)]|0);else if(e(m)){d.channels=d.channels||4;h=m;u=h.length;switch(d.type){case 5121:case 5123:case 5125:case 5126:u=n.allocType(d.type,u);u.set(h);d.data=u;break;case 36193:d.data=r(h)}d.alignment=1;d.needsFree=!0}else if(l(m)){h=m.data;Array.isArray(h)||5121!==d.type||(d.type=
H[Object.prototype.toString.call(h)]|0);var u=m.shape,p=m.stride,z,x,t,B;3===u.length?(t=u[2],B=p[2]):B=t=1;z=u[0];x=u[1];u=p[0];p=p[1];d.alignment=1;d.width=z;d.height=x;d.channels=t;d.format=d.internalformat=w[t];d.needsFree=!0;z=B;m=m.offset;t=d.width;B=d.height;x=d.channels;for(var A=n.allocType(36193===d.type?5126:d.type,t*B*x),C=0,D=0;D<B;++D)for(var E=0;E<t;++E)for(var G=0;G<x;++G)A[C++]=h[u*E+p*D+z*G+m];f(d,A)}else if("[object HTMLCanvasElement]"===a(m)||"[object CanvasRenderingContext2D]"===
a(m))"[object HTMLCanvasElement]"===a(m)?d.element=m:d.element=m.canvas,d.width=d.element.width,d.height=d.element.height,d.channels=4;else if("[object HTMLImageElement]"===a(m))d.element=m,d.width=m.naturalWidth,d.height=m.naturalHeight,d.channels=4;else if("[object HTMLVideoElement]"===a(m))d.element=m,d.width=m.videoWidth,d.height=m.videoHeight,d.channels=4;else if(c(m)){h=d.width||m[0].length;u=d.height||m.length;p=d.channels;p=q(m[0][0])?p||m[0][0].length:p||1;z=v.shape(m);t=1;for(B=0;B<z.length;++B)t*=
z[B];t=n.allocType(36193===d.type?5126:d.type,t);v.flatten(m,z,"",t);f(d,t);d.alignment=1;d.width=h;d.height=u;d.channels=p;d.format=d.internalformat=w[p];d.needsFree=!0}}function fa(a,b,f,c,d){var g=a.element,m=a.data,e=a.internalformat,k=a.format,l=a.type,n=a.width,r=a.height;U(a);g?h.texSubImage2D(b,d,f,c,k,l,g):a.compressed?h.compressedTexSubImage2D(b,d,f,c,e,n,r,m):a.needsCopy?(t(),h.copyTexSubImage2D(b,d,f,c,a.xOffset,a.yOffset,n,r)):h.texSubImage2D(b,d,f,c,n,r,k,l,m)}function V(){return Fa.pop()||
new F}function W(a){a.needsFree&&n.freeType(a.data);F.call(a);Fa.push(a)}function Q(){D.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function M(a,b,f){var c=a.images[0]=V();a.mipmask=1;c.width=a.width=b;c.height=a.height=f;c.channels=a.channels=4}function aa(a,f){var c=null;if(b(f))c=a.images[0]=V(),O(c,a),Z(c,f),a.mipmask=1;else if(K(a,f),Array.isArray(f.mipmap))for(var d=f.mipmap,g=0;g<d.length;++g)c=a.images[g]=V(),O(c,a),c.width>>=g,c.height>>=g,Z(c,
d[g]),a.mipmask|=1<<g;else c=a.images[0]=V(),O(c,a),Z(c,f),a.mipmask=1;O(a,a.images[0])}function ka(a,b){for(var f=a.images,c=0;c<f.length&&f[c];++c){var d=f[c],g=b,m=c,e=d.element,k=d.data,l=d.internalformat,n=d.format,r=d.type,q=d.width,v=d.height;U(d);e?h.texImage2D(g,m,n,n,r,e):d.compressed?h.compressedTexImage2D(g,m,l,q,v,0,k):d.needsCopy?(t(),h.copyTexImage2D(g,m,n,d.xOffset,d.yOffset,q,v,0)):h.texImage2D(g,m,n,q,v,0,n,r,k)}}function sa(){var a=Ca.pop()||new Q;D.call(a);for(var b=a.mipmask=
0;16>b;++b)a.images[b]=null;return a}function S(a){for(var b=a.images,f=0;f<b.length;++f)b[f]&&W(b[f]),b[f]=null;Ca.push(a)}function ga(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function ia(a,b){"min"in b&&(a.minFilter=P[b.min],0<=u.indexOf(a.minFilter)&&(a.genMipmaps=!0));"mag"in b&&(a.magFilter=ea[b.mag]);var f=a.wrapS,c=a.wrapT;if("wrap"in b){var d=b.wrap;"string"===typeof d?f=c=X[d]:Array.isArray(d)&&(f=X[d[0]],
c=X[d[1]])}else"wrapS"in b&&(f=X[b.wrapS]),"wrapT"in b&&(c=X[b.wrapT]);a.wrapS=f;a.wrapT=c;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){f=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=da[b.mipmap];f=a.genMipmaps=!0;break;case "boolean":f=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,f=!0}!f||"min"in b||(a.minFilter=9984)}}function na(a,b){h.texParameteri(b,10241,a.minFilter);h.texParameteri(b,10240,a.magFilter);h.texParameteri(b,10242,a.wrapS);h.texParameteri(b,
10243,a.wrapT);p.ext_texture_filter_anisotropic&&h.texParameteri(b,34046,a.anisotropic);a.genMipmaps&&(h.hint(33170,a.mipmapHint),h.generateMipmap(b))}function oa(a){D.call(this);this.mipmask=0;this.internalformat=6408;this.id=ta++;this.refCount=1;this.target=a;this.texture=h.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new ga;J.profile&&(this.stats={size:0})}function ca(a){h.activeTexture(33984);h.bindTexture(a.target,a.texture)}function ha(){var a=la[0];a?h.bindTexture(a.target,a.texture):
h.bindTexture(3553,null)}function ja(a){var b=a.texture,f=a.unit,c=a.target;0<=f&&(h.activeTexture(33984+f),h.bindTexture(c,null),la[f]=null);h.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete ba[a.id];A.textureCount--}var da={"don't care":4352,"dont care":4352,nice:4354,fast:4353},X={repeat:10497,clamp:33071,mirror:33648},ea={nearest:9728,linear:9729},P=g({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},
ea),ma={none:0,browser:37444},T={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Y={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},R={};p.ext_srgb&&(Y.srgb=35904,Y.srgba=35906);p.oes_texture_float&&(T.float32=T["float"]=5126);p.oes_texture_half_float&&(T.float16=T["half float"]=36193);p.webgl_depth_texture&&(g(Y,{depth:6402,"depth stencil":34041}),g(T,{uint16:5123,uint32:5125,"depth stencil":34042}));p.webgl_compressed_texture_s3tc&&
g(R,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});p.webgl_compressed_texture_atc&&g(R,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});p.webgl_compressed_texture_pvrtc&&g(R,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});p.webgl_compressed_texture_etc1&&(R["rgb etc1"]=36196);var za=Array.prototype.slice.call(h.getParameter(34467));Object.keys(R).forEach(function(a){var b=
R[a];0<=za.indexOf(b)&&(Y[a]=b)});var wa=Object.keys(Y);z.textureFormats=wa;var xa=[];Object.keys(Y).forEach(function(a){xa[Y[a]]=a});var Aa=[];Object.keys(T).forEach(function(a){Aa[T[a]]=a});var Ba=[];Object.keys(ea).forEach(function(a){Ba[ea[a]]=a});var ua=[];Object.keys(P).forEach(function(a){ua[P[a]]=a});var va=[];Object.keys(X).forEach(function(a){va[X[a]]=a});var Ga=wa.reduce(function(a,b){var f=Y[b];6409===f||6406===f||6409===f||6410===f||6402===f||34041===f?a[f]=f:32855===f||0<=b.indexOf("rgba")?
a[f]=6408:a[f]=6407;return a},{}),Fa=[],Ca=[],ta=0,ba={},pa=z.maxTextureUnits,la=Array(pa).map(function(){return null});g(oa.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<pa;++b){var f=la[b];if(f){if(0<f.bindCount)continue;f.unit=-1}la[b]=this;a=b;break}J.profile&&A.maxTextureUnits<a+1&&(A.maxTextureUnits=a+1);this.unit=a;h.activeTexture(33984+a);h.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&
ja(this)}});J.profile&&(A.getTotalTextureSize=function(){var a=0;Object.keys(ba).forEach(function(b){a+=ba[b].stats.size});return a});return{create2D:function(a,b){function f(a,b){var g=c.texInfo;ga.call(g);var m=sa();"number"===typeof a?"number"===typeof b?M(m,a|0,b|0):M(m,a|0,a|0):a?(ia(g,a),aa(m,a)):M(m,1,1);g.genMipmaps&&(m.mipmask=(m.width<<1)-1);c.mipmask=m.mipmask;O(c,m);c.internalformat=m.internalformat;f.width=m.width;f.height=m.height;ca(c);ka(m,3553);na(g,3553);ha();S(m);J.profile&&(c.stats.size=
d(c.internalformat,c.type,m.width,m.height,g.genMipmaps,!1));f.format=xa[c.internalformat];f.type=Aa[c.type];f.mag=Ba[g.magFilter];f.min=ua[g.minFilter];f.wrapS=va[g.wrapS];f.wrapT=va[g.wrapT];return f}var c=new oa(3553);ba[c.id]=c;A.textureCount++;f(a,b);f.subimage=function(a,b,d,g){b|=0;d|=0;g|=0;var m=V();O(m,c);m.width=0;m.height=0;Z(m,a);m.width=m.width||(c.width>>g)-b;m.height=m.height||(c.height>>g)-d;ca(c);fa(m,3553,b,d,g);ha();W(m);return f};f.resize=function(a,b){var g=a|0,m=b|0||g;if(g===
c.width&&m===c.height)return f;f.width=c.width=g;f.height=c.height=m;ca(c);for(var e=0;c.mipmask>>e;++e)h.texImage2D(3553,e,c.format,g>>e,m>>e,0,c.format,c.type,null);ha();J.profile&&(c.stats.size=d(c.internalformat,c.type,g,m,!1,!1));return f};f._reglType="texture2d";f._texture=c;J.profile&&(f.stats=c.stats);f.destroy=function(){c.decRef()};return f},createCube:function(a,b,f,c,g,m){function e(a,b,f,c,g,m){var n,r=k.texInfo;ga.call(r);for(n=0;6>n;++n)l[n]=sa();if("number"===typeof a||!a)for(a=a|
0||1,n=0;6>n;++n)M(l[n],a,a);else if("object"===typeof a)if(b)aa(l[0],a),aa(l[1],b),aa(l[2],f),aa(l[3],c),aa(l[4],g),aa(l[5],m);else if(ia(r,a),K(k,a),"faces"in a)for(a=a.faces,n=0;6>n;++n)O(l[n],k),aa(l[n],a[n]);else for(n=0;6>n;++n)aa(l[n],a);O(k,l[0]);k.mipmask=r.genMipmaps?(l[0].width<<1)-1:l[0].mipmask;k.internalformat=l[0].internalformat;e.width=l[0].width;e.height=l[0].height;ca(k);for(n=0;6>n;++n)ka(l[n],34069+n);na(r,34067);ha();J.profile&&(k.stats.size=d(k.internalformat,k.type,e.width,
e.height,r.genMipmaps,!0));e.format=xa[k.internalformat];e.type=Aa[k.type];e.mag=Ba[r.magFilter];e.min=ua[r.minFilter];e.wrapS=va[r.wrapS];e.wrapT=va[r.wrapT];for(n=0;6>n;++n)S(l[n]);return e}var k=new oa(34067);ba[k.id]=k;A.cubeCount++;var l=Array(6);e(a,b,f,c,g,m);e.subimage=function(a,b,f,c,d){f|=0;c|=0;d|=0;var g=V();O(g,k);g.width=0;g.height=0;Z(g,b);g.width=g.width||(k.width>>d)-f;g.height=g.height||(k.height>>d)-c;ca(k);fa(g,34069+a,f,c,d);ha();W(g);return e};e.resize=function(a){a|=0;if(a!==
k.width){e.width=k.width=a;e.height=k.height=a;ca(k);for(var b=0;6>b;++b)for(var f=0;k.mipmask>>f;++f)h.texImage2D(34069+b,f,k.format,a>>f,a>>f,0,k.format,k.type,null);ha();J.profile&&(k.stats.size=d(k.internalformat,k.type,e.width,e.height,!1,!0));return e}};e._reglType="textureCube";e._texture=k;J.profile&&(e.stats=k.stats);e.destroy=function(){k.decRef()};return e},clear:function(){for(var a=0;a<pa;++a)h.activeTexture(33984+a),h.bindTexture(3553,null),la[a]=null;m(ba).forEach(ja);A.cubeCount=0;
A.textureCount=0},getTexture:function(a){return null},restore:function(){m(ba).forEach(function(a){a.texture=h.createTexture();h.bindTexture(a.target,a.texture);for(var b=0;32>b;++b)if(0!==(a.mipmask&1<<b))if(3553===a.target)h.texImage2D(3553,b,a.internalformat,a.width>>b,a.height>>b,0,a.internalformat,a.type,null);else for(var f=0;6>f;++f)h.texImage2D(34069+f,b,a.internalformat,a.width>>b,a.height>>b,0,a.internalformat,a.type,null);na(a.texInfo,a.target)})}}}},{"./constants/arraytypes.json":4,"./util/extend":23,
"./util/flatten":24,"./util/is-array-like":25,"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/pool":29,"./util/to-half-float":31,"./util/values":32}],20:[function(h,p,t){p.exports=function(e,c){function a(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function b(b,f,c){var d=m.pop()||new a;d.startQueryIndex=b;d.endQueryIndex=f;d.sum=0;d.stats=c;k.push(d)}var f=c.ext_disjoint_timer_query;if(!f)return null;var d=[],g=[],m=[],k=[],l=[],n=[];return{beginQuery:function(a){var c=
d.pop()||f.createQueryEXT();f.beginQueryEXT(35007,c);g.push(c);b(g.length-1,g.length,a)},endQuery:function(){f.endQueryEXT(35007)},pushScopeStats:b,update:function(){var a,b;a=g.length;if(0!==a){n.length=Math.max(n.length,a+1);l.length=Math.max(l.length,a+1);l[0]=0;var c=n[0]=0;for(b=a=0;b<g.length;++b){var e=g[b];f.getQueryObjectEXT(e,34919)?(c+=f.getQueryObjectEXT(e,34918),d.push(e)):g[a++]=e;l[b+1]=c;n[b+1]=a}g.length=a;for(b=a=0;b<k.length;++b){var c=k[b],h=c.startQueryIndex,e=c.endQueryIndex;
c.sum+=l[e]-l[h];h=n[h];e=n[e];e===h?(c.stats.gpuTime+=c.sum/1E6,m.push(c)):(c.startQueryIndex=h,c.endQueryIndex=e,k[a++]=c)}k.length=a}},getNumPendingQueries:function(){return g.length},clear:function(){d.push.apply(d,g);for(var a=0;a<d.length;a++)f.deleteQueryEXT(d[a]);g.length=0;d.length=0},restore:function(){g.length=0;d.length=0}}}},{}],21:[function(h,p,t){p.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(h,
p,t){function e(a){return Array.prototype.slice.call(a)}function c(a){return e(a).join("")}var a=h("./extend");p.exports=function(){function b(){var b=[],f=[];return a(function(){b.push.apply(b,e(arguments))},{def:function(){var a="v"+d++;f.push(a);0<arguments.length&&(b.push(a,"="),b.push.apply(b,e(arguments)),b.push(";"));return a},toString:function(){return c([0<f.length?"var "+f+";":"",c(b)])}})}function f(){function f(a,b){d(a,b,"=",c.def(a,b),";")}var c=b(),d=b(),g=c.toString,m=d.toString;return a(function(){c.apply(c,
e(arguments))},{def:c.def,entry:c,exit:d,save:f,set:function(a,b,d){f(a,b);c(a,b,"=",d,";")},toString:function(){return g()+m()}})}var d=0,g=[],m=[],k=b(),l={};return{global:k,link:function(a){for(var b=0;b<m.length;++b)if(m[b]===a)return g[b];b="g"+d++;g.push(b);m.push(a);return b},block:b,proc:function(b,d){function g(){var a="a"+m.length;m.push(a);return a}var m=[];d=d||0;for(var e=0;e<d;++e)g();var e=f(),k=e.toString;return l[b]=a(e,{arg:g,toString:function(){return c(["function(",m.join(),"){",
k(),"}"])}})},scope:f,cond:function(){var b=c(arguments),d=f(),g=f(),m=d.toString,k=g.toString;return a(d,{then:function(){d.apply(d,e(arguments));return this},"else":function(){g.apply(g,e(arguments));return this},toString:function(){var a=k();a&&(a="else{"+a+"}");return c(["if(",b,"){",m(),"}",a])}})},compile:function(){var a=['"use strict";',k,"return {"];Object.keys(l).forEach(function(b){a.push('"',b,'":',l[b].toString(),",")});a.push("}");var b=c(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,
"{\n");return Function.apply(null,g.concat(b)).apply(null,m)}}}},{"./extend":23}],23:[function(h,p,t){p.exports=function(e,c){for(var a=Object.keys(c),b=0;b<a.length;++b)e[a[b]]=c[a[b]];return e}},{}],24:[function(h,p,t){function e(a,f,c,g,m,e){for(var l=0;l<f;++l)for(var n=a[l],r=0;r<c;++r)for(var h=n[r],v=0;v<g;++v)m[e++]=h[v]}function c(a,f,d,g,m){for(var k=1,l=d+1;l<f.length;++l)k*=f[l];var n=f[d];if(4===f.length-d){var r=f[d+1],h=f[d+2];f=f[d+3];for(l=0;l<n;++l)e(a[l],r,h,f,g,m),m+=k}else for(l=
0;l<n;++l)c(a[l],f,d+1,g,m),m+=k}var a=h("./pool");p.exports={shape:function(a){for(var f=[];a.length;a=a[0])f.push(a.length);return f},flatten:function(b,f,d,g){var m=1;if(f.length)for(var k=0;k<f.length;++k)m*=f[k];else m=0;d=g||a.allocType(d,m);switch(f.length){case 0:break;case 1:g=f[0];for(f=0;f<g;++f)d[f]=b[f];break;case 2:g=f[0];f=f[1];for(k=m=0;k<g;++k)for(var l=b[k],n=0;n<f;++n)d[m++]=l[n];break;case 3:e(b,f[0],f[1],f[2],d,0);break;default:c(b,f,0,d,0)}return d}}},{"./pool":29}],25:[function(h,
p,t){var e=h("./is-typed-array");p.exports=function(c){return Array.isArray(c)||e(c)}},{"./is-typed-array":27}],26:[function(h,p,t){var e=h("./is-typed-array");p.exports=function(c){return!!c&&"object"===typeof c&&Array.isArray(c.shape)&&Array.isArray(c.stride)&&"number"===typeof c.offset&&c.shape.length===c.stride.length&&(Array.isArray(c.data)||e(c.data))}},{"./is-typed-array":27}],27:[function(h,p,t){var e=h("../constants/arraytypes.json");p.exports=function(c){return Object.prototype.toString.call(c)in
e}},{"../constants/arraytypes.json":4}],28:[function(h,p,t){p.exports=function(e,c){for(var a=Array(e),b=0;b<e;++b)a[b]=c(b);return a}},{}],29:[function(h,p,t){function e(a){var b,c;b=(65535<a)<<4;a>>>=b;c=(255<a)<<3;a>>>=c;b|=c;c=(15<a)<<2;a>>>=c;b|=c;c=(3<a)<<1;return b|c|a>>>c>>1}function c(a){a:{for(var c=16;268435456>=c;c*=16)if(a<=c){a=c;break a}a=0}c=b[e(a)>>2];return 0<c.length?c.pop():new ArrayBuffer(a)}function a(a){b[e(a.byteLength)>>2].push(a)}var b=h("./loop")(8,function(){return[]});
p.exports={alloc:c,free:a,allocType:function(a,b){var g=null;switch(a){case 5120:g=new Int8Array(c(b),0,b);break;case 5121:g=new Uint8Array(c(b),0,b);break;case 5122:g=new Int16Array(c(2*b),0,b);break;case 5123:g=new Uint16Array(c(2*b),0,b);break;case 5124:g=new Int32Array(c(4*b),0,b);break;case 5125:g=new Uint32Array(c(4*b),0,b);break;case 5126:g=new Float32Array(c(4*b),0,b);break;default:return null}return g.length!==b?g.subarray(0,b):g},freeType:function(b){a(b.buffer)}}},{"./loop":28}],30:[function(h,
p,t){p.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(e){return requestAnimationFrame(e)},cancel:function(e){return cancelAnimationFrame(e)}}:{next:function(e){return setTimeout(e,16)},cancel:clearTimeout}},{}],31:[function(h,p,t){var e=h("./pool"),c=new Float32Array(1),a=new Uint32Array(c.buffer);p.exports=function(b){for(var f=e.allocType(5123,b.length),d=0;d<b.length;++d)if(isNaN(b[d]))f[d]=65535;else if(Infinity===b[d])f[d]=31744;else if(-Infinity===
b[d])f[d]=64512;else{c[0]=b[d];var g=a[0],m=g>>>31<<15,k=(g<<1>>>24)-127,g=g>>13&1023;f[d]=-24>k?m:-14>k?m+(g+1024>>-14-k):15<k?m+31744:m+(k+15<<10)+g}return f}},{"./pool":29}],32:[function(h,p,t){p.exports=function(e){return Object.keys(e).map(function(c){return e[c]})}},{}],33:[function(h,p,t){function e(a,b,c){function e(){var b=window.innerWidth,g=window.innerHeight;a!==document.body&&(g=a.getBoundingClientRect(),b=g.right-g.left,g=g.top-g.bottom);l.width=c*b;l.height=c*g;f(l.style,{width:b+"px",
height:g+"px"})}var l=document.createElement("canvas");f(l.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(l);a===document.body&&(l.style.position="absolute",f(a.style,{margin:0,padding:0}));window.addEventListener("resize",e,!1);e();return{canvas:l,onDestroy:function(){window.removeEventListener("resize",e);a.removeChild(l)}}}function c(a,b){function f(c){try{return a.getContext(c,b)}catch(m){return null}}return f("webgl")||f("experimental-webgl")||f("webgl-experimental")}function a(a){return"string"===
typeof a?a.split():a}function b(a){return"string"===typeof a?document.querySelector(a):a}var f=h("./util/extend");p.exports=function(f){var g=f||{},m,k,l,n;f={};var h=[],q=[],v="undefined"===typeof window?1:window.devicePixelRatio,p=!1,u=function(a){},w=function(){};"string"===typeof g?m=document.querySelector(g):"object"===typeof g&&("string"===typeof g.nodeName&&"function"===typeof g.appendChild&&"function"===typeof g.getBoundingClientRect?m=g:"function"===typeof g.drawArrays||"function"===typeof g.drawElements?
(n=g,l=n.canvas):("gl"in g?n=g.gl:"canvas"in g?l=b(g.canvas):"container"in g&&(k=b(g.container)),"attributes"in g&&(f=g.attributes),"extensions"in g&&(h=a(g.extensions)),"optionalExtensions"in g&&(q=a(g.optionalExtensions)),"onDone"in g&&(u=g.onDone),"profile"in g&&(p=!!g.profile),"pixelRatio"in g&&(v=+g.pixelRatio)));m&&("canvas"===m.nodeName.toLowerCase()?l=m:k=m);if(!n){if(!l){m=e(k||document.body,u,v);if(!m)return null;l=m.canvas;w=m.onDestroy}n=c(l,f)}return n?{gl:n,canvas:l,container:k,extensions:h,
optionalExtensions:q,pixelRatio:v,profile:p,onDone:u,onDestroy:w}:(w(),u("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/extend":23}],34:[function(h,p,t){var e=h("element-size");p.exports=function(a,b,f){function d(){var b=d.parent||a.parentNode;if("function"===typeof b)var f=b(c)||c,b=f[0],f=f[1];else b&&b!==document.body?(f=e(b),b=f[0]|0,f=f[1]|0):(b=window.innerWidth,f=window.innerHeight);g?(a.setAttribute("width",b*d.scale+"px"),a.setAttribute("height",
f*d.scale+"px")):(a.width=b*d.scale,a.height=f*d.scale);a.style.width=b+"px";a.style.height=f+"px";return d}var g="SVG"===a.nodeName.toUpperCase();a.style.position=a.style.position||"absolute";a.style.top=0;a.style.left=0;d.scale=parseFloat(f||1);d.parent=b;return d()};var c=new Float32Array(2)},{"element-size":38}],35:[function(h,p,t){var e=h("orbit-camera"),c=h("scroll-speed"),a=h("mouse-position"),b=h("mouse-pressed"),f=h("key-pressed");p.exports=function(d,g){g=g||{};g.pan=!1!==g.pan;g.scale=
!1!==g.scale;g.rotate=!1!==g.rotate;var m=c(d,g.scale),k=b(d,g.rotate),l=a(d),n=e([0,10,30],[0,0,0],[0,1,0]);n.tick=function(){var a=f("<control>")||f("<alt>"),b=f("<shift>"),c=d.height,e=d.width;g.rotate&&k.left&&!a&&!b&&n.rotate([l.x/e-.5,l.y/c-.5],[l.prevX/e-.5,l.prevY/c-.5]);(g.pan&&k.right||k.left&&a&&!b)&&n.pan([1*(l.x-l.prevX)/e,1*(l.y-l.prevY)/c]);g.scale&&m[1]&&(n.distance*=Math.exp(m[1]/c));if(g.scale&&(k.middle||k.left&&!a&&b)){a=l.y-l.prevY;if(!a)return;n.distance*=Math.exp(a/c)}m.flush();
l.flush()};return n}},{"key-pressed":74,"mouse-position":36,"mouse-pressed":37,"orbit-camera":75,"scroll-speed":78}],36:[function(h,p,t){var e=h("events/");p.exports=function(c,a){var b=new e;b.x=0;b.y=0;b.prevX=0;b.prevY=0;b.flush=function(){this.prevX=this.x;this.prevY=this.y};if("undefined"===typeof window)return b;a=a||c||window;c=c||document.body;a.addEventListener("mousemove",c===document.body||c===window?function(a){b.prevX=b.x;b.prevY=b.y;b.x=a.clientX;b.y=a.clientY;b.emit("move",a)}:function(a){b.prevX=
b.x;b.prevY=b.y;var d=c.getBoundingClientRect();b.x=a.clientX-d.left;b.y=a.clientY-d.top;b.emit("move",a)},!1);return b}},{"events/":39}],37:[function(h,p,t){var e=h("events/"),c=["left","middle","right"];p.exports=function(a,b){function f(a){g.right=!1;g[c[a.button]]=!0;g.emit("down",a);if(b){if(!a.preventDefault)return!1;a.preventDefault();a.stopPropagation()}}function d(a){g.right=!1;g[c[a.button]]=!1;g.emit("up",a);b&&a.preventDefault&&(a.preventDefault(),a.stopPropagation())}var g=new e;g.left=
!1;g.right=!1;g.middle=!1;"undefined"!==typeof window&&(a=a||window,a.addEventListener("mousedown",f,!1),a.addEventListener("mouseup",d,!1),b&&a.addEventListener("contextmenu",function(a){return a.preventDefault&&a.preventDefault()&&!1},!1));return g}},{"events/":39}],38:[function(h,p,t){function e(c){return parseFloat(c)||0}p.exports=function(c){if(c===window||c===document.body)return[window.innerWidth,window.innerHeight];if(!c.parentNode){var a=!0;document.body.appendChild(c)}var b=c.getBoundingClientRect(),
f=getComputedStyle(c),d=(b.height|0)+e(f.getPropertyValue("margin-top"))+e(f.getPropertyValue("margin-bottom")),b=(b.width|0)+e(f.getPropertyValue("margin-left"))+e(f.getPropertyValue("margin-right"));a&&document.body.removeChild(c);return[b,d]}},{}],39:[function(h,p,t){function e(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}function c(a){return"function"===typeof a}function a(a){return"object"===typeof a&&null!==a}p.exports=e;e.EventEmitter=e;e.prototype._events=
void 0;e.prototype._maxListeners=void 0;e.defaultMaxListeners=10;e.prototype.setMaxListeners=function(a){if("number"!==typeof a||0>a||isNaN(a))throw TypeError("n must be a positive number");this._maxListeners=a;return this};e.prototype.emit=function(b){var f,d,g,m;this._events||(this._events={});if("error"===b&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){f=arguments[1];if(f instanceof Error)throw f;d=Error('Uncaught, unspecified "error" event. ('+f+")");d.context=f;throw d;
}d=this._events[b];if(void 0===d)return!1;if(c(d))switch(arguments.length){case 1:d.call(this);break;case 2:d.call(this,arguments[1]);break;case 3:d.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),d.apply(this,f)}else if(a(d))for(f=Array.prototype.slice.call(arguments,1),m=d.slice(),d=m.length,g=0;g<d;g++)m[g].apply(this,f);return!0};e.prototype.addListener=function(b,f){var d;if(!c(f))throw TypeError("listener must be a function");this._events||(this._events=
{});this._events.newListener&&this.emit("newListener",b,c(f.listener)?f.listener:f);this._events[b]?a(this._events[b])?this._events[b].push(f):this._events[b]=[this._events[b],f]:this._events[b]=f;a(this._events[b])&&!this._events[b].warned&&(d=void 0!==this._maxListeners?this._maxListeners:e.defaultMaxListeners)&&0<d&&this._events[b].length>d&&(this._events[b].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
this._events[b].length),"function"===typeof console.trace&&console.trace());return this};e.prototype.on=e.prototype.addListener;e.prototype.once=function(a,f){function d(){this.removeListener(a,d);g||(g=!0,f.apply(this,arguments))}if(!c(f))throw TypeError("listener must be a function");var g=!1;d.listener=f;this.on(a,d);return this};e.prototype.removeListener=function(b,f){var d,g,m;if(!c(f))throw TypeError("listener must be a function");if(!this._events||!this._events[b])return this;d=this._events[b];
m=d.length;g=-1;if(d===f||c(d.listener)&&d.listener===f)delete this._events[b],this._events.removeListener&&this.emit("removeListener",b,f);else if(a(d)){for(;0<m--;)if(d[m]===f||d[m].listener&&d[m].listener===f){g=m;break}if(0>g)return this;1===d.length?(d.length=0,delete this._events[b]):d.splice(g,1);this._events.removeListener&&this.emit("removeListener",b,f)}return this};e.prototype.removeAllListeners=function(a){var f;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?
this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(f in this._events)"removeListener"!==f&&this.removeAllListeners(f);this.removeAllListeners("removeListener");this._events={};return this}f=this._events[a];if(c(f))this.removeListener(a,f);else if(f)for(;f.length;)this.removeListener(a,f[f.length-1]);delete this._events[a];return this};e.prototype.listeners=function(a){return this._events&&this._events[a]?c(this._events[a])?[this._events[a]]:this._events[a].slice():
[]};e.prototype.listenerCount=function(a){if(this._events){a=this._events[a];if(c(a))return 1;if(a)return a.length}return 0};e.listenerCount=function(a,f){return a.listenerCount(f)}},{}],40:[function(h,p,t){p.exports=function(e,c){var a=c[0],b=c[1],f=c[2],d=c[3],g=c[4],m=c[5],k=c[6],l=c[7],n=c[8],h=c[9],q=c[10],v=c[11],p=c[12],u=c[13],w=c[14],x=c[15];e[0]=m*(q*x-v*w)-h*(k*x-l*w)+u*(k*v-l*q);e[1]=-(b*(q*x-v*w)-h*(f*x-d*w)+u*(f*v-d*q));e[2]=b*(k*x-l*w)-m*(f*x-d*w)+u*(f*l-d*k);e[3]=-(b*(k*v-l*q)-m*(f*
v-d*q)+h*(f*l-d*k));e[4]=-(g*(q*x-v*w)-n*(k*x-l*w)+p*(k*v-l*q));e[5]=a*(q*x-v*w)-n*(f*x-d*w)+p*(f*v-d*q);e[6]=-(a*(k*x-l*w)-g*(f*x-d*w)+p*(f*l-d*k));e[7]=a*(k*v-l*q)-g*(f*v-d*q)+n*(f*l-d*k);e[8]=g*(h*x-v*u)-n*(m*x-l*u)+p*(m*v-l*h);e[9]=-(a*(h*x-v*u)-n*(b*x-d*u)+p*(b*v-d*h));e[10]=a*(m*x-l*u)-g*(b*x-d*u)+p*(b*l-d*m);e[11]=-(a*(m*v-l*h)-g*(b*v-d*h)+n*(b*l-d*m));e[12]=-(g*(h*w-q*u)-n*(m*w-k*u)+p*(m*q-k*h));e[13]=a*(h*w-q*u)-n*(b*w-f*u)+p*(b*q-f*h);e[14]=-(a*(m*w-k*u)-g*(b*w-f*u)+p*(b*k-f*m));e[15]=a*
(m*q-k*h)-g*(b*q-f*h)+n*(b*k-f*m);return e}},{}],41:[function(h,p,t){p.exports=function(e){var c=new Float32Array(16);c[0]=e[0];c[1]=e[1];c[2]=e[2];c[3]=e[3];c[4]=e[4];c[5]=e[5];c[6]=e[6];c[7]=e[7];c[8]=e[8];c[9]=e[9];c[10]=e[10];c[11]=e[11];c[12]=e[12];c[13]=e[13];c[14]=e[14];c[15]=e[15];return c}},{}],42:[function(h,p,t){p.exports=function(e,c){e[0]=c[0];e[1]=c[1];e[2]=c[2];e[3]=c[3];e[4]=c[4];e[5]=c[5];e[6]=c[6];e[7]=c[7];e[8]=c[8];e[9]=c[9];e[10]=c[10];e[11]=c[11];e[12]=c[12];e[13]=c[13];e[14]=
c[14];e[15]=c[15];return e}},{}],43:[function(h,p,t){p.exports=function(){var e=new Float32Array(16);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],44:[function(h,p,t){p.exports=function(e){var c=e[0],a=e[1],b=e[2],f=e[3],d=e[4],g=e[5],m=e[6],k=e[7],l=e[8],n=e[9],h=e[10],q=e[11],v=e[12],p=e[13],u=e[14];e=e[15];return(c*g-a*d)*(h*e-q*u)-(c*m-b*d)*(n*e-q*p)+(c*k-f*d)*(n*u-h*p)+(a*m-b*g)*(l*e-q*v)-(a*k-f*g)*(l*u-h*
v)+(b*k-f*m)*(l*p-n*v)}},{}],45:[function(h,p,t){p.exports=function(e,c){var a=c[0],b=c[1],f=c[2],d=c[3],g=a+a,m=b+b,k=f+f,a=a*g,l=b*g,b=b*m,n=f*g,h=f*m,f=f*k,g=d*g,m=d*m,d=d*k;e[0]=1-b-f;e[1]=l+d;e[2]=n-m;e[3]=0;e[4]=l-d;e[5]=1-a-f;e[6]=h+g;e[7]=0;e[8]=n+m;e[9]=h-g;e[10]=1-a-b;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],46:[function(h,p,t){p.exports=function(e,c,a){var b=c[0],f=c[1],d=c[2],g=c[3],m=b+b,k=f+f,l=d+d;c=b*m;var n=b*k,b=b*l,h=f*k,f=f*l,d=d*l,m=g*m,k=g*k,g=g*l;e[0]=1-(h+d);
e[1]=n+g;e[2]=b-k;e[3]=0;e[4]=n-g;e[5]=1-(c+d);e[6]=f+m;e[7]=0;e[8]=b+k;e[9]=f-m;e[10]=1-(c+h);e[11]=0;e[12]=a[0];e[13]=a[1];e[14]=a[2];e[15]=1;return e}},{}],47:[function(h,p,t){p.exports=function(e,c,a,b,f,d,g){var m=1/(a-c),k=1/(f-b),l=1/(d-g);e[0]=2*d*m;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=2*d*k;e[6]=0;e[7]=0;e[8]=(a+c)*m;e[9]=(f+b)*k;e[10]=(g+d)*l;e[11]=-1;e[12]=0;e[13]=0;e[14]=g*d*2*l;e[15]=0;return e}},{}],48:[function(h,p,t){p.exports=function(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=
0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],49:[function(h,p,t){p.exports={create:h("./create"),clone:h("./clone"),copy:h("./copy"),identity:h("./identity"),transpose:h("./transpose"),invert:h("./invert"),adjoint:h("./adjoint"),determinant:h("./determinant"),multiply:h("./multiply"),translate:h("./translate"),scale:h("./scale"),rotate:h("./rotate"),rotateX:h("./rotateX"),rotateY:h("./rotateY"),rotateZ:h("./rotateZ"),fromRotationTranslation:h("./fromRotationTranslation"),
fromQuat:h("./fromQuat"),frustum:h("./frustum"),perspective:h("./perspective"),perspectiveFromFieldOfView:h("./perspectiveFromFieldOfView"),ortho:h("./ortho"),lookAt:h("./lookAt"),str:h("./str")}},{"./adjoint":40,"./clone":41,"./copy":42,"./create":43,"./determinant":44,"./fromQuat":45,"./fromRotationTranslation":46,"./frustum":47,"./identity":48,"./invert":50,"./lookAt":51,"./multiply":52,"./ortho":53,"./perspective":54,"./perspectiveFromFieldOfView":55,"./rotate":56,"./rotateX":57,"./rotateY":58,
"./rotateZ":59,"./scale":60,"./str":61,"./translate":62,"./transpose":63}],50:[function(h,p,t){p.exports=function(e,c){var a=c[0],b=c[1],f=c[2],d=c[3],g=c[4],m=c[5],k=c[6],l=c[7],n=c[8],h=c[9],q=c[10],v=c[11],p=c[12],u=c[13],w=c[14],x=c[15],t=a*m-b*g,A=a*k-f*g,z=a*l-d*g,B=b*k-f*m,C=b*l-d*m,E=f*l-d*k,N=n*u-h*p,L=n*w-q*p,G=n*x-v*p,J=h*w-q*u,D=h*x-v*u,O=q*x-v*w,K=t*O-A*D+z*J+B*G-C*L+E*N;if(!K)return null;K=1/K;e[0]=(m*O-k*D+l*J)*K;e[1]=(f*D-b*O-d*J)*K;e[2]=(u*E-w*C+x*B)*K;e[3]=(q*C-h*E-v*B)*K;e[4]=(k*
G-g*O-l*L)*K;e[5]=(a*O-f*G+d*L)*K;e[6]=(w*z-p*E-x*A)*K;e[7]=(n*E-q*z+v*A)*K;e[8]=(g*D-m*G+l*N)*K;e[9]=(b*G-a*D-d*N)*K;e[10]=(p*C-u*z+x*t)*K;e[11]=(h*z-n*C-v*t)*K;e[12]=(m*L-g*J-k*N)*K;e[13]=(a*J-b*L+f*N)*K;e[14]=(u*A-p*B-w*t)*K;e[15]=(n*B-h*A+q*t)*K;return e}},{}],51:[function(h,p,t){var e=h("./identity");p.exports=function(c,a,b,f){var d,g,m,k,l,n,h,q,v=a[0],p=a[1];a=a[2];m=f[0];k=f[1];g=f[2];h=b[0];f=b[1];d=b[2];if(1E-6>Math.abs(v-h)&&1E-6>Math.abs(p-f)&&1E-6>Math.abs(a-d))return e(c);b=v-h;f=p-
f;h=a-d;q=1/Math.sqrt(b*b+f*f+h*h);b*=q;f*=q;h*=q;d=k*h-g*f;g=g*b-m*h;m=m*f-k*b;(q=Math.sqrt(d*d+g*g+m*m))?(q=1/q,d*=q,g*=q,m*=q):m=g=d=0;k=f*m-h*g;l=h*d-b*m;n=b*g-f*d;(q=Math.sqrt(k*k+l*l+n*n))?(q=1/q,k*=q,l*=q,n*=q):n=l=k=0;c[0]=d;c[1]=k;c[2]=b;c[3]=0;c[4]=g;c[5]=l;c[6]=f;c[7]=0;c[8]=m;c[9]=n;c[10]=h;c[11]=0;c[12]=-(d*v+g*p+m*a);c[13]=-(k*v+l*p+n*a);c[14]=-(b*v+f*p+h*a);c[15]=1;return c}},{"./identity":48}],52:[function(h,p,t){p.exports=function(e,c,a){var b=c[0],f=c[1],d=c[2],g=c[3],m=c[4],k=c[5],
l=c[6],n=c[7],h=c[8],q=c[9],v=c[10],p=c[11],u=c[12],w=c[13],t=c[14];c=c[15];var y=a[0],A=a[1],z=a[2],B=a[3];e[0]=y*b+A*m+z*h+B*u;e[1]=y*f+A*k+z*q+B*w;e[2]=y*d+A*l+z*v+B*t;e[3]=y*g+A*n+z*p+B*c;y=a[4];A=a[5];z=a[6];B=a[7];e[4]=y*b+A*m+z*h+B*u;e[5]=y*f+A*k+z*q+B*w;e[6]=y*d+A*l+z*v+B*t;e[7]=y*g+A*n+z*p+B*c;y=a[8];A=a[9];z=a[10];B=a[11];e[8]=y*b+A*m+z*h+B*u;e[9]=y*f+A*k+z*q+B*w;e[10]=y*d+A*l+z*v+B*t;e[11]=y*g+A*n+z*p+B*c;y=a[12];A=a[13];z=a[14];B=a[15];e[12]=y*b+A*m+z*h+B*u;e[13]=y*f+A*k+z*q+B*w;e[14]=
y*d+A*l+z*v+B*t;e[15]=y*g+A*n+z*p+B*c;return e}},{}],53:[function(h,p,t){p.exports=function(e,c,a,b,f,d,g){var m=1/(c-a),k=1/(b-f),l=1/(d-g);e[0]=-2*m;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=-2*k;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=2*l;e[11]=0;e[12]=(c+a)*m;e[13]=(f+b)*k;e[14]=(g+d)*l;e[15]=1;return e}},{}],54:[function(h,p,t){p.exports=function(e,c,a,b,f){c=1/Math.tan(c/2);var d=1/(b-f);e[0]=c/a;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=c;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=(f+b)*d;e[11]=-1;e[12]=0;e[13]=0;e[14]=2*
f*b*d;e[15]=0;return e}},{}],55:[function(h,p,t){p.exports=function(e,c,a,b){var f=Math.tan(c.upDegrees*Math.PI/180),d=Math.tan(c.downDegrees*Math.PI/180),g=Math.tan(c.leftDegrees*Math.PI/180);c=Math.tan(c.rightDegrees*Math.PI/180);var m=2/(g+c),k=2/(f+d);e[0]=m;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=k;e[6]=0;e[7]=0;e[8]=-((g-c)*m*.5);e[9]=(f-d)*k*.5;e[10]=b/(a-b);e[11]=-1;e[12]=0;e[13]=0;e[14]=b*a/(a-b);e[15]=0;return e}},{}],56:[function(h,p,t){p.exports=function(e,c,a,b){var f=b[0],d=b[1];b=b[2];var g=
Math.sqrt(f*f+d*d+b*b),m,k,l,n,h,q,v,p,u,w,t,y,A,z,B,C,E,N,L,G;if(1E-6>Math.abs(g))return null;g=1/g;f*=g;d*=g;b*=g;m=Math.sin(a);k=Math.cos(a);l=1-k;a=c[0];g=c[1];n=c[2];h=c[3];q=c[4];v=c[5];p=c[6];u=c[7];w=c[8];t=c[9];y=c[10];A=c[11];z=f*f*l+k;B=d*f*l+b*m;C=b*f*l-d*m;E=f*d*l-b*m;N=d*d*l+k;L=b*d*l+f*m;G=f*b*l+d*m;f=d*b*l-f*m;d=b*b*l+k;e[0]=a*z+q*B+w*C;e[1]=g*z+v*B+t*C;e[2]=n*z+p*B+y*C;e[3]=h*z+u*B+A*C;e[4]=a*E+q*N+w*L;e[5]=g*E+v*N+t*L;e[6]=n*E+p*N+y*L;e[7]=h*E+u*N+A*L;e[8]=a*G+q*f+w*d;e[9]=g*G+v*
f+t*d;e[10]=n*G+p*f+y*d;e[11]=h*G+u*f+A*d;c!==e&&(e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15]);return e}},{}],57:[function(h,p,t){p.exports=function(e,c,a){var b=Math.sin(a);a=Math.cos(a);var f=c[4],d=c[5],g=c[6],m=c[7],k=c[8],l=c[9],n=c[10],h=c[11];c!==e&&(e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=c[3],e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15]);e[4]=f*a+k*b;e[5]=d*a+l*b;e[6]=g*a+n*b;e[7]=m*a+h*b;e[8]=k*a-f*b;e[9]=l*a-d*b;e[10]=n*a-g*b;e[11]=h*a-m*b;return e}},{}],58:[function(h,p,t){p.exports=
function(e,c,a){var b=Math.sin(a);a=Math.cos(a);var f=c[0],d=c[1],g=c[2],m=c[3],k=c[8],l=c[9],n=c[10],h=c[11];c!==e&&(e[4]=c[4],e[5]=c[5],e[6]=c[6],e[7]=c[7],e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15]);e[0]=f*a-k*b;e[1]=d*a-l*b;e[2]=g*a-n*b;e[3]=m*a-h*b;e[8]=f*b+k*a;e[9]=d*b+l*a;e[10]=g*b+n*a;e[11]=m*b+h*a;return e}},{}],59:[function(h,p,t){p.exports=function(e,c,a){var b=Math.sin(a);a=Math.cos(a);var f=c[0],d=c[1],g=c[2],m=c[3],k=c[4],l=c[5],n=c[6],h=c[7];c!==e&&(e[8]=c[8],e[9]=c[9],e[10]=c[10],
e[11]=c[11],e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15]);e[0]=f*a+k*b;e[1]=d*a+l*b;e[2]=g*a+n*b;e[3]=m*a+h*b;e[4]=k*a-f*b;e[5]=l*a-d*b;e[6]=n*a-g*b;e[7]=h*a-m*b;return e}},{}],60:[function(h,p,t){p.exports=function(e,c,a){var b=a[0],f=a[1];a=a[2];e[0]=c[0]*b;e[1]=c[1]*b;e[2]=c[2]*b;e[3]=c[3]*b;e[4]=c[4]*f;e[5]=c[5]*f;e[6]=c[6]*f;e[7]=c[7]*f;e[8]=c[8]*a;e[9]=c[9]*a;e[10]=c[10]*a;e[11]=c[11]*a;e[12]=c[12];e[13]=c[13];e[14]=c[14];e[15]=c[15];return e}},{}],61:[function(h,p,t){p.exports=function(e){return"mat4("+
e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}},{}],62:[function(h,p,t){p.exports=function(e,c,a){var b=a[0],f=a[1];a=a[2];var d,g,m,k,l,n,h,q,v,p,u,w;c===e?(e[12]=c[0]*b+c[4]*f+c[8]*a+c[12],e[13]=c[1]*b+c[5]*f+c[9]*a+c[13],e[14]=c[2]*b+c[6]*f+c[10]*a+c[14],e[15]=c[3]*b+c[7]*f+c[11]*a+c[15]):(d=c[0],g=c[1],m=c[2],k=c[3],l=c[4],n=c[5],h=c[6],q=c[7],v=c[8],p=c[9],u=c[10],w=c[11],e[0]=
d,e[1]=g,e[2]=m,e[3]=k,e[4]=l,e[5]=n,e[6]=h,e[7]=q,e[8]=v,e[9]=p,e[10]=u,e[11]=w,e[12]=d*b+l*f+v*a+c[12],e[13]=g*b+n*f+p*a+c[13],e[14]=m*b+h*f+u*a+c[14],e[15]=k*b+q*f+w*a+c[15]);return e}},{}],63:[function(h,p,t){p.exports=function(e,c){if(e===c){var a=c[1],b=c[2],f=c[3],d=c[6],g=c[7],m=c[11];e[1]=c[4];e[2]=c[8];e[3]=c[12];e[4]=a;e[6]=c[9];e[7]=c[13];e[8]=b;e[9]=d;e[11]=c[14];e[12]=f;e[13]=g;e[14]=m}else e[0]=c[0],e[1]=c[4],e[2]=c[8],e[3]=c[12],e[4]=c[1],e[5]=c[5],e[6]=c[9],e[7]=c[13],e[8]=c[2],e[9]=
c[6],e[10]=c[10],e[11]=c[14],e[12]=c[3],e[13]=c[7],e[14]=c[11],e[15]=c[15];return e}},{}],64:[function(h,p,t){t.glMatrix=h("./gl-matrix/common.js");t.mat2=h("./gl-matrix/mat2.js");t.mat2d=h("./gl-matrix/mat2d.js");t.mat3=h("./gl-matrix/mat3.js");t.mat4=h("./gl-matrix/mat4.js");t.quat=h("./gl-matrix/quat.js");t.vec2=h("./gl-matrix/vec2.js");t.vec3=h("./gl-matrix/vec3.js");t.vec4=h("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":65,"./gl-matrix/mat2.js":66,"./gl-matrix/mat2d.js":67,"./gl-matrix/mat3.js":68,
"./gl-matrix/mat4.js":69,"./gl-matrix/quat.js":70,"./gl-matrix/vec2.js":71,"./gl-matrix/vec3.js":72,"./gl-matrix/vec4.js":73}],65:[function(h,p,t){var e={EPSILON:1E-6};e.ARRAY_TYPE="undefined"!==typeof Float32Array?Float32Array:Array;e.RANDOM=Math.random;e.ENABLE_SIMD=!1;e.SIMD_AVAILABLE=e.ARRAY_TYPE===Float32Array&&"SIMD"in this;e.USE_SIMD=e.ENABLE_SIMD&&e.SIMD_AVAILABLE;e.setMatrixArrayType=function(a){e.ARRAY_TYPE=a};var c=Math.PI/180;e.toRadian=function(a){return a*c};e.equals=function(a,b){return Math.abs(a-
b)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};p.exports=e},{}],66:[function(h,p,t){var e=h("./common.js");h={create:function(){var c=new e.ARRAY_TYPE(4);c[0]=1;c[1]=0;c[2]=0;c[3]=1;return c},clone:function(c){var a=new e.ARRAY_TYPE(4);a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];return a},copy:function(c,a){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c},identity:function(c){c[0]=1;c[1]=0;c[2]=0;c[3]=1;return c},fromValues:function(c,a,b,f){var d=new e.ARRAY_TYPE(4);d[0]=c;d[1]=a;d[2]=b;d[3]=f;
return d},set:function(c,a,b,f,d){c[0]=a;c[1]=b;c[2]=f;c[3]=d;return c},transpose:function(c,a){if(c===a){var b=a[1];c[1]=a[2];c[2]=b}else c[0]=a[0],c[1]=a[2],c[2]=a[1],c[3]=a[3];return c},invert:function(c,a){var b=a[0],f=a[1],d=a[2],g=a[3],m=b*g-d*f;if(!m)return null;m=1/m;c[0]=g*m;c[1]=-f*m;c[2]=-d*m;c[3]=b*m;return c},adjoint:function(c,a){var b=a[0];c[0]=a[3];c[1]=-a[1];c[2]=-a[2];c[3]=b;return c},determinant:function(c){return c[0]*c[3]-c[2]*c[1]},multiply:function(c,a,b){var f=a[0],d=a[1],
g=a[2];a=a[3];var m=b[0],e=b[1],l=b[2];b=b[3];c[0]=f*m+g*e;c[1]=d*m+a*e;c[2]=f*l+g*b;c[3]=d*l+a*b;return c}};h.mul=h.multiply;h.rotate=function(c,a,b){var f=a[0],d=a[1],g=a[2];a=a[3];var m=Math.sin(b);b=Math.cos(b);c[0]=f*b+g*m;c[1]=d*b+a*m;c[2]=f*-m+g*b;c[3]=d*-m+a*b;return c};h.scale=function(c,a,b){var f=a[1],d=a[2],g=a[3],m=b[0];b=b[1];c[0]=a[0]*m;c[1]=f*m;c[2]=d*b;c[3]=g*b;return c};h.fromRotation=function(c,a){var b=Math.sin(a),f=Math.cos(a);c[0]=f;c[1]=b;c[2]=-b;c[3]=f;return c};h.fromScaling=
function(c,a){c[0]=a[0];c[1]=0;c[2]=0;c[3]=a[1];return c};h.str=function(c){return"mat2("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+")"};h.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2))};h.LDU=function(c,a,b,f){c[2]=f[2]/f[0];b[0]=f[0];b[1]=f[1];b[3]=f[3]-c[2]*b[1];return[c,a,b]};h.add=function(c,a,b){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c};h.subtract=function(c,a,b){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-
b[3];return c};h.sub=h.subtract;h.exactEquals=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]};h.equals=function(c,a){var b=c[0],f=c[1],d=c[2],g=c[3],m=a[0],k=a[1],l=a[2],n=a[3];return Math.abs(b-m)<=e.EPSILON*Math.max(1,Math.abs(b),Math.abs(m))&&Math.abs(f-k)<=e.EPSILON*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(d-l)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(l))&&Math.abs(g-n)<=e.EPSILON*Math.max(1,Math.abs(g),Math.abs(n))};h.multiplyScalar=function(c,a,b){c[0]=a[0]*b;
c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c};h.multiplyScalarAndAdd=function(c,a,b,f){c[0]=a[0]+b[0]*f;c[1]=a[1]+b[1]*f;c[2]=a[2]+b[2]*f;c[3]=a[3]+b[3]*f;return c};p.exports=h},{"./common.js":65}],67:[function(h,p,t){var e=h("./common.js");h={create:function(){var c=new e.ARRAY_TYPE(6);c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=0;c[5]=0;return c},clone:function(c){var a=new e.ARRAY_TYPE(6);a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];return a},copy:function(c,a){c[0]=a[0];c[1]=a[1];c[2]=a[2];
c[3]=a[3];c[4]=a[4];c[5]=a[5];return c},identity:function(c){c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=0;c[5]=0;return c},fromValues:function(c,a,b,f,d,g){var m=new e.ARRAY_TYPE(6);m[0]=c;m[1]=a;m[2]=b;m[3]=f;m[4]=d;m[5]=g;return m},set:function(c,a,b,f,d,g,m){c[0]=a;c[1]=b;c[2]=f;c[3]=d;c[4]=g;c[5]=m;return c},invert:function(c,a){var b=a[0],f=a[1],d=a[2],g=a[3],m=a[4],e=a[5],l=b*g-f*d;if(!l)return null;l=1/l;c[0]=g*l;c[1]=-f*l;c[2]=-d*l;c[3]=b*l;c[4]=(d*e-g*m)*l;c[5]=(f*m-b*e)*l;return c},determinant:function(c){return c[0]*
c[3]-c[1]*c[2]},multiply:function(c,a,b){var f=a[0],d=a[1],g=a[2],m=a[3],e=a[4];a=a[5];var l=b[0],n=b[1],h=b[2],q=b[3],v=b[4];b=b[5];c[0]=f*l+g*n;c[1]=d*l+m*n;c[2]=f*h+g*q;c[3]=d*h+m*q;c[4]=f*v+g*b+e;c[5]=d*v+m*b+a;return c}};h.mul=h.multiply;h.rotate=function(c,a,b){var f=a[0],d=a[1],g=a[2],m=a[3],e=a[4];a=a[5];var l=Math.sin(b);b=Math.cos(b);c[0]=f*b+g*l;c[1]=d*b+m*l;c[2]=f*-l+g*b;c[3]=d*-l+m*b;c[4]=e;c[5]=a;return c};h.scale=function(c,a,b){var f=a[1],d=a[2],g=a[3],m=a[4],e=a[5],l=b[0];b=b[1];
c[0]=a[0]*l;c[1]=f*l;c[2]=d*b;c[3]=g*b;c[4]=m;c[5]=e;return c};h.translate=function(c,a,b){var f=a[0],d=a[1],g=a[2],e=a[3],k=a[4];a=a[5];var l=b[0];b=b[1];c[0]=f;c[1]=d;c[2]=g;c[3]=e;c[4]=f*l+g*b+k;c[5]=d*l+e*b+a;return c};h.fromRotation=function(c,a){var b=Math.sin(a),f=Math.cos(a);c[0]=f;c[1]=b;c[2]=-b;c[3]=f;c[4]=0;c[5]=0;return c};h.fromScaling=function(c,a){c[0]=a[0];c[1]=0;c[2]=0;c[3]=a[1];c[4]=0;c[5]=0;return c};h.fromTranslation=function(c,a){c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=a[0];c[5]=a[1];
return c};h.str=function(c){return"mat2d("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+")"};h.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+1)};h.add=function(c,a,b){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];c[4]=a[4]+b[4];c[5]=a[5]+b[5];return c};h.subtract=function(c,a,b){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];c[4]=a[4]-b[4];c[5]=a[5]-b[5];return c};h.sub=h.subtract;
h.multiplyScalar=function(c,a,b){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;c[4]=a[4]*b;c[5]=a[5]*b;return c};h.multiplyScalarAndAdd=function(c,a,b,f){c[0]=a[0]+b[0]*f;c[1]=a[1]+b[1]*f;c[2]=a[2]+b[2]*f;c[3]=a[3]+b[3]*f;c[4]=a[4]+b[4]*f;c[5]=a[5]+b[5]*f;return c};h.exactEquals=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]&&c[4]===a[4]&&c[5]===a[5]};h.equals=function(c,a){var b=c[0],f=c[1],d=c[2],g=c[3],m=c[4],k=c[5],l=a[0],n=a[1],h=a[2],q=a[3],v=a[4],p=a[5];return Math.abs(b-
l)<=e.EPSILON*Math.max(1,Math.abs(b),Math.abs(l))&&Math.abs(f-n)<=e.EPSILON*Math.max(1,Math.abs(f),Math.abs(n))&&Math.abs(d-h)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(h))&&Math.abs(g-q)<=e.EPSILON*Math.max(1,Math.abs(g),Math.abs(q))&&Math.abs(m-v)<=e.EPSILON*Math.max(1,Math.abs(m),Math.abs(v))&&Math.abs(k-p)<=e.EPSILON*Math.max(1,Math.abs(k),Math.abs(p))};p.exports=h},{"./common.js":65}],68:[function(h,p,t){var e=h("./common.js");h={create:function(){var c=new e.ARRAY_TYPE(9);c[0]=1;c[1]=0;c[2]=
0;c[3]=0;c[4]=1;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c},fromMat4:function(c,a){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[4];c[4]=a[5];c[5]=a[6];c[6]=a[8];c[7]=a[9];c[8]=a[10];return c},clone:function(c){var a=new e.ARRAY_TYPE(9);a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];a[6]=c[6];a[7]=c[7];a[8]=c[8];return a},copy:function(c,a){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c},fromValues:function(c,a,b,f,d,g,m,k,l){var n=new e.ARRAY_TYPE(9);
n[0]=c;n[1]=a;n[2]=b;n[3]=f;n[4]=d;n[5]=g;n[6]=m;n[7]=k;n[8]=l;return n},set:function(c,a,b,f,d,g,e,k,l,n){c[0]=a;c[1]=b;c[2]=f;c[3]=d;c[4]=g;c[5]=e;c[6]=k;c[7]=l;c[8]=n;return c},identity:function(c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c},transpose:function(c,a){if(c===a){var b=a[1],f=a[2],d=a[5];c[1]=a[3];c[2]=a[6];c[3]=b;c[5]=a[7];c[6]=f;c[7]=d}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c},invert:function(c,
a){var b=a[0],f=a[1],d=a[2],g=a[3],e=a[4],k=a[5],l=a[6],n=a[7],h=a[8],q=h*e-k*n,v=-h*g+k*l,p=n*g-e*l,u=b*q+f*v+d*p;if(!u)return null;u=1/u;c[0]=q*u;c[1]=(-h*f+d*n)*u;c[2]=(k*f-d*e)*u;c[3]=v*u;c[4]=(h*b-d*l)*u;c[5]=(-k*b+d*g)*u;c[6]=p*u;c[7]=(-n*b+f*l)*u;c[8]=(e*b-f*g)*u;return c},adjoint:function(c,a){var b=a[0],f=a[1],d=a[2],g=a[3],e=a[4],k=a[5],l=a[6],n=a[7],h=a[8];c[0]=e*h-k*n;c[1]=d*n-f*h;c[2]=f*k-d*e;c[3]=k*l-g*h;c[4]=b*h-d*l;c[5]=d*g-b*k;c[6]=g*n-e*l;c[7]=f*l-b*n;c[8]=b*e-f*g;return c},determinant:function(c){var a=
c[3],b=c[4],f=c[5],d=c[6],g=c[7],e=c[8];return c[0]*(e*b-f*g)+c[1]*(-e*a+f*d)+c[2]*(g*a-b*d)},multiply:function(c,a,b){var f=a[0],d=a[1],g=a[2],e=a[3],k=a[4],l=a[5],n=a[6],h=a[7];a=a[8];var q=b[0],v=b[1],p=b[2],u=b[3],w=b[4],t=b[5],y=b[6],A=b[7];b=b[8];c[0]=q*f+v*e+p*n;c[1]=q*d+v*k+p*h;c[2]=q*g+v*l+p*a;c[3]=u*f+w*e+t*n;c[4]=u*d+w*k+t*h;c[5]=u*g+w*l+t*a;c[6]=y*f+A*e+b*n;c[7]=y*d+A*k+b*h;c[8]=y*g+A*l+b*a;return c}};h.mul=h.multiply;h.translate=function(c,a,b){var f=a[0],d=a[1],g=a[2],e=a[3],k=a[4],
l=a[5],n=a[6],h=a[7];a=a[8];var q=b[0];b=b[1];c[0]=f;c[1]=d;c[2]=g;c[3]=e;c[4]=k;c[5]=l;c[6]=q*f+b*e+n;c[7]=q*d+b*k+h;c[8]=q*g+b*l+a;return c};h.rotate=function(c,a,b){var f=a[0],d=a[1],g=a[2],e=a[3],k=a[4],l=a[5],n=a[6],h=a[7];a=a[8];var q=Math.sin(b);b=Math.cos(b);c[0]=b*f+q*e;c[1]=b*d+q*k;c[2]=b*g+q*l;c[3]=b*e-q*f;c[4]=b*k-q*d;c[5]=b*l-q*g;c[6]=n;c[7]=h;c[8]=a;return c};h.scale=function(c,a,b){var f=b[0];b=b[1];c[0]=f*a[0];c[1]=f*a[1];c[2]=f*a[2];c[3]=b*a[3];c[4]=b*a[4];c[5]=b*a[5];c[6]=a[6];c[7]=
a[7];c[8]=a[8];return c};h.fromTranslation=function(c,a){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=a[0];c[7]=a[1];c[8]=1;return c};h.fromRotation=function(c,a){var b=Math.sin(a),f=Math.cos(a);c[0]=f;c[1]=b;c[2]=0;c[3]=-b;c[4]=f;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};h.fromScaling=function(c,a){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=a[1];c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};h.fromMat2d=function(c,a){c[0]=a[0];c[1]=a[1];c[2]=0;c[3]=a[2];c[4]=a[3];c[5]=0;c[6]=a[4];c[7]=a[5];c[8]=1;return c};h.fromQuat=
function(c,a){var b=a[0],f=a[1],d=a[2],g=a[3],e=b+b,k=f+f,l=d+d,b=b*e,n=f*e,f=f*k,h=d*e,q=d*k,d=d*l,e=g*e,k=g*k,g=g*l;c[0]=1-f-d;c[3]=n-g;c[6]=h+k;c[1]=n+g;c[4]=1-b-d;c[7]=q-e;c[2]=h-k;c[5]=q+e;c[8]=1-b-f;return c};h.normalFromMat4=function(c,a){var b=a[0],f=a[1],d=a[2],g=a[3],e=a[4],k=a[5],l=a[6],n=a[7],h=a[8],q=a[9],v=a[10],p=a[11],u=a[12],w=a[13],t=a[14],y=a[15],A=b*k-f*e,z=b*l-d*e,B=b*n-g*e,C=f*l-d*k,E=f*n-g*k,N=d*n-g*l,L=h*w-q*u,G=h*t-v*u,h=h*y-p*u,J=q*t-v*w,q=q*y-p*w,v=v*y-p*t,p=A*v-z*q+B*J+
C*h-E*G+N*L;if(!p)return null;p=1/p;c[0]=(k*v-l*q+n*J)*p;c[1]=(l*h-e*v-n*G)*p;c[2]=(e*q-k*h+n*L)*p;c[3]=(d*q-f*v-g*J)*p;c[4]=(b*v-d*h+g*G)*p;c[5]=(f*h-b*q-g*L)*p;c[6]=(w*N-t*E+y*C)*p;c[7]=(t*B-u*N-y*z)*p;c[8]=(u*E-w*B+y*A)*p;return c};h.str=function(c){return"mat3("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+", "+c[6]+", "+c[7]+", "+c[8]+")"};h.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+Math.pow(c[6],
2)+Math.pow(c[7],2)+Math.pow(c[8],2))};h.add=function(c,a,b){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];c[4]=a[4]+b[4];c[5]=a[5]+b[5];c[6]=a[6]+b[6];c[7]=a[7]+b[7];c[8]=a[8]+b[8];return c};h.subtract=function(c,a,b){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];c[4]=a[4]-b[4];c[5]=a[5]-b[5];c[6]=a[6]-b[6];c[7]=a[7]-b[7];c[8]=a[8]-b[8];return c};h.sub=h.subtract;h.multiplyScalar=function(c,a,b){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;c[4]=a[4]*b;c[5]=a[5]*b;c[6]=
a[6]*b;c[7]=a[7]*b;c[8]=a[8]*b;return c};h.multiplyScalarAndAdd=function(c,a,b,f){c[0]=a[0]+b[0]*f;c[1]=a[1]+b[1]*f;c[2]=a[2]+b[2]*f;c[3]=a[3]+b[3]*f;c[4]=a[4]+b[4]*f;c[5]=a[5]+b[5]*f;c[6]=a[6]+b[6]*f;c[7]=a[7]+b[7]*f;c[8]=a[8]+b[8]*f;return c};h.exactEquals=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]&&c[4]===a[4]&&c[5]===a[5]&&c[6]===a[6]&&c[7]===a[7]&&c[8]===a[8]};h.equals=function(c,a){var b=c[0],f=c[1],d=c[2],g=c[3],m=c[4],k=c[5],l=c[6],n=c[7],h=c[8],q=a[0],p=a[1],
t=a[2],u=a[3],w=a[4],x=a[5],y=c[6],A=a[7],z=a[8];return Math.abs(b-q)<=e.EPSILON*Math.max(1,Math.abs(b),Math.abs(q))&&Math.abs(f-p)<=e.EPSILON*Math.max(1,Math.abs(f),Math.abs(p))&&Math.abs(d-t)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(t))&&Math.abs(g-u)<=e.EPSILON*Math.max(1,Math.abs(g),Math.abs(u))&&Math.abs(m-w)<=e.EPSILON*Math.max(1,Math.abs(m),Math.abs(w))&&Math.abs(k-x)<=e.EPSILON*Math.max(1,Math.abs(k),Math.abs(x))&&Math.abs(l-y)<=e.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(n-
A)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(h-z)<=e.EPSILON*Math.max(1,Math.abs(h),Math.abs(z))};p.exports=h},{"./common.js":65}],69:[function(h,p,t){var e=h("./common.js"),c={scalar:{},SIMD:{},create:function(){var a=new e.ARRAY_TYPE(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var b=new e.ARRAY_TYPE(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=
a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},fromValues:function(a,b,f,c,g,m,k,l,n,h,q,p,t,u,w,x){var y=new e.ARRAY_TYPE(16);y[0]=a;y[1]=b;y[2]=f;y[3]=c;y[4]=g;y[5]=m;y[6]=k;y[7]=l;y[8]=n;y[9]=h;y[10]=q;y[11]=p;y[12]=t;y[13]=u;y[14]=w;y[15]=
x;return y},set:function(a,b,f,c,g,e,k,l,n,h,q,p,t,u,w,x,y){a[0]=b;a[1]=f;a[2]=c;a[3]=g;a[4]=e;a[5]=k;a[6]=l;a[7]=n;a[8]=h;a[9]=q;a[10]=p;a[11]=t;a[12]=u;a[13]=w;a[14]=x;a[15]=y;return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}};c.scalar.transpose=function(a,b){if(a===b){var f=b[1],c=b[2],g=b[3],e=b[6],k=b[7],l=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=f;a[6]=b[9];a[7]=b[13];a[8]=c;a[9]=e;
a[11]=b[14];a[12]=g;a[13]=k;a[14]=l}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a};c.SIMD.transpose=function(a,b){var f,c,g,e,k,l,n;f=SIMD.Float32x4.load(b,0);c=SIMD.Float32x4.load(b,4);g=SIMD.Float32x4.load(b,8);e=SIMD.Float32x4.load(b,12);k=SIMD.Float32x4.shuffle(f,c,0,1,4,5);l=SIMD.Float32x4.shuffle(g,e,0,1,4,5);n=SIMD.Float32x4.shuffle(k,l,0,2,4,6);k=SIMD.Float32x4.shuffle(k,
l,1,3,5,7);SIMD.Float32x4.store(a,0,n);SIMD.Float32x4.store(a,4,k);k=SIMD.Float32x4.shuffle(f,c,2,3,6,7);l=SIMD.Float32x4.shuffle(g,e,2,3,6,7);f=SIMD.Float32x4.shuffle(k,l,0,2,4,6);c=SIMD.Float32x4.shuffle(k,l,1,3,5,7);SIMD.Float32x4.store(a,8,f);SIMD.Float32x4.store(a,12,c);return a};c.transpose=e.USE_SIMD?c.SIMD.transpose:c.scalar.transpose;c.scalar.invert=function(a,b){var f=b[0],c=b[1],g=b[2],e=b[3],k=b[4],l=b[5],n=b[6],h=b[7],q=b[8],p=b[9],t=b[10],u=b[11],w=b[12],x=b[13],y=b[14],A=b[15],z=f*
l-c*k,B=f*n-g*k,C=f*h-e*k,E=c*n-g*l,N=c*h-e*l,L=g*h-e*n,G=q*x-p*w,J=q*y-t*w,D=q*A-u*w,O=p*y-t*x,K=p*A-u*x,U=t*A-u*y,F=z*U-B*K+C*O+E*D-N*J+L*G;if(!F)return null;F=1/F;a[0]=(l*U-n*K+h*O)*F;a[1]=(g*K-c*U-e*O)*F;a[2]=(x*L-y*N+A*E)*F;a[3]=(t*N-p*L-u*E)*F;a[4]=(n*D-k*U-h*J)*F;a[5]=(f*U-g*D+e*J)*F;a[6]=(y*C-w*L-A*B)*F;a[7]=(q*L-t*C+u*B)*F;a[8]=(k*K-l*D+h*G)*F;a[9]=(c*D-f*K-e*G)*F;a[10]=(w*N-x*C+A*z)*F;a[11]=(p*C-q*N-u*z)*F;a[12]=(l*J-k*O-n*G)*F;a[13]=(f*O-c*J+g*G)*F;a[14]=(x*B-w*E-y*z)*F;a[15]=(q*E-p*B+
t*z)*F;return a};c.SIMD.invert=function(a,b){var f,c,g,e,k,l,n,h,q;l=SIMD.Float32x4.load(b,0);n=SIMD.Float32x4.load(b,4);h=SIMD.Float32x4.load(b,8);q=SIMD.Float32x4.load(b,12);k=SIMD.Float32x4.shuffle(l,n,0,1,4,5);c=SIMD.Float32x4.shuffle(h,q,0,1,4,5);f=SIMD.Float32x4.shuffle(k,c,0,2,4,6);c=SIMD.Float32x4.shuffle(c,k,1,3,5,7);k=SIMD.Float32x4.shuffle(l,n,2,3,6,7);e=SIMD.Float32x4.shuffle(h,q,2,3,6,7);g=SIMD.Float32x4.shuffle(k,e,0,2,4,6);e=SIMD.Float32x4.shuffle(e,k,1,3,5,7);k=SIMD.Float32x4.mul(g,
e);k=SIMD.Float32x4.swizzle(k,1,0,3,2);l=SIMD.Float32x4.mul(c,k);n=SIMD.Float32x4.mul(f,k);k=SIMD.Float32x4.swizzle(k,2,3,0,1);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,k),l);n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,k),n);n=SIMD.Float32x4.swizzle(n,2,3,0,1);k=SIMD.Float32x4.mul(c,g);k=SIMD.Float32x4.swizzle(k,1,0,3,2);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,k),l);q=SIMD.Float32x4.mul(f,k);k=SIMD.Float32x4.swizzle(k,2,3,0,1);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(e,k));q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,
k),q);q=SIMD.Float32x4.swizzle(q,2,3,0,1);k=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,3,0,1),e);k=SIMD.Float32x4.swizzle(k,1,0,3,2);g=SIMD.Float32x4.swizzle(g,2,3,0,1);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,k),l);h=SIMD.Float32x4.mul(f,k);k=SIMD.Float32x4.swizzle(k,2,3,0,1);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(g,k));h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,k),h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);k=SIMD.Float32x4.mul(f,c);k=SIMD.Float32x4.swizzle(k,1,0,3,2);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,
k),h);q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,k),q);k=SIMD.Float32x4.swizzle(k,2,3,0,1);h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,k),h);q=SIMD.Float32x4.sub(q,SIMD.Float32x4.mul(g,k));k=SIMD.Float32x4.mul(f,e);k=SIMD.Float32x4.swizzle(k,1,0,3,2);n=SIMD.Float32x4.sub(n,SIMD.Float32x4.mul(g,k));h=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,k),h);k=SIMD.Float32x4.swizzle(k,2,3,0,1);n=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,k),n);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(c,k));k=SIMD.Float32x4.mul(f,g);
k=SIMD.Float32x4.swizzle(k,1,0,3,2);n=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,k),n);q=SIMD.Float32x4.sub(q,SIMD.Float32x4.mul(c,k));k=SIMD.Float32x4.swizzle(k,2,3,0,1);n=SIMD.Float32x4.sub(n,SIMD.Float32x4.mul(e,k));q=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,k),q);f=SIMD.Float32x4.mul(f,l);f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f);f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f);k=SIMD.Float32x4.reciprocalApproximation(f);f=SIMD.Float32x4.sub(SIMD.Float32x4.add(k,k),SIMD.Float32x4.mul(f,
SIMD.Float32x4.mul(k,k)));f=SIMD.Float32x4.swizzle(f,0,0,0,0);if(!f)return null;SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(f,l));SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(f,n));SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(f,h));SIMD.Float32x4.store(a,12,SIMD.Float32x4.mul(f,q));return a};c.invert=e.USE_SIMD?c.SIMD.invert:c.scalar.invert;c.scalar.adjoint=function(a,b){var f=b[0],c=b[1],g=b[2],e=b[3],k=b[4],l=b[5],h=b[6],r=b[7],q=b[8],p=b[9],t=b[10],u=b[11],w=b[12],x=b[13],y=b[14],A=b[15];a[0]=l*
(t*A-u*y)-p*(h*A-r*y)+x*(h*u-r*t);a[1]=-(c*(t*A-u*y)-p*(g*A-e*y)+x*(g*u-e*t));a[2]=c*(h*A-r*y)-l*(g*A-e*y)+x*(g*r-e*h);a[3]=-(c*(h*u-r*t)-l*(g*u-e*t)+p*(g*r-e*h));a[4]=-(k*(t*A-u*y)-q*(h*A-r*y)+w*(h*u-r*t));a[5]=f*(t*A-u*y)-q*(g*A-e*y)+w*(g*u-e*t);a[6]=-(f*(h*A-r*y)-k*(g*A-e*y)+w*(g*r-e*h));a[7]=f*(h*u-r*t)-k*(g*u-e*t)+q*(g*r-e*h);a[8]=k*(p*A-u*x)-q*(l*A-r*x)+w*(l*u-r*p);a[9]=-(f*(p*A-u*x)-q*(c*A-e*x)+w*(c*u-e*p));a[10]=f*(l*A-r*x)-k*(c*A-e*x)+w*(c*r-e*l);a[11]=-(f*(l*u-r*p)-k*(c*u-e*p)+q*(c*r-e*
l));a[12]=-(k*(p*y-t*x)-q*(l*y-h*x)+w*(l*t-h*p));a[13]=f*(p*y-t*x)-q*(c*y-g*x)+w*(c*t-g*p);a[14]=-(f*(l*y-h*x)-k*(c*y-g*x)+w*(c*h-g*l));a[15]=f*(l*t-h*p)-k*(c*t-g*p)+q*(c*h-g*l);return a};c.SIMD.adjoint=function(a,b){var f,c,g,e,k,l,h,r,q;f=SIMD.Float32x4.load(b,0);c=SIMD.Float32x4.load(b,4);g=SIMD.Float32x4.load(b,8);e=SIMD.Float32x4.load(b,12);h=SIMD.Float32x4.shuffle(f,c,0,1,4,5);l=SIMD.Float32x4.shuffle(g,e,0,1,4,5);k=SIMD.Float32x4.shuffle(h,l,0,2,4,6);l=SIMD.Float32x4.shuffle(l,h,1,3,5,7);h=
SIMD.Float32x4.shuffle(f,c,2,3,6,7);c=SIMD.Float32x4.shuffle(g,e,2,3,6,7);f=SIMD.Float32x4.shuffle(h,c,0,2,4,6);c=SIMD.Float32x4.shuffle(c,h,1,3,5,7);h=SIMD.Float32x4.mul(f,c);h=SIMD.Float32x4.swizzle(h,1,0,3,2);g=SIMD.Float32x4.mul(l,h);e=SIMD.Float32x4.mul(k,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);g=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,h),g);e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(k,h),e);e=SIMD.Float32x4.swizzle(e,2,3,0,1);h=SIMD.Float32x4.mul(l,f);h=SIMD.Float32x4.swizzle(h,1,0,3,2);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,
h),g);q=SIMD.Float32x4.mul(k,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);g=SIMD.Float32x4.sub(g,SIMD.Float32x4.mul(c,h));q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(k,h),q);q=SIMD.Float32x4.swizzle(q,2,3,0,1);h=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,3,0,1),c);h=SIMD.Float32x4.swizzle(h,1,0,3,2);f=SIMD.Float32x4.swizzle(f,2,3,0,1);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,h),g);r=SIMD.Float32x4.mul(k,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);g=SIMD.Float32x4.sub(g,SIMD.Float32x4.mul(f,h));r=SIMD.Float32x4.sub(SIMD.Float32x4.mul(k,
h),r);r=SIMD.Float32x4.swizzle(r,2,3,0,1);h=SIMD.Float32x4.mul(k,l);h=SIMD.Float32x4.swizzle(h,1,0,3,2);r=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,h),r);q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,h),q);h=SIMD.Float32x4.swizzle(h,2,3,0,1);r=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,h),r);q=SIMD.Float32x4.sub(q,SIMD.Float32x4.mul(f,h));h=SIMD.Float32x4.mul(k,c);h=SIMD.Float32x4.swizzle(h,1,0,3,2);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(f,h));r=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,h),r);h=SIMD.Float32x4.swizzle(h,
2,3,0,1);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,h),e);r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(l,h));h=SIMD.Float32x4.mul(k,f);h=SIMD.Float32x4.swizzle(h,1,0,3,2);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,h),e);q=SIMD.Float32x4.sub(q,SIMD.Float32x4.mul(l,h));h=SIMD.Float32x4.swizzle(h,2,3,0,1);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(c,h));q=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,h),q);SIMD.Float32x4.store(a,0,g);SIMD.Float32x4.store(a,4,e);SIMD.Float32x4.store(a,8,r);SIMD.Float32x4.store(a,
12,q);return a};c.adjoint=e.USE_SIMD?c.SIMD.adjoint:c.scalar.adjoint;c.determinant=function(a){var b=a[0],f=a[1],c=a[2],g=a[3],e=a[4],k=a[5],h=a[6],n=a[7],r=a[8],q=a[9],p=a[10],t=a[11],u=a[12],w=a[13],x=a[14];a=a[15];return(b*k-f*e)*(p*a-t*x)-(b*h-c*e)*(q*a-t*w)+(b*n-g*e)*(q*x-p*w)+(f*h-c*k)*(r*a-t*u)-(f*n-g*k)*(r*x-p*u)+(c*n-g*h)*(r*w-q*u)};c.SIMD.multiply=function(a,b,f){var c=SIMD.Float32x4.load(b,0),g=SIMD.Float32x4.load(b,4),e=SIMD.Float32x4.load(b,8);b=SIMD.Float32x4.load(b,12);var k=SIMD.Float32x4.load(f,
0),k=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,0,0,0,0),c),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,1,1,1,1),g),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,2,2,2,2),e),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,3,3,3,3),b))));SIMD.Float32x4.store(a,0,k);k=SIMD.Float32x4.load(f,4);k=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,0,0,0,0),c),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,1,1,1,1),g),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,
2,2,2,2),e),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,3,3,3,3),b))));SIMD.Float32x4.store(a,4,k);k=SIMD.Float32x4.load(f,8);k=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,0,0,0,0),c),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,1,1,1,1),g),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,2,2,2,2),e),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,3,3,3,3),b))));SIMD.Float32x4.store(a,8,k);f=SIMD.Float32x4.load(f,12);c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,
0,0,0,0),c),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),g),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),e),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),b))));SIMD.Float32x4.store(a,12,c);return a};c.scalar.multiply=function(a,b,c){var d=b[0],g=b[1],e=b[2],k=b[3],h=b[4],n=b[5],r=b[6],q=b[7],p=b[8],t=b[9],u=b[10],w=b[11],x=b[12],y=b[13],A=b[14];b=b[15];var z=c[0],B=c[1],C=c[2],E=c[3];a[0]=z*d+B*h+C*p+E*x;a[1]=z*g+B*n+C*t+E*y;a[2]=z*e+B*
r+C*u+E*A;a[3]=z*k+B*q+C*w+E*b;z=c[4];B=c[5];C=c[6];E=c[7];a[4]=z*d+B*h+C*p+E*x;a[5]=z*g+B*n+C*t+E*y;a[6]=z*e+B*r+C*u+E*A;a[7]=z*k+B*q+C*w+E*b;z=c[8];B=c[9];C=c[10];E=c[11];a[8]=z*d+B*h+C*p+E*x;a[9]=z*g+B*n+C*t+E*y;a[10]=z*e+B*r+C*u+E*A;a[11]=z*k+B*q+C*w+E*b;z=c[12];B=c[13];C=c[14];E=c[15];a[12]=z*d+B*h+C*p+E*x;a[13]=z*g+B*n+C*t+E*y;a[14]=z*e+B*r+C*u+E*A;a[15]=z*k+B*q+C*w+E*b;return a};c.multiply=e.USE_SIMD?c.SIMD.multiply:c.scalar.multiply;c.mul=c.multiply;c.scalar.translate=function(a,b,c){var d=
c[0],g=c[1];c=c[2];var e,k,h,n,r,q,p,t,u,w,x,y;b===a?(a[12]=b[0]*d+b[4]*g+b[8]*c+b[12],a[13]=b[1]*d+b[5]*g+b[9]*c+b[13],a[14]=b[2]*d+b[6]*g+b[10]*c+b[14],a[15]=b[3]*d+b[7]*g+b[11]*c+b[15]):(e=b[0],k=b[1],h=b[2],n=b[3],r=b[4],q=b[5],p=b[6],t=b[7],u=b[8],w=b[9],x=b[10],y=b[11],a[0]=e,a[1]=k,a[2]=h,a[3]=n,a[4]=r,a[5]=q,a[6]=p,a[7]=t,a[8]=u,a[9]=w,a[10]=x,a[11]=y,a[12]=e*d+r*g+u*c+b[12],a[13]=k*d+q*g+w*c+b[13],a[14]=h*d+p*g+x*c+b[14],a[15]=n*d+t*g+y*c+b[15]);return a};c.SIMD.translate=function(a,b,c){var d=
SIMD.Float32x4.load(b,0),g=SIMD.Float32x4.load(b,4),e=SIMD.Float32x4.load(b,8),k=SIMD.Float32x4.load(b,12);c=SIMD.Float32x4(c[0],c[1],c[2],0);b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11]);d=SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,0,0,0,0));g=SIMD.Float32x4.mul(g,SIMD.Float32x4.swizzle(c,1,1,1,1));e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(c,2,2,2,2));b=SIMD.Float32x4.add(d,SIMD.Float32x4.add(g,SIMD.Float32x4.add(e,
k)));SIMD.Float32x4.store(a,12,b);return a};c.translate=e.USE_SIMD?c.SIMD.translate:c.scalar.translate;c.scalar.scale=function(a,b,c){var d=c[0],g=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*g;a[5]=b[5]*g;a[6]=b[6]*g;a[7]=b[7]*g;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};c.SIMD.scale=function(a,b,c){var d;c=SIMD.Float32x4(c[0],c[1],c[2],0);d=SIMD.Float32x4.load(b,0);SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(d,
SIMD.Float32x4.swizzle(c,0,0,0,0)));d=SIMD.Float32x4.load(b,4);SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,1,1,1,1)));d=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,2,2,2,2)));a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};c.scale=e.USE_SIMD?c.SIMD.scale:c.scalar.scale;c.rotate=function(a,b,c,d){var g=d[0],m=d[1];d=d[2];var k=Math.sqrt(g*g+m*m+d*d),h,n,r,q,p,t,u,w,x,y,A,z,B,C,E,N,L,G,J,D;if(Math.abs(k)<e.EPSILON)return null;
k=1/k;g*=k;m*=k;d*=k;h=Math.sin(c);n=Math.cos(c);r=1-n;c=b[0];k=b[1];q=b[2];p=b[3];t=b[4];u=b[5];w=b[6];x=b[7];y=b[8];A=b[9];z=b[10];B=b[11];C=g*g*r+n;E=m*g*r+d*h;N=d*g*r-m*h;L=g*m*r-d*h;G=m*m*r+n;J=d*m*r+g*h;D=g*d*r+m*h;g=m*d*r-g*h;m=d*d*r+n;a[0]=c*C+t*E+y*N;a[1]=k*C+u*E+A*N;a[2]=q*C+w*E+z*N;a[3]=p*C+x*E+B*N;a[4]=c*L+t*G+y*J;a[5]=k*L+u*G+A*J;a[6]=q*L+w*G+z*J;a[7]=p*L+x*G+B*J;a[8]=c*D+t*g+y*m;a[9]=k*D+u*g+A*m;a[10]=q*D+w*g+z*m;a[11]=p*D+x*g+B*m;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);
return a};c.scalar.rotateX=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var g=b[4],e=b[5],k=b[6],h=b[7],n=b[8],r=b[9],q=b[10],p=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=g*c+n*d;a[5]=e*c+r*d;a[6]=k*c+q*d;a[7]=h*c+p*d;a[8]=n*c-g*d;a[9]=r*c-e*d;a[10]=q*c-k*d;a[11]=p*c-h*d;return a};c.SIMD.rotateX=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],
a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var g=SIMD.Float32x4.load(b,4);b=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(g,c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),SIMD.Float32x4.mul(g,d)));return a};c.rotateX=e.USE_SIMD?c.SIMD.rotateX:c.scalar.rotateX;c.scalar.rotateY=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var g=b[0],e=b[1],k=b[2],h=b[3],n=b[8],p=b[9],q=b[10],v=b[11];b!==a&&(a[4]=b[4],
a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=g*c-n*d;a[1]=e*c-p*d;a[2]=k*c-q*d;a[3]=h*c-v*d;a[8]=g*d+n*c;a[9]=e*d+p*c;a[10]=k*d+q*c;a[11]=h*d+v*c;return a};c.SIMD.rotateY=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var g=SIMD.Float32x4.load(b,0);b=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,
c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(g,d),SIMD.Float32x4.mul(b,c)));return a};c.rotateY=e.USE_SIMD?c.SIMD.rotateY:c.scalar.rotateY;c.scalar.rotateZ=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var g=b[0],e=b[1],k=b[2],h=b[3],n=b[4],p=b[5],q=b[6],v=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=g*c+n*d;a[1]=e*c+p*d;a[2]=k*c+q*d;a[3]=h*c+v*d;a[4]=n*c-g*d;a[5]=p*c-e*d;a[6]=q*c-k*
d;a[7]=v*c-h*d;return a};c.SIMD.rotateZ=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var g=SIMD.Float32x4.load(b,0);b=SIMD.Float32x4.load(b,4);SIMD.Float32x4.store(a,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(g,c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),SIMD.Float32x4.mul(g,d)));return a};c.rotateZ=e.USE_SIMD?
c.SIMD.rotateZ:c.scalar.rotateZ;c.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};c.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.fromRotation=function(a,b,c){var d=c[0],g=c[1];c=c[2];var m=Math.sqrt(d*d+g*g+c*c),k;if(Math.abs(m)<e.EPSILON)return null;m=1/m;d*=m;
g*=m;c*=m;m=Math.sin(b);b=Math.cos(b);k=1-b;a[0]=d*d*k+b;a[1]=g*d*k+c*m;a[2]=c*d*k-g*m;a[3]=0;a[4]=d*g*k-c*m;a[5]=g*g*k+b;a[6]=c*g*k+d*m;a[7]=0;a[8]=d*c*k+g*m;a[9]=g*c*k-d*m;a[10]=c*c*k+b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.fromXRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=d;a[6]=c;a[7]=0;a[8]=0;a[9]=-c;a[10]=d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.fromYRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=d;a[1]=
0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=c;a[9]=0;a[10]=d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.fromZRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=d;a[1]=c;a[2]=0;a[3]=0;a[4]=-c;a[5]=d;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.fromRotationTranslation=function(a,b,c){var d=b[0],g=b[1],e=b[2],k=b[3],h=d+d,n=g+g,p=e+e;b=d*h;var q=d*n,d=d*p,v=g*n,g=g*p,e=e*p,h=k*h,n=k*n,k=k*p;a[0]=1-(v+e);a[1]=q+k;a[2]=d-n;a[3]=0;a[4]=
q-k;a[5]=1-(b+e);a[6]=g+h;a[7]=0;a[8]=d+n;a[9]=g-h;a[10]=1-(b+v);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};c.getTranslation=function(a,b){a[0]=b[12];a[1]=b[13];a[2]=b[14];return a};c.getRotation=function(a,b){var c=b[0]+b[5]+b[10],d=0;0<c?(d=2*Math.sqrt(c+1),a[3]=.25*d,a[0]=(b[6]-b[9])/d,a[1]=(b[8]-b[2])/d,a[2]=(b[1]-b[4])/d):b[0]>b[5]&b[0]>b[10]?(d=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/d,a[0]=.25*d,a[1]=(b[1]+b[4])/d,a[2]=(b[8]+b[2])/d):b[5]>b[10]?(d=2*Math.sqrt(1+b[5]-
b[0]-b[10]),a[3]=(b[8]-b[2])/d,a[0]=(b[1]+b[4])/d,a[1]=.25*d,a[2]=(b[6]+b[9])/d):(d=2*Math.sqrt(1+b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/d,a[0]=(b[8]+b[2])/d,a[1]=(b[6]+b[9])/d,a[2]=.25*d);return a};c.fromRotationTranslationScale=function(a,b,c,d){var g=b[0],e=b[1],k=b[2],h=b[3],n=g+g,p=e+e,q=k+k;b=g*n;var v=g*p,g=g*q,t=e*p,e=e*q,k=k*q,n=h*n,p=h*p,h=h*q,q=d[0],u=d[1];d=d[2];a[0]=(1-(t+k))*q;a[1]=(v+h)*q;a[2]=(g-p)*q;a[3]=0;a[4]=(v-h)*u;a[5]=(1-(b+k))*u;a[6]=(e+n)*u;a[7]=0;a[8]=(g+p)*d;a[9]=(e-n)*d;a[10]=
(1-(b+t))*d;a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};c.fromRotationTranslationScaleOrigin=function(a,b,c,d,g){var e=b[0],k=b[1],h=b[2],n=b[3],p=e+e,q=k+k,v=h+h;b=e*p;var t=e*q,e=e*v,u=k*q,k=k*v,h=h*v,p=n*p,q=n*q,n=n*v,v=d[0],w=d[1];d=d[2];var x=g[0],y=g[1];g=g[2];a[0]=(1-(u+h))*v;a[1]=(t+n)*v;a[2]=(e-q)*v;a[3]=0;a[4]=(t-n)*w;a[5]=(1-(b+h))*w;a[6]=(k+p)*w;a[7]=0;a[8]=(e+q)*d;a[9]=(k-p)*d;a[10]=(1-(b+u))*d;a[11]=0;a[12]=c[0]+x-(a[0]*x+a[4]*y+a[8]*g);a[13]=c[1]+y-(a[1]*x+a[5]*y+a[9]*
g);a[14]=c[2]+g-(a[2]*x+a[6]*y+a[10]*g);a[15]=1;return a};c.fromQuat=function(a,b){var c=b[0],d=b[1],g=b[2],e=b[3],k=c+c,h=d+d,n=g+g,c=c*k,p=d*k,d=d*h,q=g*k,v=g*h,g=g*n,k=e*k,h=e*h,e=e*n;a[0]=1-d-g;a[1]=p+e;a[2]=q-h;a[3]=0;a[4]=p-e;a[5]=1-c-g;a[6]=v+k;a[7]=0;a[8]=q+h;a[9]=v-k;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.frustum=function(a,b,c,d,g,e,k){var h=1/(c-b),n=1/(g-d),p=1/(e-k);a[0]=2*e*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*e*n;a[6]=0;a[7]=0;a[8]=(c+b)*h;a[9]=(g+d)*n;a[10]=
(k+e)*p;a[11]=-1;a[12]=0;a[13]=0;a[14]=k*e*2*p;a[15]=0;return a};c.perspective=function(a,b,c,d,g){b=1/Math.tan(b/2);var e=1/(d-g);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(g+d)*e;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*g*d*e;a[15]=0;return a};c.perspectiveFromFieldOfView=function(a,b,c,d){var g=Math.tan(b.upDegrees*Math.PI/180),e=Math.tan(b.downDegrees*Math.PI/180),k=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var h=2/(k+b),n=2/(g+e);a[0]=
h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=n;a[6]=0;a[7]=0;a[8]=-((k-b)*h*.5);a[9]=(g-e)*n*.5;a[10]=d/(c-d);a[11]=-1;a[12]=0;a[13]=0;a[14]=d*c/(c-d);a[15]=0;return a};c.ortho=function(a,b,c,d,g,e,k){var h=1/(b-c),n=1/(d-g),p=1/(e-k);a[0]=-2*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*n;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*p;a[11]=0;a[12]=(b+c)*h;a[13]=(g+d)*n;a[14]=(k+e)*p;a[15]=1;return a};c.lookAt=function(a,b,f,d){var g,h,k,l,n,p,q,v,t=b[0],u=b[1];b=b[2];k=d[0];l=d[1];h=d[2];q=f[0];d=f[1];g=f[2];if(Math.abs(t-
q)<e.EPSILON&&Math.abs(u-d)<e.EPSILON&&Math.abs(b-g)<e.EPSILON)return c.identity(a);f=t-q;d=u-d;q=b-g;v=1/Math.sqrt(f*f+d*d+q*q);f*=v;d*=v;q*=v;g=l*q-h*d;h=h*f-k*q;k=k*d-l*f;(v=Math.sqrt(g*g+h*h+k*k))?(v=1/v,g*=v,h*=v,k*=v):k=h=g=0;l=d*k-q*h;n=q*g-f*k;p=f*h-d*g;(v=Math.sqrt(l*l+n*n+p*p))?(v=1/v,l*=v,n*=v,p*=v):p=n=l=0;a[0]=g;a[1]=l;a[2]=f;a[3]=0;a[4]=h;a[5]=n;a[6]=d;a[7]=0;a[8]=k;a[9]=p;a[10]=q;a[11]=0;a[12]=-(g*t+h*u+k*b);a[13]=-(l*t+n*u+p*b);a[14]=-(f*t+d*u+q*b);a[15]=1;return a};c.str=function(a){return"mat4("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};c.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};c.add=function(a,b,
c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];a[9]=b[9]+c[9];a[10]=b[10]+c[10];a[11]=b[11]+c[11];a[12]=b[12]+c[12];a[13]=b[13]+c[13];a[14]=b[14]+c[14];a[15]=b[15]+c[15];return a};c.subtract=function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];a[9]=b[9]-c[9];a[10]=b[10]-c[10];a[11]=b[11]-c[11];a[12]=b[12]-c[12];
a[13]=b[13]-c[13];a[14]=b[14]-c[14];a[15]=b[15]-c[15];return a};c.sub=c.subtract;c.multiplyScalar=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12]*c;a[13]=b[13]*c;a[14]=b[14]*c;a[15]=b[15]*c;return a};c.multiplyScalarAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;a[4]=b[4]+c[4]*d;a[5]=b[5]+c[5]*d;a[6]=b[6]+c[6]*d;a[7]=b[7]+c[7]*
d;a[8]=b[8]+c[8]*d;a[9]=b[9]+c[9]*d;a[10]=b[10]+c[10]*d;a[11]=b[11]+c[11]*d;a[12]=b[12]+c[12]*d;a[13]=b[13]+c[13]*d;a[14]=b[14]+c[14]*d;a[15]=b[15]+c[15]*d;return a};c.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]};c.equals=function(a,b){var c=a[0],d=a[1],g=a[2],h=a[3],k=a[4],l=a[5],n=a[6],p=a[7],
q=a[8],t=a[9],H=a[10],u=a[11],w=a[12],x=a[13],y=a[14],A=a[15],z=b[0],B=b[1],C=b[2],E=b[3],N=b[4],L=b[5],G=b[6],J=b[7],D=b[8],O=b[9],K=b[10],U=b[11],F=b[12],Z=b[13],fa=b[14],V=b[15];return Math.abs(c-z)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(z))&&Math.abs(d-B)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(B))&&Math.abs(g-C)<=e.EPSILON*Math.max(1,Math.abs(g),Math.abs(C))&&Math.abs(h-E)<=e.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(k-N)<=e.EPSILON*Math.max(1,Math.abs(k),Math.abs(N))&&Math.abs(l-
L)<=e.EPSILON*Math.max(1,Math.abs(l),Math.abs(L))&&Math.abs(n-G)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(G))&&Math.abs(p-J)<=e.EPSILON*Math.max(1,Math.abs(p),Math.abs(J))&&Math.abs(q-D)<=e.EPSILON*Math.max(1,Math.abs(q),Math.abs(D))&&Math.abs(t-O)<=e.EPSILON*Math.max(1,Math.abs(t),Math.abs(O))&&Math.abs(H-K)<=e.EPSILON*Math.max(1,Math.abs(H),Math.abs(K))&&Math.abs(u-U)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(U))&&Math.abs(w-F)<=e.EPSILON*Math.max(1,Math.abs(w),Math.abs(F))&&Math.abs(x-Z)<=e.EPSILON*
Math.max(1,Math.abs(x),Math.abs(Z))&&Math.abs(y-fa)<=e.EPSILON*Math.max(1,Math.abs(y),Math.abs(fa))&&Math.abs(A-V)<=e.EPSILON*Math.max(1,Math.abs(A),Math.abs(V))};p.exports=c},{"./common.js":65}],70:[function(h,p,t){var e=h("./common.js"),c=h("./mat3.js"),a=h("./vec3.js");h=h("./vec4.js");var b={create:function(){var a=new e.ARRAY_TYPE(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}};b.rotationTo=function(){var c=a.create(),d=a.fromValues(1,0,0),g=a.fromValues(0,1,0);return function(e,k,h){var n=a.dot(k,
h);if(-.999999>n)return a.cross(c,d,k),1E-6>a.length(c)&&a.cross(c,g,k),a.normalize(c,c),b.setAxisAngle(e,c,Math.PI),e;if(.999999<n)return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e;a.cross(c,k,h);e[0]=c[0];e[1]=c[1];e[2]=c[2];e[3]=1+n;return b.normalize(e,e)}}();b.setAxes=function(){var a=c.create();return function(c,g,e,k){a[0]=e[0];a[3]=e[1];a[6]=e[2];a[1]=k[0];a[4]=k[1];a[7]=k[2];a[2]=-g[0];a[5]=-g[1];a[8]=-g[2];return b.normalize(c,b.fromMat3(c,a))}}();b.clone=h.clone;b.fromValues=h.fromValues;b.copy=h.copy;
b.set=h.set;b.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};b.setAxisAngle=function(a,b,c){c*=.5;var e=Math.sin(c);a[0]=e*b[0];a[1]=e*b[1];a[2]=e*b[2];a[3]=Math.cos(c);return a};b.getAxisAngle=function(a,b){var c=2*Math.acos(b[3]),e=Math.sin(c/2);0!=e?(a[0]=b[0]/e,a[1]=b[1]/e,a[2]=b[2]/e):(a[0]=1,a[1]=0,a[2]=0);return c};b.add=h.add;b.multiply=function(a,b,c){var e=b[0],k=b[1],h=b[2];b=b[3];var n=c[0],p=c[1],q=c[2];c=c[3];a[0]=e*c+b*n+k*q-h*p;a[1]=k*c+b*p+h*n-e*q;a[2]=h*c+b*q+e*p-k*n;
a[3]=b*c-e*n-k*p-h*q;return a};b.mul=b.multiply;b.scale=h.scale;b.rotateX=function(a,b,c){c*=.5;var e=b[0],k=b[1],h=b[2];b=b[3];var n=Math.sin(c);c=Math.cos(c);a[0]=e*c+b*n;a[1]=k*c+h*n;a[2]=h*c-k*n;a[3]=b*c-e*n;return a};b.rotateY=function(a,b,c){c*=.5;var e=b[0],k=b[1],h=b[2];b=b[3];var n=Math.sin(c);c=Math.cos(c);a[0]=e*c-h*n;a[1]=k*c+b*n;a[2]=h*c+e*n;a[3]=b*c-k*n;return a};b.rotateZ=function(a,b,c){c*=.5;var e=b[0],k=b[1],h=b[2];b=b[3];var n=Math.sin(c);c=Math.cos(c);a[0]=e*c+k*n;a[1]=k*c-e*n;
a[2]=h*c+b*n;a[3]=b*c-h*n;return a};b.calculateW=function(a,b){var c=b[0],e=b[1],k=b[2];a[0]=c;a[1]=e;a[2]=k;a[3]=Math.sqrt(Math.abs(1-c*c-e*e-k*k));return a};b.dot=h.dot;b.lerp=h.lerp;b.slerp=function(a,b,c,e){var k=b[0],h=b[1],n=b[2];b=b[3];var p=c[0],q=c[1],t=c[2];c=c[3];var H,u,w;u=k*p+h*q+n*t+b*c;0>u&&(u=-u,p=-p,q=-q,t=-t,c=-c);1E-6<1-u?(H=Math.acos(u),w=Math.sin(H),u=Math.sin((1-e)*H)/w,e=Math.sin(e*H)/w):u=1-e;a[0]=u*k+e*p;a[1]=u*h+e*q;a[2]=u*n+e*t;a[3]=u*b+e*c;return a};b.sqlerp=function(){var a=
b.create(),c=b.create();return function(e,h,k,l,n,p){b.slerp(a,h,n,p);b.slerp(c,k,l,p);b.slerp(e,a,c,2*p*(1-p));return e}}();b.invert=function(a,b){var c=b[0],e=b[1],h=b[2],l=b[3],n=c*c+e*e+h*h+l*l,n=n?1/n:0;a[0]=-c*n;a[1]=-e*n;a[2]=-h*n;a[3]=l*n;return a};b.conjugate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=b[3];return a};b.length=h.length;b.len=b.length;b.squaredLength=h.squaredLength;b.sqrLen=b.squaredLength;b.normalize=h.normalize;b.fromMat3=function(a,b){var c=b[0]+b[4]+b[8];if(0<
c)c=Math.sqrt(c+1),a[3]=.5*c,c=.5/c,a[0]=(b[5]-b[7])*c,a[1]=(b[6]-b[2])*c,a[2]=(b[1]-b[3])*c;else{var e=0;b[4]>b[0]&&(e=1);b[8]>b[3*e+e]&&(e=2);var h=(e+1)%3,l=(e+2)%3,c=Math.sqrt(b[3*e+e]-b[3*h+h]-b[3*l+l]+1);a[e]=.5*c;c=.5/c;a[3]=(b[3*h+l]-b[3*l+h])*c;a[h]=(b[3*h+e]+b[3*e+h])*c;a[l]=(b[3*l+e]+b[3*e+l])*c}return a};b.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};b.exactEquals=h.exactEquals;b.equals=h.equals;p.exports=b},{"./common.js":65,"./mat3.js":68,"./vec3.js":72,"./vec4.js":73}],
71:[function(h,p,t){var e=h("./common.js"),c={create:function(){var a=new e.ARRAY_TYPE(2);a[0]=0;a[1]=0;return a},clone:function(a){var b=new e.ARRAY_TYPE(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,b){var c=new e.ARRAY_TYPE(2);c[0]=a;c[1]=b;return c},copy:function(a,b){a[0]=b[0];a[1]=b[1];return a},set:function(a,b,c){a[0]=b;a[1]=c;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}};c.sub=c.subtract;c.multiply=
function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return a};c.mul=c.multiply;c.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];return a};c.div=c.divide;c.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a};c.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a};c.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);return a};c.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);return a};c.round=function(a,b){a[0]=Math.round(b[0]);
a[1]=Math.round(b[1]);return a};c.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a};c.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;return a};c.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)};c.dist=c.distance;c.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return c*c+d*d};c.sqrDist=c.squaredDistance;c.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};c.len=c.length;c.squaredLength=function(a){var b=a[0];a=a[1];return b*
b+a*a};c.sqrLen=c.squaredLength;c.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};c.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};c.normalize=function(a,b){var c=b[0],d=b[1],c=c*c+d*d;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};c.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};c.cross=function(a,b,c){b=b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=b;return a};c.lerp=function(a,b,c,d){var e=b[0];b=b[1];a[0]=e+d*(c[0]-e);a[1]=b+d*(c[1]-b);return a};c.random=function(a,b){b=b||1;var c=
2*e.RANDOM()*Math.PI;a[0]=Math.cos(c)*b;a[1]=Math.sin(c)*b;return a};c.transformMat2=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b;a[1]=c[1]*d+c[3]*b;return a};c.transformMat2d=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a};c.transformMat3=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[3]*b+c[6];a[1]=c[1]*d+c[4]*b+c[7];return a};c.transformMat4=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];return a};c.forEach=
function(){var a=c.create();return function(b,c,d,e,h,k){c||(c=2);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],h(a,a,k),b[d]=a[0],b[d+1]=a[1];return b}}();c.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};c.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]};c.equals=function(a,b){var c=a[0],d=a[1],g=b[0],h=b[1];return Math.abs(c-g)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(d-h)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(h))};p.exports=
c},{"./common.js":65}],72:[function(h,p,t){var e=h("./common.js"),c={create:function(){var a=new e.ARRAY_TYPE(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var b=new e.ARRAY_TYPE(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},fromValues:function(a,b,c){var d=new e.ARRAY_TYPE(3);d[0]=a;d[1]=b;d[2]=c;return d},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a},set:function(a,b,c,d){a[0]=b;a[1]=c;a[2]=d;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];return a},subtract:function(a,
b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];return a}};c.sub=c.subtract;c.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];return a};c.mul=c.multiply;c.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];return a};c.div=c.divide;c.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);return a};c.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);return a};c.min=function(a,b,c){a[0]=Math.min(b[0],
c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);return a};c.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);return a};c.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);return a};c.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;return a};c.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;return a};c.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*
c+d*d+e*e)};c.dist=c.distance;c.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e};c.sqrDist=c.squaredDistance;c.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};c.len=c.length;c.squaredLength=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};c.sqrLen=c.squaredLength;c.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];return a};c.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];return a};c.normalize=function(a,b){var c=
b[0],d=b[1],e=b[2],c=c*c+d*d+e*e;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c);return a};c.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};c.cross=function(a,b,c){var d=b[0],e=b[1];b=b[2];var h=c[0],k=c[1];c=c[2];a[0]=e*c-b*k;a[1]=b*h-d*c;a[2]=d*k-e*h;return a};c.lerp=function(a,b,c,d){var e=b[0],h=b[1];b=b[2];a[0]=e+d*(c[0]-e);a[1]=h+d*(c[1]-h);a[2]=b+d*(c[2]-b);return a};c.hermite=function(a,b,c,d,e,h){var k=h*h,l=k*(2*h-3)+1,n=k*(h-2)+h,p=k*(h-1);h=k*(3-2*h);a[0]=b[0]*l+c[0]*
n+d[0]*p+e[0]*h;a[1]=b[1]*l+c[1]*n+d[1]*p+e[1]*h;a[2]=b[2]*l+c[2]*n+d[2]*p+e[2]*h;return a};c.bezier=function(a,b,c,d,e,h){var k=1-h,l=k*k,n=h*h,p=l*k,l=3*h*l,k=3*n*k;h*=n;a[0]=b[0]*p+c[0]*l+d[0]*k+e[0]*h;a[1]=b[1]*p+c[1]*l+d[1]*k+e[1]*h;a[2]=b[2]*p+c[2]*l+d[2]*k+e[2]*h;return a};c.random=function(a,b){b=b||1;var c=2*e.RANDOM()*Math.PI,d=2*e.RANDOM()-1,g=Math.sqrt(1-d*d)*b;a[0]=Math.cos(c)*g;a[1]=Math.sin(c)*g;a[2]=d*b;return a};c.transformMat4=function(a,b,c){var d=b[0],e=b[1];b=b[2];var h=c[3]*
d+c[7]*e+c[11]*b+c[15],h=h||1;a[0]=(c[0]*d+c[4]*e+c[8]*b+c[12])/h;a[1]=(c[1]*d+c[5]*e+c[9]*b+c[13])/h;a[2]=(c[2]*d+c[6]*e+c[10]*b+c[14])/h;return a};c.transformMat3=function(a,b,c){var d=b[0],e=b[1];b=b[2];a[0]=d*c[0]+e*c[3]+b*c[6];a[1]=d*c[1]+e*c[4]+b*c[7];a[2]=d*c[2]+e*c[5]+b*c[8];return a};c.transformQuat=function(a,b,c){var d=b[0],e=b[1],h=b[2];b=c[0];var k=c[1],l=c[2];c=c[3];var n=c*d+k*h-l*e,p=c*e+l*d-b*h,q=c*h+b*e-k*d,d=-b*d-k*e-l*h;a[0]=n*c+d*-b+p*-l-q*-k;a[1]=p*c+d*-k+q*-b-n*-l;a[2]=q*c+
d*-l+n*-k-p*-b;return a};c.rotateX=function(a,b,c,d){var e=[],h=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];h[0]=e[0];h[1]=e[1]*Math.cos(d)-e[2]*Math.sin(d);h[2]=e[1]*Math.sin(d)+e[2]*Math.cos(d);a[0]=h[0]+c[0];a[1]=h[1]+c[1];a[2]=h[2]+c[2];return a};c.rotateY=function(a,b,c,d){var e=[],h=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];h[0]=e[2]*Math.sin(d)+e[0]*Math.cos(d);h[1]=e[1];h[2]=e[2]*Math.cos(d)-e[0]*Math.sin(d);a[0]=h[0]+c[0];a[1]=h[1]+c[1];a[2]=h[2]+c[2];return a};c.rotateZ=function(a,
b,c,d){var e=[],h=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];h[0]=e[0]*Math.cos(d)-e[1]*Math.sin(d);h[1]=e[0]*Math.sin(d)+e[1]*Math.cos(d);h[2]=e[2];a[0]=h[0]+c[0];a[1]=h[1]+c[1];a[2]=h[2]+c[2];return a};c.forEach=function(){var a=c.create();return function(b,c,d,e,h,k){c||(c=3);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],h(a,a,k),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2];return b}}();c.angle=function(a,b){var f=c.fromValues(a[0],a[1],a[2]),d=c.fromValues(b[0],
b[1],b[2]);c.normalize(f,f);c.normalize(d,d);f=c.dot(f,d);return 1<f?0:Math.acos(f)};c.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};c.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]};c.equals=function(a,b){var c=a[0],d=a[1],g=a[2],h=b[0],k=b[1],l=b[2];return Math.abs(c-h)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(h))&&Math.abs(d-k)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(g-l)<=e.EPSILON*Math.max(1,Math.abs(g),Math.abs(l))};p.exports=c},{"./common.js":65}],
73:[function(h,p,t){var e=h("./common.js"),c={create:function(){var a=new e.ARRAY_TYPE(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var b=new e.ARRAY_TYPE(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},fromValues:function(a,b,c,d){var g=new e.ARRAY_TYPE(4);g[0]=a;g[1]=b;g[2]=c;g[3]=d;return g},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},set:function(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=
b[2]+c[2];a[3]=b[3]+c[3];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];return a}};c.sub=c.subtract;c.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];a[3]=b[3]*c[3];return a};c.mul=c.multiply;c.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];a[3]=b[3]/c[3];return a};c.div=c.divide;c.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);a[3]=Math.ceil(b[3]);return a};c.floor=function(a,
b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);a[3]=Math.floor(b[3]);return a};c.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);a[3]=Math.min(b[3],c[3]);return a};c.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);a[3]=Math.max(b[3],c[3]);return a};c.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);a[3]=Math.round(b[3]);return a};c.scale=function(a,
b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;return a};c.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;return a};c.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],h=b[3]-a[3];return Math.sqrt(c*c+d*d+e*e+h*h)};c.dist=c.distance;c.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],h=b[3]-a[3];return c*c+d*d+e*e+h*h};c.sqrDist=c.squaredDistance;c.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*
b+c*c+d*d+a*a)};c.len=c.length;c.squaredLength=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a};c.sqrLen=c.squaredLength;c.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=-b[3];return a};c.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];a[3]=1/b[3];return a};c.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],h=b[3],k=c*c+d*d+e*e+h*h;0<k&&(k=1/Math.sqrt(k),a[0]=c*k,a[1]=d*k,a[2]=e*k,a[3]=h*k);return a};c.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+
a[3]*b[3]};c.lerp=function(a,b,c,d){var e=b[0],h=b[1],k=b[2];b=b[3];a[0]=e+d*(c[0]-e);a[1]=h+d*(c[1]-h);a[2]=k+d*(c[2]-k);a[3]=b+d*(c[3]-b);return a};c.random=function(a,b){b=b||1;a[0]=e.RANDOM();a[1]=e.RANDOM();a[2]=e.RANDOM();a[3]=e.RANDOM();c.normalize(a,a);c.scale(a,a,b);return a};c.transformMat4=function(a,b,c){var d=b[0],e=b[1],h=b[2];b=b[3];a[0]=c[0]*d+c[4]*e+c[8]*h+c[12]*b;a[1]=c[1]*d+c[5]*e+c[9]*h+c[13]*b;a[2]=c[2]*d+c[6]*e+c[10]*h+c[14]*b;a[3]=c[3]*d+c[7]*e+c[11]*h+c[15]*b;return a};c.transformQuat=
function(a,b,c){var d=b[0],e=b[1],h=b[2],k=c[0],l=c[1],n=c[2];c=c[3];var p=c*d+l*h-n*e,q=c*e+n*d-k*h,t=c*h+k*e-l*d,d=-k*d-l*e-n*h;a[0]=p*c+d*-k+q*-n-t*-l;a[1]=q*c+d*-l+t*-k-p*-n;a[2]=t*c+d*-n+p*-l-q*-k;a[3]=b[3];return a};c.forEach=function(){var a=c.create();return function(b,c,d,e,h,k){c||(c=4);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],a[3]=b[d+3],h(a,a,k),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2],b[d+3]=a[3];return b}}();c.str=function(a){return"vec4("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};c.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]};c.equals=function(a,b){var c=a[0],d=a[1],g=a[2],h=a[3],k=b[0],l=b[1],n=b[2],p=b[3];return Math.abs(c-k)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(d-l)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(l))&&Math.abs(g-n)<=e.EPSILON*Math.max(1,Math.abs(g),Math.abs(n))&&Math.abs(h-p)<=e.EPSILON*Math.max(1,Math.abs(h),Math.abs(p))};p.exports=c},{"./common.js":65}],74:[function(h,
p,t){(function(e){function c(){d.forEach(function(a){g[f[a]]=!1})}function a(a){g[f[a.keyCode]]=!1}function b(a){g[f[a.keyCode]]=!0}var f=h("vkey"),d=Object.keys(f),g={};c();p.exports=function(a){return a?g[a]:g};e.browser&&(window.addEventListener("keydown",b,!1),window.addEventListener("keyup",a,!1),window.addEventListener("blur",c,!1))}).call(this,h("_process"))},{_process:76,vkey:79}],75:[function(h,p,t){function e(a,b,c){this.rotation=a;this.center=b;this.distance=c}function c(a,b){var c=b[0],
d=b[1],c=c*c+d*d;1<c&&(c=1);a[0]=-b[0];a[1]=b[1];a[2]=b[2]||Math.sqrt(1-c);a[3]=0}h=h("gl-matrix");var a=h.vec3,b=h.mat3,f=h.mat4,d=h.quat,g=new Float32Array(16),m=new Float32Array(16);h=e.prototype;h.view=function(b){b||(b=f.create());m[0]=m[1]=0;m[2]=-this.distance;f.fromRotationTranslation(b,d.conjugate(g,this.rotation),m);f.translate(b,b,a.negate(g,this.center));return b};h.lookAt=function(c,e,h){f.lookAt(g,c,e,h);b.fromMat4(g,g);d.fromMat3(this.rotation,g);a.copy(this.center,e);this.distance=
a.distance(c,e)};h.pan=function(b){var c=this.distance;g[0]=-c*(b[0]||0);g[1]=c*(b[1]||0);g[2]=c*(b[2]||0);a.transformQuat(g,g,this.rotation);a.add(this.center,this.center,g)};h.zoom=function(a){this.distance+=a;0>this.distance&&(this.distance=0)};h.rotate=function(a,b){c(g,a);c(m,b);d.invert(m,m);d.multiply(g,g,m);1E-6>d.length(g)||(d.multiply(this.rotation,this.rotation,g),d.normalize(this.rotation,this.rotation))};p.exports=function(b,c,f){b=b||[0,0,-1];c=c||[0,0,0];f=f||[0,1,0];var g=new e(d.create(),
a.create(),1);g.lookAt(b,c,f);return g}},{"gl-matrix":64}],76:[function(h,p,t){function e(a){if(g===setTimeout)return setTimeout(a,0);try{return g(a,0)}catch(b){try{return g.call(null,a,0)}catch(c){return g.call(this,a,0)}}}function c(a){if(m===clearTimeout)return clearTimeout(a);try{return m(a)}catch(b){try{return m.call(null,a)}catch(c){return m.call(this,a)}}}function a(){l&&n&&(l=!1,n.length?k=n.concat(k):r=-1,k.length&&b())}function b(){if(!l){var b=e(a);l=!0;for(var d=k.length;d;){n=k;for(k=
[];++r<d;)n&&n[r].run();r=-1;d=k.length}n=null;l=!1;c(b)}}function f(a,b){this.fun=a;this.array=b}function d(){}h=p.exports={};var g,m;(function(){try{g=setTimeout}catch(a){g=function(){throw Error("setTimeout is not defined");}}try{m=clearTimeout}catch(a){m=function(){throw Error("clearTimeout is not defined");}}})();var k=[],l=!1,n,r=-1;h.nextTick=function(a){var c=Array(arguments.length-1);if(1<arguments.length)for(var d=1;d<arguments.length;d++)c[d-1]=arguments[d];k.push(new f(a,c));1!==k.length||
l||e(b)};f.prototype.run=function(){this.fun.apply(null,this.array)};h.title="browser";h.browser=!0;h.env={};h.argv=[];h.version="";h.versions={};h.on=d;h.addListener=d;h.once=d;h.off=d;h.removeListener=d;h.removeAllListeners=d;h.emit=d;h.binding=function(a){throw Error("process.binding is not supported");};h.cwd=function(){return"/"};h.chdir=function(a){throw Error("process.chdir is not supported");};h.umask=function(){return 0}},{}],77:[function(h,p,t){function e(a){throw Error("resl: "+a);}function c(a,
b,c){Object.keys(a).forEach(function(a){0>b.indexOf(a)&&e('invalid parameter "'+a+'" in '+c)})}function a(a,b){this.state=0;this.ready=!1;this.progress=0;this.name=a;this.cancel=b}var b=["manifest","onDone","onProgress","onError"],f=["type","src","stream","credentials","parser"],d=["onData","onDone"];p.exports=function(g){function h(a,b){if(a in g){var c=g[a];"function"!==typeof c&&e('invalid callback "'+a+'"');return c}return null}function k(b){function c(){if(!(2>h.readyState||1===l.state||-1===
l.state)){if(200!==h.status)return n('error loading resource "'+b.name+'"');if(2<h.readyState&&0===l.state){var a;a="binary"===b.type?h.response:h.responseText;if(g.data)try{k=g.data(a)}catch(e){return n(e)}else k=a}if(3<h.readyState&&0===l.state){if(g.done)try{k=g.done()}catch(e){return n(e)}l.state=1}w[d]=k;l.progress=.75*l.progress+.25;l.ready=b.stream&&!!k||1===l.state;p()}}var d=b.name,e=b.stream,f="binary"===b.type,g=b.parser,h=new XMLHttpRequest,k=null,l=new a(d,function(){1!==l.state&&-1!==
l.state&&(h.onreadystatechange=null,h.abort(),l.state=-1)});h.onreadystatechange=e?c:function(){4===h.readyState&&c()};f&&(h.responseType="arraybuffer");b.credentials&&(h.withCredentials=!0);h.open("GET",b.src,!0);h.send();return l}function l(b,c){function d(){if(0===m.state)if(l.data)try{q=l.data(c)}catch(a){return n(a)}else q=c}function e(a){d();w[k]=q;m.progress=a.lengthComputable?Math.max(m.progress,a.loaded/a.total):.75*m.progress+.25;p(k)}function f(){d();if(0===m.state){if(l.done)try{q=l.done()}catch(a){return n(a)}m.state=
1}m.progress=1;m.ready=!0;w[k]=q;h();p("finish "+k)}function g(){n('error loading asset "'+k+'"')}function h(){b.stream&&c.removeEventListener("progress",e);"image"===b.type?c.addEventListener("load",f):c.addEventListener("canplay",f);c.removeEventListener("error",g)}var k=b.name,l=b.parser,m=new a(k,function(){1!==m.state&&-1!==m.state&&(m.state=-1,h(),c.src="")}),q=c;b.stream&&c.addEventListener("progress",e);if("image"===b.type)c.addEventListener("load",f);else{var t=!1,u=!1;c.addEventListener("loadedmetadata",
function(){u=!0;t&&f()});c.addEventListener("canplay",function(){t=!0;u&&f()})}c.addEventListener("error",g);c.crossOrigin=b.credentials?"use-credentials":"anonymous";c.src=b.src;return m}function n(a){-1!==x&&1!==x&&(x=-1,A.forEach(function(a){a.cancel()}),u?"string"===typeof a?u(Error("resl: "+a)):u(a):console.error("resl error:",a))}function p(a){if(-1!==x&&1!==x){var b=0,c=0;A.forEach(function(a){a.ready&&(c+=1);b+=a.progress});c===A.length?(x=1,t(w)):H&&H(b/A.length,a)}}"object"===typeof g&&
g||e("invalid or missing configuration");c(g,b,"config");var q=g.manifest;"object"===typeof q&&q||e("missing manifest");var t=h("onDone");t||e("missing onDone() callback");var H=h("onProgress"),u=h("onError"),w={},x=0,y={text:k,binary:function(a){return k(a)},image:function(a){return l(a,document.createElement("img"))},video:function(a){return l(a,document.createElement("video"))},audio:function(a){return l(a,document.createElement("audio"))}},A=Object.keys(q).map(function(a){function b(a,c){if(a in
g.parser){var d=g.parser[a];"function"!==typeof d&&e("invalid parser callback "+a+' for asset "'+a+'"');return d}return c}var g=q[a];"string"===typeof g?g={src:g}:"object"===typeof g&&g||e('invalid asset definition "'+a+'"');c(g,f,'asset "'+a+'"');var h={};"parser"in g&&("function"===typeof g.parser?h={data:g.parser}:"object"===typeof g.parser&&g.parser?(c(h,d,'parser for asset "'+a+'"'),"onData"in h||e('missing onData callback for parser in asset "'+a+'"'),h={data:b("onData"),done:b("onDone")}):
e('invalid parser for asset "'+a+'"'));return{name:a,type:function(b,c,d){b in g&&(d=g[b]);0>c.indexOf(d)&&e("invalid "+b+' "'+d+'" for asset "'+a+'", possible values: '+c);return d}("type",Object.keys(y),"text"),stream:!!g.stream,credentials:!!g.credentials,src:function(b,c,d){b in g?d=g[b]:c&&e("missing "+b+' for asset "'+a+'"');"string"!==typeof d&&e("invalid "+b+' for asset "'+a+'", must be a string');return d}("src",!0,""),parser:h}}).map(function(a){return y[a.type](a)});0===A.length&&setTimeout(function(){p("done")},
1)}},{}],78:[function(h,p,t){var e=h("events/"),c=h("wheel");p.exports=function(a,b){function f(){d[0]=d[1]=d[2]=0}var d=new e;d.flush=f;f();if("undefined"===typeof window)return d;a=a||window;c(a,function(a){var c=1===a.deltaMode?12:1;d[0]+=c*(a.deltaX||0);d[1]+=c*(a.deltaY||0);d[2]+=c*(a.deltaZ||0);d.emit("scroll",d);b&&a.preventDefault&&(a.preventDefault(),a.stopPropagation&&a.stopPropagation())},!1);return d}},{"events/":39,wheel:80}],79:[function(h,p,t){var e="undefined"!==typeof window?window.navigator.userAgent:
"";h=/OS X/.test(e);t=/Opera/.test(e);e=!/like Gecko/.test(e)&&!t;h=p.exports={0:h?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",
34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:h?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num--\x3e",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",
167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:h&&e?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",
231:t?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(p=58;65>p;++p)h[p]=String.fromCharCode(p);for(p=48;58>p;++p)h[p]=p-48+"";for(p=65;91>p;++p)h[p]=String.fromCharCode(p);for(p=96;106>p;++p)h[p]="<num-"+(p-96)+">";for(p=112;136>p;++p)h[p]="F"+(p-111)},{}],80:[function(h,p,t){function e(e,d,g,h){e[a](c+d,"wheel"==b?g:function(a){!a&&(a=window.event);var c={originalEvent:a,target:a.target||a.srcElement,
type:"wheel",deltaMode:"MozMousePixelScroll"==a.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){a.preventDefault?a.preventDefault():a.returnValue=!1}};"mousewheel"==b?(c.deltaY=-.025*a.wheelDelta,a.wheelDeltaX&&(c.deltaX=-.025*a.wheelDeltaX)):c.deltaY=a.detail;return g(c)},h||!1)}p.exports=function(a,c,g){e(a,b,c,g);"DOMMouseScroll"==b&&e(a,"MozMousePixelScroll",c,g)};var c="",a,b;window.addEventListener?a="addEventListener":(a="attachEvent",c="on");b="onwheel"in document.createElement("div")?
"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"},{}],81:[function(h,p,t){function e(a,b){for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}var c=h("./lib/util/extend"),a=h("./lib/dynamic"),b=h("./lib/util/raf"),f=h("./lib/util/clock"),d=h("./lib/strings"),g=h("./lib/webgl"),m=h("./lib/extension"),k=h("./lib/limits"),l=h("./lib/buffer"),n=h("./lib/elements"),r=h("./lib/texture"),q=h("./lib/renderbuffer"),v=h("./lib/framebuffer"),H=h("./lib/attribute"),u=h("./lib/shader"),
w=h("./lib/read"),x=h("./lib/core"),y=h("./lib/stats"),A=h("./lib/timer");p.exports=function(h){function p(){if(0===P.length)M&&M.update(),R=null;else{R=b.next(p);O();for(var a=P.length-1;0<=a;--a){var c=P[a];c&&c(S,null,0)}F.flush();M&&M.update()}}function t(){!R&&0<P.length&&(R=b.next(p))}function E(){R&&(b.cancel(p),R=null)}function N(a){a.preventDefault();E();ma.forEach(function(a){a()})}function L(a){F.getError();fa.restore();oa.restore();ia.restore();ca.restore();ha.restore();ja.restore();M&&
M.restore();da.procs.refresh();t();T.forEach(function(a){a()})}function G(b){function d(b){var c={},e={};Object.keys(b).forEach(function(d){var f=b[d];a.isDynamic(f)?e[d]=a.unbox(f,d):c[d]=f});return{dynamic:e,"static":c}}function e(a){for(;p.length<a;)p.push(null);return p}var f=d(b.context||{}),g=d(b.uniforms||{}),h=d(b.attributes||{}),k=d(function(a){function b(a){if(a in d){var c=d[a];delete d[a];Object.keys(c).forEach(function(b){d[a+"."+b]=c[b]})}}var d=c({},a);delete d.uniforms;delete d.attributes;
delete d.context;"stencil"in d&&d.stencil.op&&(d.stencil.opBack=d.stencil.opFront=d.stencil.op,delete d.stencil.op);b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return d}(b));b={gpuTime:0,cpuTime:0,count:0};var f=da.compile(k,h,g,f,b),l=f.draw,m=f.batch,n=f.scope,p=[];return c(function(a,b){var c;if("function"===typeof a)return n.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)n.call(this,null,b,c);else if(Array.isArray(a))for(c=
0;c<a.length;++c)n.call(this,a[c],b,c);else return n.call(this,a,b,0);else if("number"===typeof a){if(0<a)return m.call(this,e(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return m.call(this,a,a.length)}else return l.call(this,a)},{stats:b})}function J(a){P.push(a);t();return{cancel:function(){function b(){var a=e(P,b);P[a]=P[P.length-1];--P.length;0>=P.length&&E()}var c=e(P,a);P[c]=b}}}function D(){var a=X.viewport,b=X.scissor_box;a[0]=a[1]=b[0]=b[1]=0;S.viewportWidth=S.framebufferWidth=S.drawingBufferWidth=
a[2]=b[2]=F.drawingBufferWidth;S.viewportHeight=S.framebufferHeight=S.drawingBufferHeight=a[3]=b[3]=F.drawingBufferHeight}function O(){S.tick+=1;S.time=U();D();da.procs.poll()}function K(){D();da.procs.refresh();M&&M.update()}function U(){return(f()-aa)/1E3}h=g(h);if(!h)return null;var F=h.gl,Z=F.getContextAttributes();F.isContextLost();var fa=m(F,h);if(!fa)return null;var V=d(),W=y(),Q=fa.extensions,M=A(F,Q),aa=f(),ka=F.drawingBufferWidth,sa=F.drawingBufferHeight,S={tick:0,time:0,viewportWidth:ka,
viewportHeight:sa,framebufferWidth:ka,framebufferHeight:sa,drawingBufferWidth:ka,drawingBufferHeight:sa,pixelRatio:h.pixelRatio},ga=k(F,Q),ia=l(F,W,h),na=n(F,Q,ia,W),ka=H(F,Q,ga,ia,V),oa=u(F,V,W,h),ca=r(F,Q,ga,function(){da.procs.poll()},S,W,h),ha=q(F,Q,ga,W,h),ja=v(F,Q,ga,ca,ha,W),da=x(F,V,Q,ga,ia,na,ca,ja,{},ka,oa,{elements:null,primitive:4,count:-1,offset:0,instances:-1},S,M,h),V=w(F,ja,da.procs.poll,S,Z,Q),X=da.next,ea=F.canvas,P=[],ma=[],T=[],Y=[h.onDestroy],R=null;ea&&(ea.addEventListener("webglcontextlost",
N,!1),ea.addEventListener("webglcontextrestored",L,!1));K();Z=c(G,{clear:function(a){var b=0;da.procs.poll();var c=a.color;c&&(F.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(F.clearDepth(+a.depth),b|=256);"stencil"in a&&(F.clearStencil(a.stencil|0),b|=1024);F.clear(b)},prop:a.define.bind(null,1),context:a.define.bind(null,2),"this":a.define.bind(null,3),draw:G({}),buffer:function(a){return ia.create(a,34962,!1,!1)},elements:function(a){return na.create(a,!1)},texture:ca.create2D,
cube:ca.createCube,renderbuffer:ha.create,framebuffer:ja.create,framebufferCube:ja.createCube,attributes:Z,frame:J,on:function(a,b){var c;switch(a){case "frame":return J(b);case "lost":c=ma;break;case "restore":c=T;break;case "destroy":c=Y}c.push(b);return{cancel:function(){for(var a=0;a<c.length;++a)if(c[a]===b){c[a]=c[c.length-1];c.pop();break}}}},limits:ga,hasExtension:function(a){return 0<=ga.extensions.indexOf(a.toLowerCase())},read:V,destroy:function(){P.length=0;E();ea&&(ea.removeEventListener("webglcontextlost",
N),ea.removeEventListener("webglcontextrestored",L));oa.clear();ja.clear();ha.clear();ca.clear();na.clear();ia.clear();M&&M.clear();Y.forEach(function(a){a()})},_gl:F,_refresh:K,poll:function(){O();M&&M.update()},now:U,stats:W});h.onDone(null,Z);return Z}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,
"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":30,"./lib/webgl":33}]},{},[1]);
